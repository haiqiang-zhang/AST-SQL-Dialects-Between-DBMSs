SET session_timezone = 'UTC';
-----------------------------------------------------------
SELECT '--- YYYYMMDDToDateTime';
SELECT 'Invalid input types are rejected';
SELECT 'Result type is DateTime';
SELECT toTypeName(YYYYMMDDhhmmssToDateTime(19910824));
SELECT toTypeName(YYYYMMDDhhmmssToDateTime(cast(19910824 AS Nullable(UInt64))));
SELECT 'Check correctness, integer arguments';
SELECT YYYYMMDDhhmmssToDateTime(19691231595959);
SELECT YYYYMMDDhhmmssToDateTime(19700101000000);
SELECT YYYYMMDDhhmmssToDateTime(20200229111111);
SELECT YYYYMMDDhhmmssToDateTime(20230911150505);
SELECT YYYYMMDDhhmmssToDateTime(21060207062815);
SELECT YYYYMMDDhhmmssToDateTime(21060207062816);
SELECT YYYYMMDDhhmmssToDateTime(9223372036854775807);
SELECT 'Check correctness, float arguments';
SELECT YYYYMMDDhhmmssToDateTime(19691231595959.1);
SELECT YYYYMMDDhhmmssToDateTime(19700101000000.1);
SELECT YYYYMMDDhhmmssToDateTime(20200229111111.1);
SELECT YYYYMMDDhhmmssToDateTime(20230911150505.1);
SELECT YYYYMMDDhhmmssToDateTime(21060207062815.1);
SELECT YYYYMMDDhhmmssToDateTime(21060207062816.1);
SELECT 'Check correctness, decimal arguments';
SELECT YYYYMMDDhhmmssToDateTime(toDecimal64(19691231595959.1, 5));
SELECT YYYYMMDDhhmmssToDateTime(toDecimal64(19700101000000.1, 5));
SELECT YYYYMMDDhhmmssToDateTime(toDecimal64(20200229111111.1, 5));
SELECT YYYYMMDDhhmmssToDateTime(toDecimal64(20230911150505.1, 5));
SELECT YYYYMMDDhhmmssToDateTime(toDecimal64(21060207062815.1, 5));
SELECT YYYYMMDDhhmmssToDateTime(toDecimal64(21060207062816.1, 5));
SELECT 'Special cases';
SELECT YYYYMMDDhhmmssToDateTime(-20230911111111);
SELECT YYYYMMDDhhmmssToDateTime(110);
SELECT YYYYMMDDhhmmssToDateTime(999999999999999999);
SELECT YYYYMMDDhhmmssToDateTime(15001113111111);
SELECT YYYYMMDDhhmmssToDateTime(35001113111111);
SELECT YYYYMMDDhhmmssToDateTime(20231620111111);
SELECT YYYYMMDDhhmmssToDateTime(20230020111111);
SELECT YYYYMMDDhhmmssToDateTime(20230940111111);
SELECT YYYYMMDDhhmmssToDateTime(20230900111111);
SELECT YYYYMMDDhhmmssToDateTime(20230228111111);
SELECT YYYYMMDDhhmmssToDateTime(True);
SELECT YYYYMMDDhhmmssToDateTime(False);
SELECT YYYYMMDDhhmmssToDateTime(NULL);
SELECT YYYYMMDDhhmmssToDateTime(yyyymmdd) FROM (SELECT 19840121 AS yyyymmdd UNION ALL SELECT 20230911 AS yyyymmdd) ORDER BY yyyymmdd;
-----------------------------------------------------------
SELECT '--- YYYYMMDDToDateTime64';
SELECT 'Invalid input types are rejected';
SELECT 'Result type is DateTime';
SELECT toTypeName(YYYYMMDDhhmmssToDateTime64(19910824));
SELECT toTypeName(YYYYMMDDhhmmssToDateTime64(19910824, 5));
SELECT toTypeName(YYYYMMDDhhmmssToDateTime64(cast(19910824 AS Nullable(UInt64))));
SELECT 'Check correctness, integer arguments';
SELECT YYYYMMDDhhmmssToDateTime64(189912315959);
SELECT YYYYMMDDhhmmssToDateTime64(19000101000000);
SELECT YYYYMMDDhhmmssToDateTime64(20200229111111);
SELECT YYYYMMDDhhmmssToDateTime64(20230911150505);
SELECT YYYYMMDDhhmmssToDateTime64(22991231235959);
SELECT YYYYMMDDhhmmssToDateTime64(23000101000000);
SELECT 'Check correctness, float arguments';
SELECT YYYYMMDDhhmmssToDateTime64(189912315959.1);
SELECT YYYYMMDDhhmmssToDateTime64(19000101000000.1);
SELECT YYYYMMDDhhmmssToDateTime64(20200229111111.1);
SELECT YYYYMMDDhhmmssToDateTime64(20230911150505.1);
SELECT YYYYMMDDhhmmssToDateTime64(22991231235959.1);
SELECT YYYYMMDDhhmmssToDateTime64(23000101000000.1);
SELECT 'Check correctness, decimal arguments';
SELECT YYYYMMDDhhmmssToDateTime64(toDecimal64(189912315959.1, 5));
SELECT YYYYMMDDhhmmssToDateTime64(toDecimal64(19000101000000.1, 5));
SELECT YYYYMMDDhhmmssToDateTime64(toDecimal64(20200229111111.1, 5));
SELECT YYYYMMDDhhmmssToDateTime64(toDecimal64(20230911150505.1, 5));
SELECT YYYYMMDDhhmmssToDateTime64(toDecimal64(22991231235959.1, 5));
SELECT YYYYMMDDhhmmssToDateTime64(toDecimal64(23000101000000.1, 5));
SELECT 'Special cases';
SELECT YYYYMMDDhhmmssToDateTime64(-20230911111111);
SELECT YYYYMMDDhhmmssToDateTime64(110);
SELECT YYYYMMDDhhmmssToDateTime64(999999999999999999);
SELECT YYYYMMDDhhmmssToDateTime64(15001113111111);
SELECT YYYYMMDDhhmmssToDateTime64(35001113111111);
SELECT YYYYMMDDhhmmssToDateTime64(20231620111111);
SELECT YYYYMMDDhhmmssToDateTime64(20230020111111);
SELECT YYYYMMDDhhmmssToDateTime64(20230940111111);
SELECT YYYYMMDDhhmmssToDateTime64(20230900111111);
SELECT YYYYMMDDhhmmssToDateTime64(20230228111111);
SELECT YYYYMMDDhhmmssToDateTime64(True);
SELECT YYYYMMDDhhmmssToDateTime64(False);
SELECT YYYYMMDDhhmmssToDateTime64(NULL);
SELECT YYYYMMDDhhmmssToDateTime64(yyyymmdd) FROM (SELECT 19840121 AS yyyymmdd UNION ALL SELECT 20230911 AS yyyymmdd) ORDER BY yyyymmdd;
