SELECT 'DST boundary test for Europe/Moscow:';
SELECT number,(toDateTime('1981-04-01 22:40:00', 'Europe/Moscow') + INTERVAL number * 600 SECOND) AS k, timezoneOffset(k) AS t, toUnixTimestamp(k) as s FROM numbers(4);
SELECT 'DST boundary test for Asia/Tehran:';
SELECT 'DST boundary test for Australia/Lord_Howe. This is a special timezone with DST offset is 30mins with the timezone epoc also lays at half hour';
SELECT timezoneOffset(toDateTime('2018-08-21 22:20:00', 'Australia/Lord_Howe'));
SELECT 'DST boundary test for Australia/Lord_Howe:';
SELECT '4 days test in batch comparing with manually computation result for Europe/Moscow:';
SELECT '4 days test in batch comparing with manually computation result for Asia/Tehran:';
SELECT '4 days test in batch comparing with manually computation result for Australia/Lord_Howe';
SELECT 'Moscow DST Years:';
SELECT 'Moscow DST Years with perment DST from 2011-2014:';
SELECT min((toDateTime('2011-01-01 00:00:00', 'Europe/Moscow') + INTERVAL number DAY) as day) as start, max(day) as end, count(1), concat(toString(toYear(day)),'_',toString(timezoneOffset(day)))as DST from numbers(365*4+1) group by DST order by start;
SELECT 'Tehran DST Years:';
SELECT 'Shanghai DST Years:';
