set allow_suspicious_low_cardinality_types=1;
drop table if exists perf_lc_num;
CREATE TABLE perf_lc_num(ã        num UInt8,ã        arr Array(LowCardinality(Int64)) default [num]ã        ) ENGINE = TinyLog;
INSERT INTO perf_lc_num (num) SELECT toUInt8(number) FROM numbers(10000000);
select sum(length(arr)) from perf_lc_num;
select sum(length(arr)), sum(num) from perf_lc_num;
INSERT INTO perf_lc_num (num) SELECT toUInt8(number) FROM numbers(10000000);
select sum(length(arr)) from perf_lc_num;
select sum(length(arr)), sum(num) from perf_lc_num;
drop table if exists perf_lc_num;
CREATE TABLE perf_lc_num(ã        num UInt8,ã        arr Array(LowCardinality(Int64)) default [num]ã        ) ENGINE = Log;
INSERT INTO perf_lc_num (num) SELECT toUInt8(number) FROM numbers(10000000);
select sum(length(arr)) from perf_lc_num;
select sum(length(arr)), sum(num) from perf_lc_num;
INSERT INTO perf_lc_num (num) SELECT toUInt8(number) FROM numbers(10000000);
select sum(length(arr)) from perf_lc_num;
select sum(length(arr)), sum(num) from perf_lc_num;
drop table if exists perf_lc_num;
CREATE TABLE perf_lc_num(ã        num UInt8,ã        arr Array(LowCardinality(Int64)) default [num]ã        ) ENGINE = StripeLog;
INSERT INTO perf_lc_num (num) SELECT toUInt8(number) FROM numbers(10000000);
select sum(length(arr)) from perf_lc_num;
select sum(length(arr)), sum(num) from perf_lc_num;
INSERT INTO perf_lc_num (num) SELECT toUInt8(number) FROM numbers(10000000);
select sum(length(arr)) from perf_lc_num;
select sum(length(arr)), sum(num) from perf_lc_num;
drop table if exists perf_lc_num;