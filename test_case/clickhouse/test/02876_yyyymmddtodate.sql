SELECT '--- YYYYMMDDToDate';
SELECT 'Invalid input types are rejected';
SELECT 'Result type is Date';
SELECT toTypeName(YYYYMMDDToDate(19910824));
SELECT toTypeName(YYYYMMDDToDate(cast(19910824 AS Nullable(UInt64))));
SELECT 'Check correctness, integer arguments';
SELECT YYYYMMDDToDate(19691231);
SELECT YYYYMMDDToDate(19700101);
SELECT YYYYMMDDToDate(20200229);
SELECT YYYYMMDDToDate(20230911);
SELECT YYYYMMDDToDate(21490606);
SELECT YYYYMMDDToDate(21490607);
SELECT YYYYMMDDToDate(9223372036854775807);
SELECT 'Check correctness, float arguments';
SELECT YYYYMMDDToDate(19691231.1);
SELECT YYYYMMDDToDate(19700101.1);
SELECT YYYYMMDDToDate(20200229.1);
SELECT YYYYMMDDToDate(20230911.1);
SELECT YYYYMMDDToDate(21490606.1);
SELECT YYYYMMDDToDate(21490607.1);
SELECT 'Check correctness, decimal arguments';
SELECT YYYYMMDDToDate(toDecimal64(19691231.1, 5));
SELECT YYYYMMDDToDate(toDecimal64(19700101.1, 5));
SELECT YYYYMMDDToDate(toDecimal64(20200229.1, 5));
SELECT YYYYMMDDToDate(toDecimal64(20230911.1, 5));
SELECT YYYYMMDDToDate(toDecimal64(21490606.1, 5));
SELECT YYYYMMDDToDate(toDecimal64(21490607.1, 5));
SELECT 'Special cases';
SELECT YYYYMMDDToDate(-20230911);
SELECT YYYYMMDDToDate(110);
SELECT YYYYMMDDToDate(9999999999999);
SELECT YYYYMMDDToDate(15001113);
SELECT YYYYMMDDToDate(35001113);
SELECT YYYYMMDDToDate(20231620);
SELECT YYYYMMDDToDate(20230020);
SELECT YYYYMMDDToDate(20230940);
SELECT YYYYMMDDToDate(20230900);
SELECT YYYYMMDDToDate(20230228);
SELECT YYYYMMDDToDate(True);
SELECT YYYYMMDDToDate(False);
SELECT YYYYMMDDToDate(NULL);
SELECT YYYYMMDDToDate(yyyymmdd) FROM (SELECT 19840121 AS yyyymmdd UNION ALL SELECT 20230911 AS yyyymmdd) ORDER BY yyyymmdd;
-----------------------------------------------------------
SELECT '--- YYYYMMDDToDate32';
SELECT 'Invalid input types are rejected';
SELECT 'Result type is Date32';
SELECT toTypeName(YYYYMMDDToDate32(19910824));
SELECT toTypeName(YYYYMMDDToDate32(cast(19910824 AS Nullable(UInt64))));
SELECT 'Check correctness, integer arguments';
SELECT YYYYMMDDToDate32(18991231);
SELECT YYYYMMDDToDate32(19000101);
SELECT YYYYMMDDToDate32(20200229);
SELECT YYYYMMDDToDate32(20230911);
SELECT YYYYMMDDToDate32(23000101);
SELECT YYYYMMDDToDate32(9223372036854775807);
SELECT 'Check correctness, float arguments';
SELECT YYYYMMDDToDate32(18991231.1);
SELECT YYYYMMDDToDate32(19000101.1);
SELECT YYYYMMDDToDate32(20200229.1);
SELECT YYYYMMDDToDate32(20230911.1);
SELECT YYYYMMDDToDate32(23000101.1);
SELECT 'Check correctness, decimal arguments';
SELECT YYYYMMDDToDate32(toDecimal64(18991231.1, 5));
SELECT YYYYMMDDToDate32(toDecimal64(19000101.1, 5));
SELECT YYYYMMDDToDate32(toDecimal64(20200229.1, 5));
SELECT YYYYMMDDToDate32(toDecimal64(20230911.1, 5));
SELECT YYYYMMDDToDate32(toDecimal64(23000101.1, 5));
SELECT 'Special cases';
SELECT YYYYMMDDToDate32(-20230911);
SELECT YYYYMMDDToDate32(110);
SELECT YYYYMMDDToDate32(9999999999999);
SELECT YYYYMMDDToDate32(15001113);
SELECT YYYYMMDDToDate32(35001113);
SELECT YYYYMMDDToDate32(20231620);
SELECT YYYYMMDDToDate32(20230020);
SELECT YYYYMMDDToDate32(20230940);
SELECT YYYYMMDDToDate32(20230900);
SELECT YYYYMMDDToDate32(20230228);
SELECT YYYYMMDDToDate32(True);
SELECT YYYYMMDDToDate32(False);
SELECT YYYYMMDDToDate32(NULL);
SELECT YYYYMMDDToDate32(yyyymmdd) FROM (SELECT 19840121 AS yyyymmdd UNION ALL SELECT 20230911 AS yyyymmdd) ORDER BY yyyymmdd;
