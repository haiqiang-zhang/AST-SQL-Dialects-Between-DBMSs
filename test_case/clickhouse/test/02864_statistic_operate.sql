SHOW CREATE TABLE t1;
INSERT INTO t1 select number, -number, generateUUIDv4() FROM system.numbers LIMIT 10000;
SELECT 'After insert';
SELECT replaceRegexpAll(explain, '__table1\.|_UInt8', '') FROM (EXPLAIN actions=1 SELECT count(*) FROM t1 WHERE b < 10 and a < 10) WHERE explain LIKE '%Prewhere%' OR explain LIKE '%Filter column%';
SELECT count(*) FROM t1 WHERE b < 10 and a < 10;
ALTER TABLE t1 DROP STATISTIC a, b TYPE tdigest;
SELECT 'After drop statistic';
SHOW CREATE TABLE t1;
ALTER TABLE t1 ADD STATISTIC a, b TYPE tdigest;
SELECT 'After add statistic';
SHOW CREATE TABLE t1;
ALTER TABLE t1 MATERIALIZE STATISTIC a, b TYPE tdigest;
INSERT INTO t1 select number, -number, generateUUIDv4() FROM system.numbers LIMIT 10000;
SELECT 'After materialize statistic';
OPTIMIZE TABLE t1 FINAL;
SELECT 'After merge';
ALTER TABLE t1 RENAME COLUMN b TO c;
SHOW CREATE TABLE t1;
SELECT 'After rename';
DROP TABLE IF EXISTS t1;
