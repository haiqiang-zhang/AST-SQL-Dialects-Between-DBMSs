--Query--
SELECT [2, 1, 3] AS arr, arraySort(arr), arrayReverseSort(arr), arraySort(x -> -x, arr)
--Result--
[([2, 1, 3], [1, 2, 3], [3, 2, 1], [3, 2, 1])]
+--------------------+
--Query--
SELECT splitByChar('0', toString(intHash64(number))) AS arr, arraySort(arr) AS sorted, arraySort(x -> toUInt64OrZero(x), arr) AS sorted_nums FROM system.numbers LIMIT 10
--Result--
[(['476118317', '873', '1381', ''], ['', '1381', '476118317', '873'], ['', '873', '1381', '476118317']), (['1', '577349846663553', '72'], ['1', '577349846663553', '72'], ['1', '72', '577349846663553']), (['181981357172', '4167749'], ['181981357172', '4167749'], ['4167749', '181981357172']), (['962446486456', '415994'], ['415994', '962446486456'], ['415994', '962446486456']), (['77667', '936175', '7', '26', '8'], ['26', '7', '77667', '8', '936175'], ['7', '8', '26', '77667', '936175']), (['152285784', '9', '6979435', ''], ['', '152285784', '6979435', '9'], ['', '9', '6979435', '152285784']), (['12742', '4333384', '853', '32'], ['12742', '32', '4333384', '853'], ['32', '853', '12742', '4333384']), (['1336581123286', '26', '488'], ['1336581123286', '26', '488'], ['26', '488', '1336581123286']), (['117', '', '', '3455837413562', ''], ['', '', '', '117', '3455837413562'], ['', '', '', '117', '3455837413562']), (['441693', '539393268817'], ['441693', '539393268817'], ['441693', '539393268817'])]
+--------------------+
--Query--
SELECT arrayReverseSort(number % 2 ? emptyArrayUInt64() : range(number)) FROM system.numbers LIMIT 10
--Result--
[([],), ([],), ([1, 0],), ([],), ([3, 2, 1, 0],), ([],), ([5, 4, 3, 2, 1, 0],), ([],), ([7, 6, 5, 4, 3, 2, 1, 0],), ([],)]
+--------------------+
--Query--
SELECT arraySort((x, y) -> y, ['hello', 'world'], [2, 1])
--Result--
[(['world', 'hello'],)]
+--------------------+
--Query--
SELECT [9,4,8,10,5,2,3,7,1,6] AS arr, 4 AS lim, arrayResize(arrayPartialReverseSort(lim, arr), lim), arrayResize(arrayPartialSort(x -> -x, lim, arr), lim)
--Result--
[([9, 4, 8, 10, 5, 2, 3, 7, 1, 6], 4, [10, 9, 8, 7], [10, 9, 8, 7])]
+--------------------+
--Query--
SELECT splitByChar('0', toString(intHash64(number))) AS arr, 3 AS lim, arrayResize(arrayPartialSort(lim, arr), lim) AS sorted, arrayResize(arrayPartialSort(x -> toUInt64OrZero(x), lim, arr), lim) AS sorted_nums FROM system.numbers LIMIT 10
--Result--
[(['476118317', '873', '1381', ''], 3, ['', '1381', '476118317'], ['', '873', '1381']), (['1', '577349846663553', '72'], 3, ['1', '577349846663553', '72'], ['1', '72', '577349846663553']), (['181981357172', '4167749'], 3, ['181981357172', '4167749', ''], ['4167749', '181981357172', '']), (['962446486456', '415994'], 3, ['415994', '962446486456', ''], ['415994', '962446486456', '']), (['77667', '936175', '7', '26', '8'], 3, ['26', '7', '77667'], ['7', '8', '26']), (['152285784', '9', '6979435', ''], 3, ['', '152285784', '6979435'], ['', '9', '6979435']), (['12742', '4333384', '853', '32'], 3, ['12742', '32', '4333384'], ['32', '853', '12742']), (['1336581123286', '26', '488'], 3, ['1336581123286', '26', '488'], ['26', '488', '1336581123286']), (['117', '', '', '3455837413562', ''], 3, ['', '', ''], ['', '', '']), (['441693', '539393268817'], 3, ['441693', '539393268817', ''], ['441693', '539393268817', ''])]
+--------------------+
--Query--
SELECT res FROM (SELECT arrayPartialReverseSort(2, number % 2 ? emptyArrayUInt64() : range(number)) AS arr, arrayResize(arr, if(empty(arr), 0, 2)) AS res FROM system.numbers LIMIT 10)
--Result--
[([],), ([],), ([1, 0],), ([],), ([3, 2],), ([],), ([5, 4],), ([],), ([7, 6],), ([],)]
+--------------------+
--Query--
SELECT 0 as nelems, [NULL,9,4,8,10,5,2,3,7,1,6] AS arr, arrayPartialSort(nelems, arr), arrayPartialReverseSort(nelems, arr), arrayPartialSort((x) -> -x, nelems, arr)
--Result--
[(0, [None, 9, 4, 8, 10, 5, 2, 3, 7, 1, 6], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, None], [10, 9, 8, 7, 6, 5, 4, 3, 2, 1, None], [10, 9, 8, 7, 6, 5, 4, 3, 2, 1, None])]
+--------------------+
