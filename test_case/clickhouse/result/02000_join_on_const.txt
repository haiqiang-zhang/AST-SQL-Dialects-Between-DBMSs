--Query--
SELECT 70 = 10 * sum(t1.id) + sum(t2.id) AND count() == 4 FROM t1 JOIN t2 ON 1 = 1
--Result--
[(1,)]
+--------------------+
--Query--
SELECT 70 = 10 * sum(t1.id) + sum(t2.id) AND count() == 4 FROM t1 JOIN t2 ON 1
--Result--
[(1,)]
+--------------------+
--Query--
SELECT 70 = 10 * sum(t1.id) + sum(t2.id) AND count() == 4 FROM t1 JOIN t2 ON 2 = 2 AND 3 = 3
--Result--
[(1,)]
+--------------------+
--Query--
SELECT 70 = 10 * sum(t1.id) + sum(t2.id) AND count() == 4 FROM t1 JOIN t2 ON toNullable(1)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT 70 = 10 * sum(t1.id) + sum(t2.id) AND count() == 4 FROM t1 JOIN t2 ON toLowCardinality(1)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT '- ON NULL -'
--Result--
[('- ON NULL -',)]
+--------------------+
--Query--
SELECT '- inner -'
--Result--
[('- inner -',)]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON NULL
--Result--
[]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON 0
--Result--
[]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON 1 = 2
--Result--
[]
+--------------------+
--Query--
SELECT '- left -'
--Result--
[('- left -',)]
+--------------------+
--Query--
SELECT * FROM t1 LEFT JOIN t2 ON NULL ORDER BY t1.id, t2.id
--Result--
[(1, 0), (2, 0)]
+--------------------+
--Query--
SELECT '- right -'
--Result--
[('- right -',)]
+--------------------+
--Query--
SELECT * FROM t1 RIGHT JOIN t2 ON NULL ORDER BY t1.id, t2.id
--Result--
[(0, 2), (0, 3)]
+--------------------+
--Query--
SELECT '- full -'
--Result--
[('- full -',)]
+--------------------+
--Query--
SELECT * FROM t1 FULL JOIN t2 ON NULL ORDER BY t1.id, t2.id
--Result--
[(0, 2), (0, 3), (1, 0), (2, 0)]
+--------------------+
--Query--
SELECT '- inner -'
--Result--
[('- inner -',)]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON NULL ORDER BY t1.id NULLS FIRST, t2.id SETTINGS join_use_nulls = 1
--Result--
[]
+--------------------+
--Query--
SELECT '- left -'
--Result--
[('- left -',)]
+--------------------+
--Query--
SELECT * FROM t1 LEFT JOIN t2 ON NULL ORDER BY t1.id NULLS FIRST, t2.id SETTINGS join_use_nulls = 1
--Result--
[(1, None), (2, None)]
+--------------------+
--Query--
SELECT '- right -'
--Result--
[('- right -',)]
+--------------------+
--Query--
SELECT * FROM t1 RIGHT JOIN t2 ON NULL ORDER BY t1.id NULLS FIRST, t2.id SETTINGS join_use_nulls = 1
--Result--
[(None, 2), (None, 3)]
+--------------------+
--Query--
SELECT '- full -'
--Result--
[('- full -',)]
+--------------------+
--Query--
SELECT * FROM t1 FULL JOIN t2 ON NULL ORDER BY t1.id NULLS FIRST, t2.id SETTINGS join_use_nulls = 1
--Result--
[(None, 2), (None, 3), (1, None), (2, None)]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id AND 1 == 1 SETTINGS allow_experimental_analyzer = 1
--Result--
[(2, 2)]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id AND 1 == 2 SETTINGS allow_experimental_analyzer = 1
--Result--
[]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id AND 1 != 1 SETTINGS allow_experimental_analyzer = 1
--Result--
[]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id AND 0 SETTINGS allow_experimental_analyzer = 1
--Result--
[]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id AND 1 SETTINGS allow_experimental_analyzer = 1
--Result--
[(2, 2)]
+--------------------+
--Query--
SELECT * FROM t1 LEFT JOIN t2 ON t1.id = t2.id AND 1 = 1 SETTINGS allow_experimental_analyzer = 1
--Result--
[(1, 0), (2, 2)]
+--------------------+
--Query--
SELECT * FROM t1 RIGHT JOIN t2 ON t1.id = t2.id AND 1 = 1 SETTINGS allow_experimental_analyzer = 1
--Result--
[(2, 2), (0, 3)]
+--------------------+
--Query--
SELECT * FROM t1 FULL JOIN t2 ON t1.id = t2.id AND 1 = 1 SETTINGS allow_experimental_analyzer = 1
--Result--
[(1, 0), (2, 2), (0, 3)]
+--------------------+
--Query--
SELECT * FROM t1 LEFT JOIN t2 ON t1.id = t2.id AND 1 = 2 SETTINGS allow_experimental_analyzer = 1
--Result--
[(1, 0), (2, 0)]
+--------------------+
--Query--
SELECT * FROM t1 RIGHT JOIN t2 ON t1.id = t2.id AND 1 = 2 SETTINGS allow_experimental_analyzer = 1
--Result--
[(0, 2), (0, 3)]
+--------------------+
--Query--
SELECT * FROM t1 FULL JOIN t2 ON t1.id = t2.id AND 1 = 2 SETTINGS allow_experimental_analyzer = 1
--Result--
[(1, 0), (2, 0), (0, 2), (0, 3)]
+--------------------+
--Query--
SELECT * FROM (SELECT 1 as a) as t1 INNER JOIN  ( SELECT ('b', 256) as b ) AS t2 ON NULL
--Result--
[]
+--------------------+
--Query--
SELECT * FROM (SELECT 1 as a) as t1 LEFT JOIN  ( SELECT ('b', 256) as b ) AS t2 ON NULL
--Result--
[(1, ('', 0))]
+--------------------+
--Query--
SELECT * FROM (SELECT 1 as a) as t1 RIGHT JOIN  ( SELECT ('b', 256) as b ) AS t2 ON NULL
--Result--
[(0, ('b', 256))]
+--------------------+
--Query--
SELECT * FROM (SELECT 1 as a) as t1 FULL JOIN  ( SELECT ('b', 256) as b ) AS t2 ON NULL
--Result--
[(1, ('', 0)), (0, ('b', 256))]
+--------------------+
--Query--
SELECT * FROM (SELECT 1 as a) as t1 SEMI JOIN  ( SELECT ('b', 256) as b ) AS t2 ON NULL
--Result--
[]
+--------------------+
--Query--
SELECT * FROM (SELECT 1 as a) as t1 ANTI JOIN  ( SELECT ('b', 256) as b ) AS t2 ON NULL
--Result--
[(1, ('', 0))]
+--------------------+
--Query--
SELECT a + 1 FROM (SELECT 1 as x) as t1 LEFT JOIN ( SELECT 1 AS a ) AS t2 ON TRUE SETTINGS allow_experimental_analyzer=1, join_use_nulls=1
--Result--
[(2,)]
+--------------------+
--Query--
SELECT a + 1, x + 1, toTypeName(a), toTypeName(x) FROM (SELECT 1 as x) as t1 LEFT JOIN ( SELECT sum(number) as a from numbers(3) GROUP BY NULL) AS t2 ON TRUE SETTINGS allow_experimental_analyzer=1, join_use_nulls=1
--Result--
[(4, 2, 'Nullable(UInt64)', 'UInt8')]
+--------------------+
