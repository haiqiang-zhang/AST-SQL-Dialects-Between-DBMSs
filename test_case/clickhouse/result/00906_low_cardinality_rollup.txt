--Query--
SELECT a, b, count(a) FROM lc GROUP BY a, b WITH ROLLUP ORDER BY a, b
--Result--
[('a', 'b', 1), ('a', None, 1), ('c', 'd', 1), ('c', None, 1), (None, None, 2)]
+--------------------+
