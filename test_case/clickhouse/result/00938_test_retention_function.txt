--Query--
SELECT uid, retention(date = '2018-08-06', date = '2018-08-07') AS r FROM retention_test WHERE date IN ('2018-08-06', '2018-08-07') GROUP BY uid ORDER BY uid LIMIT 5
--Result--
[(0, [1, 1]), (1, [1, 1]), (2, [1, 1]), (3, [1, 1]), (4, [1, 1])]
+--------------------+
--Query--
SELECT '----------'
--Result--
[('----------',)]
+--------------------+
--Query--
SELECT uid, retention(1, date = '2018-08-06', date = '2018-08-07') AS r FROM retention_test WHERE date IN ('2018-08-06', '2018-08-07') GROUP BY uid ORDER BY uid LIMIT 5
--Result--
[(0, [1, 1, 1]), (1, [1, 1, 1]), (2, [1, 1, 1]), (3, [1, 1, 1]), (4, [1, 1, 1])]
+--------------------+
--Query--
SELECT '----------'
--Result--
[('----------',)]
+--------------------+
--Query--
SELECT uid, retention(uid % 2 = 0, date = '2018-08-06', date = '2018-08-07') AS r FROM retention_test WHERE date IN ('2018-08-06', '2018-08-07') GROUP BY uid ORDER BY uid LIMIT 5
--Result--
[(0, [1, 1, 1]), (1, [0, 0, 0]), (2, [1, 1, 1]), (3, [0, 0, 0]), (4, [1, 1, 1])]
+--------------------+
