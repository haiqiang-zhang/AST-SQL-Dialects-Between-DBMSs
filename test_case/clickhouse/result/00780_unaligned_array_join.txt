--Query--
SELECT number, arr1, arr2, x, y FROM (SELECT number, range(number % 2) AS arr1, range(number % 3) arr2 FROM system.numbers LIMIT 10) ARRAY JOIN arr1 AS x, arr2 AS y SETTINGS enable_unaligned_array_join = 1
--Result--
[(1, [0], [0], 0, 0), (2, [], [0, 1], 0, 0), (2, [], [0, 1], 0, 1), (3, [0], [], 0, 0), (4, [], [0], 0, 0), (5, [0], [0, 1], 0, 0), (5, [0], [0, 1], 0, 1), (7, [0], [0], 0, 0), (8, [], [0, 1], 0, 0), (8, [], [0, 1], 0, 1), (9, [0], [], 0, 0)]
+--------------------+
--Query--
SELECT number, arr1, arr2, x, y FROM (SELECT number, range(number % 2) AS arr1, range(number % 3) arr2 FROM system.numbers LIMIT 10) LEFT ARRAY JOIN arr1 AS x, arr2 AS y SETTINGS enable_unaligned_array_join = 1
--Result--
[(0, [], [], 0, 0), (1, [0], [0], 0, 0), (2, [], [0, 1], 0, 0), (2, [], [0, 1], 0, 1), (3, [0], [], 0, 0), (4, [], [0], 0, 0), (5, [0], [0, 1], 0, 0), (5, [0], [0, 1], 0, 1), (6, [], [], 0, 0), (7, [0], [0], 0, 0), (8, [], [0, 1], 0, 0), (8, [], [0, 1], 0, 1), (9, [0], [], 0, 0)]
+--------------------+
