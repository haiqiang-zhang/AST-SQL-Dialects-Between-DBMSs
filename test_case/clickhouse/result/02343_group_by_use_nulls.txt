--Query--
SELECT number, number % 2, sum(number) AS val FROM numbers(10) GROUP BY ROLLUP(number, number % 2) ORDER BY (number, number % 2, val) SETTINGS group_by_use_nulls=1
--Result--
[(0, 0, 0), (0, None, 0), (1, 1, 1), (1, None, 1), (2, 0, 2), (2, None, 2), (3, 1, 3), (3, None, 3), (4, 0, 4), (4, None, 4), (5, 1, 5), (5, None, 5), (6, 0, 6), (6, None, 6), (7, 1, 7), (7, None, 7), (8, 0, 8), (8, None, 8), (9, 1, 9), (9, None, 9), (None, None, 45)]
+--------------------+
--Query--
SELECT number, number % 2, sum(number) AS val FROM numbers(10) GROUP BY CUBE(number, number % 2) ORDER BY (number, number % 2, val) SETTINGS group_by_use_nulls=1
--Result--
[(0, 0, 0), (0, None, 0), (1, 1, 1), (1, None, 1), (2, 0, 2), (2, None, 2), (3, 1, 3), (3, None, 3), (4, 0, 4), (4, None, 4), (5, 1, 5), (5, None, 5), (6, 0, 6), (6, None, 6), (7, 1, 7), (7, None, 7), (8, 0, 8), (8, None, 8), (9, 1, 9), (9, None, 9), (None, 0, 20), (None, 1, 25), (None, None, 45)]
+--------------------+
--Query--
SELECT     number,     number % 2,     sum(number) AS val FROM numbers(10) GROUP BY     GROUPING SETS (         (number),         (number % 2)     ) ORDER BY (number, number % 2, val) SETTINGS group_by_use_nulls = 1
--Result--
[(0, None, 0), (1, None, 1), (2, None, 2), (3, None, 3), (4, None, 4), (5, None, 5), (6, None, 6), (7, None, 7), (8, None, 8), (9, None, 9), (None, 0, 20), (None, 1, 25)]
+--------------------+
