--Query--
SELECT intDiv(number, 100) AS k, length(groupArray(number)) FROM (SELECT * FROM system.numbers LIMIT 1000000) GROUP BY k WITH TOTALS ORDER BY k LIMIT 10
--Result--
[(0, 100), (1, 100), (2, 100), (3, 100), (4, 100), (5, 100), (6, 100), (7, 100), (8, 100), (9, 100), (0, 1000000)]
+--------------------+
--Query--
SELECT ''
--Result--
[('',)]
+--------------------+
--Query--
SELECT count(), sum(ns), max(ns) FROM (SELECT intDiv(number, 100) AS k, groupArray(number) AS ns FROM numbers_mt GROUP BY k) ARRAY JOIN ns
--Result--
[(1000000, 500000500000, 1000000)]
+--------------------+
--Query--
SELECT ''
--Result--
[('',)]
+--------------------+
--Query--
SELECT ''
--Result--
[('',)]
+--------------------+
