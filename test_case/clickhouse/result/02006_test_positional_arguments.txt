--Query--
select x3, x2, x1 from test order by 1
--Result--
[(1, 100, 100), (10, 1, 10), (100, 10, 1)]
+--------------------+
--Query--
select x3, x2, x1 from test order by -3
--Result--
[(1, 100, 100), (10, 1, 10), (100, 10, 1)]
+--------------------+
--Query--
select x3, x2, x1 from test order by x3
--Result--
[(1, 100, 100), (10, 1, 10), (100, 10, 1)]
+--------------------+
--Query--
select x3, x2, x1 from test order by 3
--Result--
[(100, 10, 1), (10, 1, 10), (1, 100, 100)]
+--------------------+
--Query--
select x3, x2, x1 from test order by -1
--Result--
[(100, 10, 1), (10, 1, 10), (1, 100, 100)]
+--------------------+
--Query--
select x3, x2, x1 from test order by x1
--Result--
[(100, 10, 1), (10, 1, 10), (1, 100, 100)]
+--------------------+
--Query--
select x3, x2, x1 from test order by 1 desc
--Result--
[(100, 10, 1), (10, 1, 10), (1, 100, 100)]
+--------------------+
--Query--
select x3, x2, x1 from test order by -3 desc
--Result--
[(100, 10, 1), (10, 1, 10), (1, 100, 100)]
+--------------------+
--Query--
select x3, x2, x1 from test order by x3 desc
--Result--
[(100, 10, 1), (10, 1, 10), (1, 100, 100)]
+--------------------+
--Query--
select x3, x2, x1 from test order by 3 desc
--Result--
[(1, 100, 100), (10, 1, 10), (100, 10, 1)]
+--------------------+
--Query--
select x3, x2, x1 from test order by -1 desc
--Result--
[(1, 100, 100), (10, 1, 10), (100, 10, 1)]
+--------------------+
--Query--
select x3, x2, x1 from test order by x1 desc
--Result--
[(1, 100, 100), (10, 1, 10), (100, 10, 1)]
+--------------------+
--Query--
select x3, x2 from test group by x3, x2 order by x3
--Result--
[(1, 100), (10, 1), (100, 10)]
+--------------------+
--Query--
select x3, x2 from test group by 1, 2 order by x3
--Result--
[(1, 100), (10, 1), (100, 10)]
+--------------------+
--Query--
select x1, x2, x3 from test order by x3 limit 1 by x3
--Result--
[(100, 100, 1), (10, 1, 10), (1, 10, 100)]
+--------------------+
--Query--
select x1, x2, x3 from test order by 3 limit 1 by 3
--Result--
[(100, 100, 1), (10, 1, 10), (1, 10, 100)]
+--------------------+
--Query--
select x1, x2, x3 from test order by x3 limit 1 by x1
--Result--
[(100, 100, 1), (10, 1, 10), (1, 10, 100)]
+--------------------+
--Query--
select x1, x2, x3 from test order by 3 limit 1 by 1
--Result--
[(100, 100, 1), (10, 1, 10), (1, 10, 100)]
+--------------------+
--Query--
explain syntax select x3, x2, x1 from test order by 1
--Result--
[('SELECT',), ('    x3,',), ('    x2,',), ('    x1',), ('FROM test',), ('ORDER BY x3 ASC',)]
+--------------------+
--Query--
explain syntax select x3 + 1, x2, x1 from test order by 1
--Result--
[('SELECT',), ('    x3 + 1,',), ('    x2,',), ('    x1',), ('FROM test',), ('ORDER BY x3 + 1 ASC',)]
+--------------------+
--Query--
explain syntax select x3, x2, x1 from test order by -1
--Result--
[('SELECT',), ('    x3,',), ('    x2,',), ('    x1',), ('FROM test',), ('ORDER BY x1 ASC',)]
+--------------------+
--Query--
explain syntax select x3 + 1, x2, x1 from test order by -1
--Result--
[('SELECT',), ('    x3 + 1,',), ('    x2,',), ('    x1',), ('FROM test',), ('ORDER BY x1 ASC',)]
+--------------------+
--Query--
explain syntax select x3, x3 - x2, x2, x1 from test order by 2
--Result--
[('SELECT',), ('    x3,',), ('    x3 - x2,',), ('    x2,',), ('    x1',), ('FROM test',), ('ORDER BY x3 - x2 ASC',)]
+--------------------+
--Query--
explain syntax select x3, x3 - x2, x2, x1 from test order by -2
--Result--
[('SELECT',), ('    x3,',), ('    x3 - x2,',), ('    x2,',), ('    x1',), ('FROM test',), ('ORDER BY x2 ASC',)]
+--------------------+
--Query--
explain syntax select x3, if(x3 > 10, x3, plus(x1, x2)), x1 + x2 from test order by 2
--Result--
[('SELECT',), ('    x3,',), ('    if(x3 > 10, x3, x1 + x2),',), ('    x1 + x2',), ('FROM test',), ('ORDER BY if(x3 > 10, x3, x1 + x2) ASC',)]
+--------------------+
--Query--
explain syntax select max(x1), x2 from test group by 2 order by 1, 2
--Result--
[('SELECT',), ('    max(x1),',), ('    x2',), ('FROM test',), ('GROUP BY x2',), ('ORDER BY',), ('    max(x1) ASC,',), ('    x2 ASC',)]
+--------------------+
--Query--
explain syntax select 1 + greatest(x1, 1), x2 from test group by 1, 2
--Result--
[('SELECT',), ('    1 + greatest(x1, 1),',), ('    x2',), ('FROM test',), ('GROUP BY',), ('    1 + greatest(x1, 1),',), ('    x2',)]
+--------------------+
--Query--
explain syntax select 1 + greatest(x1, 1), x2 from test group by -2, -1
--Result--
[('SELECT',), ('    1 + greatest(x1, 1),',), ('    x2',), ('FROM test',), ('GROUP BY',), ('    1 + greatest(x1, 1),',), ('    x2',)]
+--------------------+
--Query--
explain syntax select x1 + x3, x3 from test group by 1, 2
--Result--
[('SELECT',), ('    x1 + x3,',), ('    x3',), ('FROM test',), ('GROUP BY',), ('    x1 + x3,',), ('    x3',)]
+--------------------+
--Query--
explain syntax select x1 + x3, x3 from test group by -2, -1
--Result--
[('SELECT',), ('    x1 + x3,',), ('    x3',), ('FROM test',), ('GROUP BY',), ('    x1 + x3,',), ('    x3',)]
+--------------------+
--Query--
select x1, x1 * 2, max(x2), max(x3) from test2 group by 2, 1, x1 order by 1, 2, 4 desc, 3 asc
--Result--
[(1, 2, 10, 100), (10, 20, 1, 10), (100, 200, 100, 1)]
+--------------------+
--Query--
select a, b, c, d, e, f  from (select 44 a, 88 b, 13 c, 14 d, 15 e, 16 f) t group by 1,2,3,4,5,6 order by a
--Result--
[(44, 88, 13, 14, 15, 16)]
+--------------------+
--Query--
select a, b, c, d, e, f  from (select 44 a, 88 b, 13 c, 14 d, 15 e, 16 f) t group by 1,2,3,-3,-2,-1 order by a
--Result--
[(44, 88, 13, 14, 15, 16)]
+--------------------+
--Query--
explain syntax select plus(1, 1) as a group by a
--Result--
[('SELECT 1 + 1 AS a',), ('GROUP BY a',)]
+--------------------+
--Query--
select substr('aaaaaaaaaaaaaa', 8) as a  group by a order by a
--Result--
[('aaaaaaa',)]
+--------------------+
--Query--
select substr('aaaaaaaaaaaaaa', 8) as a  group by substr('aaaaaaaaaaaaaa', 8) order by a
--Result--
[('aaaaaaa',)]
+--------------------+
--Query--
select b from (select 5 as a, 'Hello' as b order by a)
--Result--
[('Hello',)]
+--------------------+
--Query--
select b from (select 5 as a, 'Hello' as b group by a)
--Result--
[('Hello',)]
+--------------------+
--Query--
select b from (select 5 as a, 'Hello' as b order by 1)
--Result--
[('Hello',)]
+--------------------+
--Query--
select count(*) from (select first_col, count(second_col) from tp2 group by 1)
--Result--
[(2,)]
+--------------------+
--Query--
select total from (select first_col, count(second_col) as total from tp2 group by 1)
--Result--
[(1,), (1,)]
+--------------------+
--Query--
select first_col from (select first_col, second_col as total from tp2 order by 1 desc)
--Result--
[('bbb',), ('aaa',)]
+--------------------+
--Query--
select first_col from (select first_col, second_col as total from tp2 order by 2 desc)
--Result--
[('aaa',), ('bbb',)]
+--------------------+
--Query--
select max from (select max(first_col) as max, second_col as total from tp2 group by 2) order by 1
--Result--
[('aaa',), ('bbb',)]
+--------------------+
--Query--
with res as (select first_col from (select first_col, second_col as total from tp2 order by 2 desc) limit 1) select * from res
--Result--
[('aaa',)]
+--------------------+
--Query--
select count(*) as `value`, 0 as `data` from test group by `data`
--Result--
[]
+--------------------+
