--Query--
SELECT COUNT() FROM merge_table_standard_delete
--Result--
[(99,)]
+--------------------+
--Query--
DETACH TABLE merge_table_standard_delete
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE merge_table_standard_delete
--Result--
[]
+--------------------+
--Query--
CHECK TABLE merge_table_standard_delete
--Result--
[(1,)]
+--------------------+
--Query--
DETACH TABLE merge_table_standard_delete
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE merge_table_standard_delete
--Result--
[]
+--------------------+
--Query--
CHECK TABLE merge_table_standard_delete
--Result--
[(1,)]
+--------------------+
--Query--
DETACH TABLE merge_table_standard_delete
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE merge_table_standard_delete
--Result--
[]
+--------------------+
--Query--
CHECK TABLE merge_table_standard_delete
--Result--
[(1,)]
+--------------------+
--Query--
SELECT '-----lightweight mutation type-----'
--Result--
[('-----lightweight mutation type-----',)]
+--------------------+
--Query--
DETACH TABLE t_light
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE t_light
--Result--
[]
+--------------------+
--Query--
CHECK TABLE t_light
--Result--
[(1,)]
+--------------------+
--Query--
DETACH TABLE t_light
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE t_light
--Result--
[]
+--------------------+
--Query--
CHECK TABLE t_light
--Result--
[(1,)]
+--------------------+
--Query--
DETACH TABLE t_light
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE t_light
--Result--
[]
+--------------------+
--Query--
CHECK TABLE t_light
--Result--
[(1,)]
+--------------------+
--Query--
SELECT command, is_done FROM system.mutations WHERE database = currentDatabase() AND table = 't_light'
--Result--
[('UPDATE _row_exists = 0 WHERE (c % 5) = 1', 1), ('UPDATE _row_exists = 0 WHERE c = 4', 1), ('MATERIALIZE INDEX i_c', 1), ('UPDATE b = -1 WHERE a < 3', 1), ('DROP INDEX i_c', 1)]
+--------------------+
--Query--
SELECT '-----Check that select and merge with lightweight delete.-----'
--Result--
[('-----Check that select and merge with lightweight delete.-----',)]
+--------------------+
--Query--
select count(*) from t_light
--Result--
[(7,)]
+--------------------+
--Query--
select * from t_light order by a
--Result--
[(0, -1, 0), (2, -1, 2), (3, 3, 3), (5, 5, 5), (7, 7, 7), (8, 8, 8), (9, 9, 9)]
+--------------------+
--Query--
select table, partition, name, rows from system.parts where database = currentDatabase() AND active and table ='t_light' order by name
--Result--
[('t_light', '0', '0_1_1_0_10', 2), ('t_light', '1', '1_2_2_0_10', 2), ('t_light', '2', '2_3_3_0_10', 2), ('t_light', '3', '3_4_4_0_10', 2), ('t_light', '4', '4_5_5_0_10', 2)]
+--------------------+
--Query--
optimize table t_light final SETTINGS mutations_sync=2
--Result--
[]
+--------------------+
--Query--
select table, partition, name, rows from system.parts where database = currentDatabase() AND active and table ='t_light' and rows > 0 order by name
--Result--
[('t_light', '0', '0_1_1_1_10', 2), ('t_light', '2', '2_3_3_1_10', 2), ('t_light', '3', '3_4_4_1_10', 2), ('t_light', '4', '4_5_5_1_10', 1)]
+--------------------+
--Query--
SELECT '-----Test lightweight delete in multi blocks-----'
--Result--
[('-----Test lightweight delete in multi blocks-----',)]
+--------------------+
--Query--
DETACH TABLE t_large
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE t_large
--Result--
[]
+--------------------+
--Query--
CHECK TABLE t_large
--Result--
[(1,)]
+--------------------+
--Query--
DETACH TABLE t_large
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE t_large
--Result--
[]
+--------------------+
--Query--
CHECK TABLE t_large
--Result--
[(1,)]
+--------------------+
--Query--
SELECT * FROM t_large WHERE a in (1,1000,1005,50000) order by a
--Result--
[(1000, -2), (1005, -2)]
+--------------------+
--Query--
SELECT '----Test lighweight delete is disabled if table has projections-----'
--Result--
[('----Test lighweight delete is disabled if table has projections-----',)]
+--------------------+
--Query--
SELECT avg(a), avg(b), count() FROM t_proj
--Result--
[(500.5, 500.5, 1000)]
+--------------------+
