--Query--
SELECT A.a, A.t, B.b, B.t FROM A ASOF LEFT JOIN B ON A.a == B.b AND A.t >= B.t ORDER BY (A.a, A.t)
--Result--
[(1, 1, 0, 0), (1, 2, 1, 2), (1, 3, 1, 2), (2, 1, 0, 0), (2, 2, 0, 0), (2, 3, 2, 3), (3, 1, 0, 0), (3, 2, 0, 0), (3, 3, 0, 0)]
+--------------------+
--Query--
SELECT count() FROM A ASOF LEFT JOIN B ON A.a == B.b AND B.t <= A.t
--Result--
[(9,)]
+--------------------+
--Query--
SELECT A.a, A.t, B.b, B.t FROM A ASOF INNER JOIN B ON B.t <= A.t AND A.a == B.b ORDER BY (A.a, A.t)
--Result--
[(1, 2, 1, 2), (1, 3, 1, 2), (2, 3, 2, 3)]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT A.a, A.t, B.b, B.t FROM A ASOF JOIN B ON A.a == B.b AND A.t <= B.t ORDER BY (A.a, A.t)
--Result--
[(1, 1, 1, 2), (1, 2, 1, 2), (1, 3, 1, 4), (2, 1, 2, 3), (2, 2, 2, 3), (2, 3, 2, 3)]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT A.a, A.t, B.b, B.t FROM A ASOF JOIN B ON A.a == B.b AND B.t >= A.t ORDER BY (A.a, A.t)
--Result--
[(1, 1, 1, 2), (1, 2, 1, 2), (1, 3, 1, 4), (2, 1, 2, 3), (2, 2, 2, 3), (2, 3, 2, 3)]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT A.a, A.t, B.b, B.t FROM A ASOF JOIN B ON A.a == B.b AND A.t > B.t ORDER BY (A.a, A.t)
--Result--
[(1, 3, 1, 2)]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT A.a, A.t, B.b, B.t FROM A ASOF JOIN B ON A.a == B.b AND A.t < B.t ORDER BY (A.a, A.t)
--Result--
[(1, 1, 1, 2), (1, 2, 1, 4), (1, 3, 1, 4), (2, 1, 2, 3), (2, 2, 2, 3)]
+--------------------+
--Query--
SELECT A.a, A.t, B.b, B.t FROM A ASOF INNER JOIN (SELECT * FROM B UNION ALL SELECT 1, 3) AS B ON B.t <= A.t AND A.a == B.b WHERE B.t != 3 ORDER BY (A.a, A.t)
--Result--
[(1, 2, 1, 2)]
+--------------------+
