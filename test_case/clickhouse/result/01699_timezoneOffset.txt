--Query--
SELECT 'DST boundary test for Europe/Moscow:'
--Result--
[('DST boundary test for Europe/Moscow:',)]
+--------------------+
--Query--
SELECT number,(toDateTime('1981-04-01 22:40:00', 'Europe/Moscow') + INTERVAL number * 600 SECOND) AS k, timezoneOffset(k) AS t, toUnixTimestamp(k) as s FROM numbers(4)
--Result--
[(0, datetime.datetime(1981, 4, 1, 22, 40, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 14400, 354998400), (1, datetime.datetime(1981, 4, 1, 22, 50, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 14400, 354999000), (2, datetime.datetime(1981, 4, 1, 23, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 14400, 354999600), (3, datetime.datetime(1981, 4, 1, 23, 10, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 14400, 355000200)]
+--------------------+
--Query--
SELECT 'DST boundary test for Asia/Tehran:'
--Result--
[('DST boundary test for Asia/Tehran:',)]
+--------------------+
--Query--
SELECT 'DST boundary test for Australia/Lord_Howe. This is a special timezone with DST offset is 30mins with the timezone epoc also lays at half hour'
--Result--
[('DST boundary test for Australia/Lord_Howe. This is a special timezone with DST offset is 30mins with the timezone epoc also lays at half hour',)]
+--------------------+
--Query--
SELECT timezoneOffset(toDateTime('2018-08-21 22:20:00', 'Australia/Lord_Howe'))
--Result--
[(37800,)]
+--------------------+
--Query--
SELECT 'DST boundary test for Australia/Lord_Howe:'
--Result--
[('DST boundary test for Australia/Lord_Howe:',)]
+--------------------+
--Query--
SELECT '4 days test in batch comparing with manually computation result for Europe/Moscow:'
--Result--
[('4 days test in batch comparing with manually computation result for Europe/Moscow:',)]
+--------------------+
--Query--
SELECT '4 days test in batch comparing with manually computation result for Asia/Tehran:'
--Result--
[('4 days test in batch comparing with manually computation result for Asia/Tehran:',)]
+--------------------+
--Query--
SELECT '4 days test in batch comparing with manually computation result for Australia/Lord_Howe'
--Result--
[('4 days test in batch comparing with manually computation result for Australia/Lord_Howe',)]
+--------------------+
--Query--
SELECT 'Moscow DST Years:'
--Result--
[('Moscow DST Years:',)]
+--------------------+
--Query--
SELECT 'Moscow DST Years with perment DST from 2011-2014:'
--Result--
[('Moscow DST Years with perment DST from 2011-2014:',)]
+--------------------+
--Query--
SELECT min((toDateTime('2011-01-01 00:00:00', 'Europe/Moscow') + INTERVAL number DAY) as day) as start, max(day) as end, count(1), concat(toString(toYear(day)),'_',toString(timezoneOffset(day)))as DST from numbers(365*4+1) group by DST order by start
--Result--
[(datetime.datetime(2011, 1, 1, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2011, 3, 27, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 86, '2011_10800'), (datetime.datetime(2011, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), datetime.datetime(2011, 12, 31, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), 279, '2011_14400'), (datetime.datetime(2012, 1, 1, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), datetime.datetime(2012, 12, 31, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), 366, '2012_14400'), (datetime.datetime(2013, 1, 1, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), datetime.datetime(2013, 12, 31, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), 365, '2013_14400'), (datetime.datetime(2014, 1, 1, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), datetime.datetime(2014, 10, 26, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>), 299, '2014_14400'), (datetime.datetime(2014, 10, 27, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2014, 12, 31, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 66, '2014_10800')]
+--------------------+
--Query--
SELECT 'Tehran DST Years:'
--Result--
[('Tehran DST Years:',)]
+--------------------+
--Query--
SELECT 'Shanghai DST Years:'
--Result--
[('Shanghai DST Years:',)]
+--------------------+
