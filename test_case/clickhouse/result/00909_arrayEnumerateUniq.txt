--Query--
SELECT arrayEnumerateUniq(         [1,1,2,2,1,1],    [1,2,1,2,2,2])
--Result--
[([1, 1, 1, 1, 2, 3],)]
+--------------------+
--Query--
SELECT arrayEnumerateUniqRanked(1, [1,1,2,2,1,1], 1, [1,2,1,2,2,2],1)
--Result--
[([1, 1, 1, 1, 2, 3],)]
+--------------------+
--Query--
SELECT 'same as arrayEnumerateUniq:'
--Result--
[('same as arrayEnumerateUniq:',)]
+--------------------+
--Query--
SELECT '[1,1,2] ='
--Result--
[('[1,1,2] =',)]
+--------------------+
--Query--
SELECT '[1,1,1] ='
--Result--
[('[1,1,1] =',)]
+--------------------+
--Query--
SELECT '[1,1,1] ='
--Result--
[('[1,1,1] =',)]
+--------------------+
--Query--
SELECT '[1,1,1] ='
--Result--
[('[1,1,1] =',)]
+--------------------+
--Query--
SELECT '[1,2,1] ='
--Result--
[('[1,2,1] =',)]
+--------------------+
--Query--
SELECT '[1,2,1] ='
--Result--
[('[1,2,1] =',)]
+--------------------+
--Query--
select '1,..,2'
--Result--
[('1,..,2',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[2,3,2],[2]] ='
--Result--
[('[[1,1,1],[2,3,2],[2]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,2],[3,2,4],[1]] ='
--Result--
[('[[1,1,2],[3,2,4],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,2,3],[4,5,6],[1]] ='
--Result--
[('[[1,2,3],[4,5,6],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,2,2],[1]] ='
--Result--
[('[[1,1,1],[1,2,2],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[2,3,2],[1]] ='
--Result--
[('[[1,1,1],[2,3,2],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,2,1],[2]] ='
--Result--
[('[[1,1,1],[1,2,1],[2]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,2,1],[1]] ='
--Result--
[('[[1,1,1],[1,2,1],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,2],[1,1,2],[1]] ='
--Result--
[('[[1,1,2],[1,1,2],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,2],[1,1,2],[1]] ='
--Result--
[('[[1,1,2],[1,1,2],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,2,3],[1,2,3],[1]] ='
--Result--
[('[[1,2,3],[1,2,3],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,2,1],[1]] ='
--Result--
[('[[1,1,1],[1,2,1],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,1,1],[1]] ='
--Result--
[('[[1,1,1],[1,1,1],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,2],[1,1,2],[1]] ='
--Result--
[('[[1,1,2],[1,1,2],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[2,3,2],[1]] ='
--Result--
[('[[1,1,1],[2,3,2],[1]] =',)]
+--------------------+
--Query--
select '2,..,2'
--Result--
[('2,..,2',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,2,1],[1]] ='
--Result--
[('[[1,1,1],[1,2,1],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,2],[1,1,2],[1]] ='
--Result--
[('[[1,1,2],[1,1,2],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,1,1],[1]] ='
--Result--
[('[[1,1,1],[1,1,1],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,2,1],[1]] ='
--Result--
[('[[1,1,1],[1,2,1],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,1],[1,2,1],[1]] ='
--Result--
[('[[1,1,1],[1,2,1],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,1,2],[1,1,2],[1]] ='
--Result--
[('[[1,1,2],[1,1,2],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,2,3],[1,2,3],[1]] ='
--Result--
[('[[1,2,3],[1,2,3],[1]] =',)]
+--------------------+
--Query--
SELECT '[[1,2,3],[1,2,3],[1]] ='
--Result--
[('[[1,2,3],[1,2,3],[1]] =',)]
+--------------------+
--Query--
select 'more:'
--Result--
[('more:',)]
+--------------------+
--Query--
select '---------Dense'
--Result--
[('---------Dense',)]
+--------------------+
--Query--
SELECT arrayEnumerateDenseRanked(1, [10,20,10,30], 1)
--Result--
[([1, 2, 1, 3],)]
+--------------------+
--Query--
SELECT arrayEnumerateDense([10,20,10,30])
--Result--
[([1, 2, 1, 3],)]
+--------------------+
--Query--
select '---------table'
--Result--
[('---------table',)]
+--------------------+
--Query--
SELECT * FROM arrays_test ORDER BY a1, a2
--Result--
[([1, 1, 1], [1, 1, 1], [[1, 1, 1], [1, 1, 1], [1]], [[1, 1, 1], [1, 1, 1], [1]]), ([1, 2, 3], [2, 2, 1], [[1, 2, 3, 4], [2, 2, 1], [3]], [[1, 2, 4, 4], [2, 2, 1], [3]]), ([1, 2, 3], [4, 5, 6], [[7, 8, 9], [10, 11, 12], [13]], [[14, 15, 16], [17, 18, 19], [20]]), ([21, 22, 24], [22, 22, 21], [[21, 22, 23, 24], [22, 22, 21], [23]], [[21, 22, 25, 24], [22, 22, 21], [23]]), ([31, 32, 33], [32, 32, 31], [[31, 32, 33, 34], [32, 32, 31], [33]], [[31, 32, 34, 34], [32, 32, 31], [33]]), ([41, 42, 43], [42, 42, 41], [[41, 42, 43, 44], [42, 42, 41], [43]], [[41, 42, 44, 44], [42, 42, 41], [43]])]
+--------------------+
--Query--
select '---------GO1'
--Result--
[('---------GO1',)]
+--------------------+
--Query--
SELECT 'arrayEnumerateUniqRanked(1,a1,1,a2,1) ='
--Result--
[('arrayEnumerateUniqRanked(1,a1,1,a2,1) =',)]
+--------------------+
--Query--
select 'arrayEnumerateUniq(a1, a2) ='
--Result--
[('arrayEnumerateUniq(a1, a2) =',)]
+--------------------+
--Query--
select '---------GO2'
--Result--
[('---------GO2',)]
+--------------------+
--Query--
select '---------END'
--Result--
[('---------END',)]
+--------------------+
--Query--
TRUNCATE TABLE arrays_test
--Result--
[]
+--------------------+
--Query--
select '---------BAD'
--Result--
[('---------BAD',)]
+--------------------+
--Query--
select '-- no order'
--Result--
[('-- no order',)]
+--------------------+
--Query--
SELECT * FROM (SELECT a, arrayEnumerateUniqRanked(a) FROM ( SELECT * FROM ( SELECT [[], [1, 2, 3, 4]] AS a UNION ALL SELECT [[3, 4, 5]] AS a ) ) ) ORDER BY a ASC
--Result--
[([[], [1, 2, 3, 4]], [[], [1, 1, 1, 1]]), ([[3, 4, 5]], [[1, 1, 1]])]
+--------------------+
--Query--
select '-- order no arr'
--Result--
[('-- order no arr',)]
+--------------------+
--Query--
select '-- order two arr'
--Result--
[('-- order two arr',)]
+--------------------+
--Query--
select '-- order non empt'
--Result--
[('-- order non empt',)]
+--------------------+
--Query--
select '-- order'
--Result--
[('-- order',)]
+--------------------+
--Query--
select '-- '
--Result--
[('-- ',)]
+--------------------+
--Query--
select '-- '
--Result--
[('-- ',)]
+--------------------+
--Query--
select '-- '
--Result--
[('-- ',)]
+--------------------+
--Query--
select '-- '
--Result--
[('-- ',)]
+--------------------+
--Query--
select '-- '
--Result--
[('-- ',)]
+--------------------+
--Query--
select '-- '
--Result--
[('-- ',)]
+--------------------+
--Query--
select '-- '
--Result--
[('-- ',)]
+--------------------+
--Query--
TRUNCATE TABLE arrays_test
--Result--
[]
+--------------------+
--Query--
TRUNCATE TABLE arrays_test
--Result--
[]
+--------------------+
--Query--
TRUNCATE TABLE arrays_test
--Result--
[]
+--------------------+
--Query--
truncate table arr_tests_visits
--Result--
[]
+--------------------+
--Query--
select CounterID, StartDate, Sign, VisitID, UserID, VisitVersion, BannerID, Load, PuidKeyArr, PuidValArr, arrayEnumerateUniqRanked(PuidKeyArr, PuidValArr) as uniqTestPuid     from arr_tests_visits     array join          Test.BannerID as BannerID,          Test.Load as Load,          Test.PuidKey as PuidKeyArr,          Test.PuidVal as PuidValArr
--Result--
[(1, datetime.date(2019, 6, 6), 1, 1, 1, 1, 1, 1, [], [], []), (1, datetime.date(2019, 6, 6), -1, 1, 1, 1, 1, 1, [], [], []), (1, datetime.date(2019, 6, 6), 1, 1, 1, 2, 1, 1, [], [], []), (1, datetime.date(2019, 6, 6), 1, 1, 1, 2, 2, 1, [1, 2, 3, 4], [1001, 1002, 1003, 1004], [1, 1, 1, 1]), (1, datetime.date(2019, 6, 6), 1, 2, 1, 1, 3, 1, [3, 4, 5], [2001, 2002, 2003], [1, 1, 1]), (1, datetime.date(2019, 6, 6), 1, 3, 2, 1, 4, 1, [5, 6], [3001, 3002], [1, 1]), (1, datetime.date(2019, 6, 6), 1, 3, 2, 1, 5, 0, [], [], []), (1, datetime.date(2019, 6, 6), 1, 4, 2, 1, 5, 1, [1, 2], [1001, 1002], [1, 1]), (1, datetime.date(2019, 6, 6), 1, 4, 2, 1, 5, 0, [1, 2], [1002, 1003], [1, 1]), (1, datetime.date(2019, 6, 6), 1, 4, 2, 1, 6, 0, [3], [2001], [1])]
+--------------------+
--Query--
select '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT     CounterID,     StartDate,     Sign,     VisitID,     UserID,     VisitVersion,     BannerID,     Load,     PuidKeyArr,     PuidValArr,     arrayEnumerateUniqRanked(PuidKeyArr, PuidValArr) AS uniqTestPuid FROM arr_tests_visits ARRAY JOIN     Test.BannerID AS BannerID,     Test.Load AS Load,     Test.PuidKey AS PuidKeyArr,     Test.PuidVal AS PuidValArr
--Result--
[(1, datetime.date(2019, 6, 6), 1, 1, 1, 1, 1, 1, [], [], []), (1, datetime.date(2019, 6, 6), -1, 1, 1, 1, 1, 1, [], [], []), (1, datetime.date(2019, 6, 6), 1, 1, 1, 2, 1, 1, [], [], []), (1, datetime.date(2019, 6, 6), 1, 1, 1, 2, 2, 1, [1, 2, 3, 4], [1001, 1002, 1003, 1004], [1, 1, 1, 1]), (1, datetime.date(2019, 6, 6), 1, 2, 1, 1, 3, 1, [3, 4, 5], [2001, 2002, 2003], [1, 1, 1]), (1, datetime.date(2019, 6, 6), 1, 3, 2, 1, 4, 1, [5, 6], [3001, 3002], [1, 1]), (1, datetime.date(2019, 6, 6), 1, 3, 2, 1, 5, 0, [], [], []), (1, datetime.date(2019, 6, 6), 1, 4, 2, 1, 5, 1, [1, 2], [1001, 1002], [1, 1]), (1, datetime.date(2019, 6, 6), 1, 4, 2, 1, 5, 0, [1, 2], [1002, 1003], [1, 1]), (1, datetime.date(2019, 6, 6), 1, 4, 2, 1, 6, 0, [3], [2001], [1])]
+--------------------+
--Query--
select '-- empty'
--Result--
[('-- empty',)]
+--------------------+
--Query--
select '-- empty corner'
--Result--
[('-- empty corner',)]
+--------------------+
