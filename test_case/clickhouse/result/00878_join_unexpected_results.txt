--Query--
select 'join_use_nulls = 1'
--Result--
[('join_use_nulls = 1',)]
+--------------------+
--Query--
select * from t left outer join s using (a,b) order by t.a
--Result--
[(1, 1), (2, 2)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select * from t join s using (a,b)
--Result--
[(1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select * from t join s on (t.a=s.a and t.b=s.b)
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.* from t left join s on (t.a=s.a and t.b=s.b) order by t.a
--Result--
[(1, 1), (2, 2)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (t.a=s.a and t.b=s.b) order by t.a
--Result--
[(1, 1, 1, 1), (2, 2, None, None)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b) order by t.a
--Result--
[(1, 1, 1, 1), (2, 2, None, None)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t right join s on (t.a=s.a and t.b=s.b)
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select * from t left outer join s using (a,b) where s.a is null
--Result--
[(2, 2)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select * from t left outer join s on (t.a=s.a and t.b=s.b) where s.a is null
--Result--
[(2, 2, None, None)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select s.* from t left outer join s on (t.a=s.a and t.b=s.b) where s.a is null
--Result--
[(None, None)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b and t.a=toInt64(2)) order by t.a
--Result--
[(1, 1, None, None), (2, 2, None, None)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (s.a=t.a) order by t.a
--Result--
[(1, 1, 1, 1), (2, 2, None, None)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (t.b=toInt64(1) and s.a=t.a) where s.b=1
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (t.b=toInt64(2) and s.a=t.a) where t.b=2
--Result--
[(2, 2, None, None)]
+--------------------+
--Query--
select 'join_use_nulls = 0'
--Result--
[('join_use_nulls = 0',)]
+--------------------+
--Query--
select * from t left outer join s using (a,b) order by t.a
--Result--
[(1, 1), (2, 2)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select * from t join s using (a,b)
--Result--
[(1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select * from t join s on (t.a=s.a and t.b=s.b)
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.* from t left join s on (t.a=s.a and t.b=s.b) order by t.a
--Result--
[(1, 1), (2, 2)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (t.a=s.a and t.b=s.b) order by t.a
--Result--
[(1, 1, 1, 1), (2, 2, 0, 0)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b) order by t.a
--Result--
[(1, 1, 1, 1), (2, 2, 0, 0)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t right join s on (t.a=s.a and t.b=s.b)
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b and t.a=toInt64(2)) order by t.a
--Result--
[(1, 1, 0, 0), (2, 2, 0, 0)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (s.a=t.a) order by t.a
--Result--
[(1, 1, 1, 1), (2, 2, 0, 0)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (t.b=toInt64(1) and s.a=t.a) where s.b=1
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
select '-'
--Result--
[('-',)]
+--------------------+
--Query--
select t.*, s.* from t left join s on (t.b=toInt64(2) and s.a=t.a) where t.b=2
--Result--
[(2, 2, 0, 0)]
+--------------------+
