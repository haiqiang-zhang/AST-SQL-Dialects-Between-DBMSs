--Query--
SELECT toWeek(toDate('1998-01-01')), toWeek(toDate('1997-01-01')), toWeek(toDate('1998-01-01'), 1),  toWeek(toDate('1997-01-01'), 1)
--Result--
[(0, 0, 1, 1)]
+--------------------+
--Query--
SELECT toYearWeek(toDate('1981-12-31'), 1), toYearWeek(toDate('1982-01-01'), 1), toYearWeek(toDate('1982-12-31'), 1), toYearWeek(toDate('1983-01-01'), 1)
--Result--
[(198153, 198153, 198252, 198252)]
+--------------------+
--Query--
SELECT toWeek(toDate('2000-01-01'),0) AS w2000, toWeek(toDate('2001-01-01'),0) AS w2001, toWeek(toDate('2002-01-01'),0) AS w2002,toWeek(toDate('2003-01-01'),0) AS w2003, toWeek(toDate('2004-01-01'),0) AS w2004, toWeek(toDate('2005-01-01'),0) AS w2005, toWeek(toDate('2006-01-01'),0) AS w2006
--Result--
[(0, 0, 0, 0, 0, 0, 1)]
+--------------------+
--Query--
SELECT toWeek(toDate('2000-01-06'),0) AS w2000, toWeek(toDate('2001-01-06'),0) AS w2001, toWeek(toDate('2002-01-06'),0) AS w2002,toWeek(toDate('2003-01-06'),0) AS w2003, toWeek(toDate('2004-01-06'),0) AS w2004, toWeek(toDate('2005-01-06'),0) AS w2005, toWeek(toDate('2006-01-06'),0) AS w2006
--Result--
[(1, 0, 1, 1, 1, 1, 1)]
+--------------------+
--Query--
SELECT toWeek(toDate('2000-01-01'),1) AS w2000, toWeek(toDate('2001-01-01'),1) AS w2001, toWeek(toDate('2002-01-01'),1) AS w2002,toWeek(toDate('2003-01-01'),1) AS w2003, toWeek(toDate('2004-01-01'),1) AS w2004, toWeek(toDate('2005-01-01'),1) AS w2005, toWeek(toDate('2006-01-01'),1) AS w2006
--Result--
[(0, 1, 1, 1, 1, 0, 0)]
+--------------------+
--Query--
SELECT toWeek(toDate('2000-01-06'),1) AS w2000, toWeek(toDate('2001-01-06'),1) AS w2001, toWeek(toDate('2002-01-06'),1) AS w2002,toWeek(toDate('2003-01-06'),1) AS w2003, toWeek(toDate('2004-01-06'),1) AS w2004, toWeek(toDate('2005-01-06'),1) AS w2005, toWeek(toDate('2006-01-06'),1) AS w2006
--Result--
[(1, 1, 1, 2, 2, 1, 1)]
+--------------------+
--Query--
SELECT toYearWeek(toDate('2000-01-01'),0) AS w2000, toYearWeek(toDate('2001-01-01'),0) AS w2001, toYearWeek(toDate('2002-01-01'),0) AS w2002,toYearWeek(toDate('2003-01-01'),0) AS w2003, toYearWeek(toDate('2004-01-01'),0) AS w2004, toYearWeek(toDate('2005-01-01'),0) AS w2005, toYearWeek(toDate('2006-01-01'),0) AS w2006
--Result--
[(199952, 200053, 200152, 200252, 200352, 200452, 200601)]
+--------------------+
--Query--
SELECT toYearWeek(toDate('2000-01-06'),0) AS w2000, toYearWeek(toDate('2001-01-06'),0) AS w2001, toYearWeek(toDate('2002-01-06'),0) AS w2002,toYearWeek(toDate('2003-01-06'),0) AS w2003, toYearWeek(toDate('2004-01-06'),0) AS w2004, toYearWeek(toDate('2005-01-06'),0) AS w2005, toYearWeek(toDate('2006-01-06'),0) AS w2006
--Result--
[(200001, 200053, 200201, 200301, 200401, 200501, 200601)]
+--------------------+
--Query--
SELECT toYearWeek(toDate('2000-01-01'),1) AS w2000, toYearWeek(toDate('2001-01-01'),1) AS w2001, toYearWeek(toDate('2002-01-01'),1) AS w2002,toYearWeek(toDate('2003-01-01'),1) AS w2003, toYearWeek(toDate('2004-01-01'),1) AS w2004, toYearWeek(toDate('2005-01-01'),1) AS w2005, toYearWeek(toDate('2006-01-01'),1) AS w2006
--Result--
[(199952, 200101, 200201, 200301, 200401, 200453, 200552)]
+--------------------+
--Query--
SELECT toYearWeek(toDate('2000-01-06'),1) AS w2000, toYearWeek(toDate('2001-01-06'),1) AS w2001, toYearWeek(toDate('2002-01-06'),1) AS w2002,toYearWeek(toDate('2003-01-06'),1) AS w2003, toYearWeek(toDate('2004-01-06'),1) AS w2004, toYearWeek(toDate('2005-01-06'),1) AS w2005, toYearWeek(toDate('2006-01-06'),1) AS w2006
--Result--
[(200001, 200101, 200201, 200302, 200402, 200501, 200601)]
+--------------------+
--Query--
SELECT toWeek(toDate('1998-12-31'),0) AS w0, toWeek(toDate('1998-12-31'),1) AS w1, toWeek(toDate('1998-12-31'),2) AS w2, toWeek(toDate('1998-12-31'),3) AS w3, toWeek(toDate('1998-12-31'),4) AS w4, toWeek(toDate('1998-12-31'),5) AS w5, toWeek(toDate('1998-12-31'),6) AS w6, toWeek(toDate('1998-12-31'),7) AS w7
--Result--
[(52, 53, 52, 53, 52, 52, 52, 52)]
+--------------------+
--Query--
SELECT toWeek(toDate('2000-01-01'),0) AS w0, toWeek(toDate('2000-01-01'),1) AS w1, toWeek(toDate('2000-01-01'),2) AS w2, toWeek(toDate('2000-01-01'),3) AS w3, toWeek(toDate('2000-01-01'),4) AS w4, toWeek(toDate('2000-01-01'),5) AS w5, toWeek(toDate('2000-01-01'),6) AS w6, toWeek(toDate('2000-01-01'),7) AS w7
--Result--
[(0, 0, 52, 52, 0, 0, 52, 52)]
+--------------------+
--Query--
SELECT toWeek(toDate('2000-01-06'),0) AS w0, toWeek(toDate('2000-01-06'),1) AS w1, toWeek(toDate('2000-01-06'),2) AS w2, toWeek(toDate('2000-01-06'),3) AS w3, toWeek(toDate('2000-01-06'),4) AS w4, toWeek(toDate('2000-01-06'),5) AS w5, toWeek(toDate('2000-01-06'),6) AS w6, toWeek(toDate('2000-01-06'),7) AS w7
--Result--
[(1, 1, 1, 1, 1, 1, 1, 1)]
+--------------------+
--Query--
SELECT toWeek(toDate('2000-12-31'),0) AS w0, toWeek(toDate('2000-12-31'),1) AS w1, toWeek(toDate('2000-12-31'),2) AS w2, toWeek(toDate('2000-12-31'),3) AS w3, toWeek(toDate('2000-12-31'),4) AS w4, toWeek(toDate('2000-12-31'),5) AS w5, toWeek(toDate('2000-12-31'),6) AS w6, toWeek(toDate('2000-12-31'),7) AS w7
--Result--
[(53, 52, 53, 52, 53, 52, 1, 52)]
+--------------------+
--Query--
SELECT toWeek(toDate('2001-01-01'),0) AS w0, toWeek(toDate('2001-01-01'),1) AS w1, toWeek(toDate('2001-01-01'),2) AS w2, toWeek(toDate('2001-01-01'),3) AS w3, toWeek(toDate('2001-01-01'),4) AS w4, toWeek(toDate('2001-01-01'),5) AS w5, toWeek(toDate('2001-01-01'),6) AS w6, toWeek(toDate('2001-01-01'),7) AS w7
--Result--
[(0, 1, 53, 1, 1, 1, 1, 1)]
+--------------------+
--Query--
SELECT     toDate('2016-12-21') + number AS d,  	  toWeek(d, 8) AS week8,     toWeek(d, 9) AS week9,      toYearWeek(d, 8) AS yearWeek8,     toYearWeek(d, 9) AS yearWeek9 FROM numbers(21)
--Result--
[(datetime.date(2016, 12, 21), 52, 52, 201652, 201652), (datetime.date(2016, 12, 22), 52, 52, 201652, 201652), (datetime.date(2016, 12, 23), 52, 52, 201652, 201652), (datetime.date(2016, 12, 24), 52, 52, 201652, 201652), (datetime.date(2016, 12, 25), 53, 52, 201653, 201652), (datetime.date(2016, 12, 26), 53, 1, 201653, 201701), (datetime.date(2016, 12, 27), 53, 1, 201653, 201701), (datetime.date(2016, 12, 28), 53, 1, 201653, 201701), (datetime.date(2016, 12, 29), 53, 1, 201653, 201701), (datetime.date(2016, 12, 30), 53, 1, 201653, 201701), (datetime.date(2016, 12, 31), 53, 1, 201653, 201701), (datetime.date(2017, 1, 1), 1, 1, 201701, 201701), (datetime.date(2017, 1, 2), 1, 2, 201701, 201702), (datetime.date(2017, 1, 3), 1, 2, 201701, 201702), (datetime.date(2017, 1, 4), 1, 2, 201701, 201702), (datetime.date(2017, 1, 5), 1, 2, 201701, 201702), (datetime.date(2017, 1, 6), 1, 2, 201701, 201702), (datetime.date(2017, 1, 7), 1, 2, 201701, 201702), (datetime.date(2017, 1, 8), 2, 2, 201702, 201702), (datetime.date(2017, 1, 9), 2, 3, 201702, 201703), (datetime.date(2017, 1, 10), 2, 3, 201702, 201703)]
+--------------------+
--Query--
SELECT toDateTime(toDate('2016-12-22') + number, 'Asia/Istanbul' ) AS d,      toWeek(d, 8, 'Asia/Istanbul') AS week8,      toWeek(d, 9, 'Asia/Istanbul') AS week9,      toYearWeek(d, 8, 'Asia/Istanbul') AS yearWeek8,     toYearWeek(d, 9, 'Asia/Istanbul') AS yearWeek9 FROM numbers(21)
--Result--
[(datetime.datetime(2016, 12, 22, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 52, 52, 201652, 201652), (datetime.datetime(2016, 12, 23, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 52, 52, 201652, 201652), (datetime.datetime(2016, 12, 24, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 52, 52, 201652, 201652), (datetime.datetime(2016, 12, 25, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 53, 52, 201653, 201652), (datetime.datetime(2016, 12, 26, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 53, 1, 201653, 201701), (datetime.datetime(2016, 12, 27, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 53, 1, 201653, 201701), (datetime.datetime(2016, 12, 28, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 53, 1, 201653, 201701), (datetime.datetime(2016, 12, 29, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 53, 1, 201653, 201701), (datetime.datetime(2016, 12, 30, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 53, 1, 201653, 201701), (datetime.datetime(2016, 12, 31, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 53, 1, 201653, 201701), (datetime.datetime(2017, 1, 1, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 1, 1, 201701, 201701), (datetime.datetime(2017, 1, 2, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 1, 2, 201701, 201702), (datetime.datetime(2017, 1, 3, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 1, 2, 201701, 201702), (datetime.datetime(2017, 1, 4, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 1, 2, 201701, 201702), (datetime.datetime(2017, 1, 5, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 1, 2, 201701, 201702), (datetime.datetime(2017, 1, 6, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 1, 2, 201701, 201702), (datetime.datetime(2017, 1, 7, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 1, 2, 201701, 201702), (datetime.datetime(2017, 1, 8, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 2, 2, 201702, 201702), (datetime.datetime(2017, 1, 9, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 2, 3, 201702, 201703), (datetime.datetime(2017, 1, 10, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 2, 3, 201702, 201703), (datetime.datetime(2017, 1, 11, 0, 0, tzinfo=<DstTzInfo 'Asia/Istanbul' +03+3:00:00 STD>), 2, 3, 201702, 201703)]
+--------------------+
--Query--
WITH     toDate('2018-12-25') + number AS d,     toDate32(d) AS d32,     toDateTime(d) AS dt,     toDateTime64(d, 0) AS dt64 SELECT     dt64,     toStartOfWeek(d) AS wd_sun,     toStartOfWeek(d32) AS wd32_sun,     toStartOfWeek(dt) AS wdt_sun,     toStartOfWeek(dt64) AS wdt64_sun,     toStartOfWeek(d, 1) AS wd_mon,     toStartOfWeek(d32, 1) AS wd32_mon,     toStartOfWeek(dt, 1) AS wdt_mon,     toStartOfWeek(dt64, 1) AS wdt64_mon FROM numbers(10)
--Result--
[(datetime.datetime(2018, 12, 25, 0, 0), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24)), (datetime.datetime(2018, 12, 26, 0, 0), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24)), (datetime.datetime(2018, 12, 27, 0, 0), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24)), (datetime.datetime(2018, 12, 28, 0, 0), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24)), (datetime.datetime(2018, 12, 29, 0, 0), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 23), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24)), (datetime.datetime(2018, 12, 30, 0, 0), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24), datetime.date(2018, 12, 24)), (datetime.datetime(2018, 12, 31, 0, 0), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31)), (datetime.datetime(2019, 1, 1, 0, 0), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31)), (datetime.datetime(2019, 1, 2, 0, 0), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31)), (datetime.datetime(2019, 1, 3, 0, 0), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 30), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31), datetime.date(2018, 12, 31))]
+--------------------+
