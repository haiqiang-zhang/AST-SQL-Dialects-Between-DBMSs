--Query--
SELECT count() == 2 FROM null_in WHERE i in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE s in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i global in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i global in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE s global in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i not in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i not in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE s not in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i global not in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i global not in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE s global not in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 4 FROM null_in WHERE i in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 4 FROM null_in WHERE s in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 4 FROM null_in WHERE i global in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i global in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 4 FROM null_in WHERE s global in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i not in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i not in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE s not in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i global not in (1, 3, NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i global not in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE s global not in ('1', '3', NULL)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i not in (1, 3)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i not in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE s not in ('1', '3')
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i global not in (1, 3)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i global not in range(4)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE s global not in ('1', '3')
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i not in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i global in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i global not in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i not in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i global in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i global not in test_set
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i not in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 1 FROM null_in WHERE i global in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i global not in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i not in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 3 FROM null_in WHERE i global in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 2 FROM null_in WHERE i global not in test_set2
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33333 FROM null_in_subquery WHERE i in (SELECT i FROM null_in_subquery WHERE dt = 0)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66666 FROM null_in_subquery WHERE i not in (SELECT i FROM null_in_subquery WHERE dt = 1)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33333 FROM null_in_subquery WHERE i global in (SELECT i FROM null_in_subquery WHERE dt = 2)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66666 FROM null_in_subquery WHERE i global not in (SELECT i FROM null_in_subquery WHERE dt = 0)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33333 FROM null_in_subquery WHERE idx in (SELECT idx FROM null_in_subquery WHERE dt = 0)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66666 FROM null_in_subquery WHERE idx not in (SELECT idx FROM null_in_subquery WHERE dt = 1)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33333 FROM null_in_subquery WHERE idx global in (SELECT idx FROM null_in_subquery WHERE dt = 2)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66666 FROM null_in_subquery WHERE idx global not in (SELECT idx FROM null_in_subquery WHERE dt = 0)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33335 FROM null_in_subquery WHERE i in (SELECT i FROM null_in_subquery WHERE dt = 0)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66666 FROM null_in_subquery WHERE i not in (SELECT i FROM null_in_subquery WHERE dt = 1)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33333 FROM null_in_subquery WHERE i in (SELECT i FROM null_in_subquery WHERE dt = 2)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66668 FROM null_in_subquery WHERE i not in (SELECT i FROM null_in_subquery WHERE dt = 2)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33335 FROM null_in_subquery WHERE i global in (SELECT i FROM null_in_subquery WHERE dt = 0)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66666 FROM null_in_subquery WHERE i global not in (SELECT i FROM null_in_subquery WHERE dt = 1)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 33333 FROM null_in_subquery WHERE i global in (SELECT i FROM null_in_subquery WHERE dt = 2)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count() == 66668 FROM null_in_subquery WHERE i global not in (SELECT i FROM null_in_subquery WHERE dt = 2)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1')] FROM null_in_tuple WHERE t in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(2, NULL), (NULL, '3'), (NULL, NULL)] FROM null_in_tuple WHERE t not in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1')] FROM null_in_tuple WHERE t global in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(2, NULL), (NULL, '3'), (NULL, NULL)] FROM null_in_tuple WHERE t global not in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1'), (NULL, NULL)] FROM null_in_tuple WHERE t in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(2, NULL), (NULL, '3')] FROM null_in_tuple WHERE t not in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1'), (NULL, NULL)] FROM null_in_tuple WHERE t global in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(2, NULL), (NULL, '3')] FROM null_in_tuple WHERE t global not in ((1, '1'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1')] FROM null_in_tuple WHERE t in ((1, '1'), (1, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1')] FROM null_in_tuple WHERE t in ((1, '1'), (NULL, '1'))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1'), (2, NULL)] FROM null_in_tuple WHERE t in ((1, '1'), (NULL, '1'), (2, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1'), (NULL, '3')] FROM null_in_tuple WHERE t in ((1, '1'), (1, NULL), (NULL, '3'))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(1, '1'), (2, NULL), (NULL, '3'), (NULL, NULL)] FROM null_in_tuple WHERE t in ((1, '1'), (1, NULL), (2, NULL), (NULL, '3'), (NULL, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(2, NULL), (NULL, '3'), (NULL, NULL)] FROM null_in_tuple WHERE t not in ((1, '1'), (1, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(2, NULL), (NULL, '3'), (NULL, NULL)] FROM null_in_tuple WHERE t not in ((1, '1'), (NULL, '1'))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(NULL, '3'), (NULL, NULL)] FROM null_in_tuple WHERE t not in ((1, '1'), (NULL, '1'), (2, NULL))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [(2, NULL), (NULL, NULL)] FROM null_in_tuple WHERE t not in ((1, '1'), (1, NULL), (NULL, '3'))
--Result--
[(0,)]
+--------------------+
--Query--
SELECT arraySort(x -> (x.1, x.2), groupArray(t)) == [] FROM null_in_tuple WHERE t not in ((1, '1'), (1, NULL), (2, NULL), (NULL, '3'), (NULL, NULL))
--Result--
[(1,)]
+--------------------+
