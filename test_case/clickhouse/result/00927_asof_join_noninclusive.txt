--Query--
SELECT A.k, toString(A.t, 'UTC'), A.a, B.b, toString(B.t, 'UTC'), B.k FROM A ASOF LEFT JOIN B USING(k,t) ORDER BY (A.k, A.t)
--Result--
[(1, '1970-01-01 00:00:01', 1.0, 0.0, '1970-01-01 00:00:00', 0), (1, '1970-01-01 00:00:02', 2.0, 2.0, '1970-01-01 00:00:02', 1), (1, '1970-01-01 00:00:03', 3.0, 2.0, '1970-01-01 00:00:02', 1), (1, '1970-01-01 00:00:04', 4.0, 4.0, '1970-01-01 00:00:04', 1), (1, '1970-01-01 00:00:05', 5.0, 4.0, '1970-01-01 00:00:04', 1), (2, '1970-01-01 00:00:01', 1.0, 0.0, '1970-01-01 00:00:00', 0), (2, '1970-01-01 00:00:02', 2.0, 0.0, '1970-01-01 00:00:00', 0), (2, '1970-01-01 00:00:03', 3.0, 3.0, '1970-01-01 00:00:03', 2), (2, '1970-01-01 00:00:04', 4.0, 3.0, '1970-01-01 00:00:03', 2), (2, '1970-01-01 00:00:05', 5.0, 3.0, '1970-01-01 00:00:03', 2), (3, '1970-01-01 00:00:01', 1.0, 0.0, '1970-01-01 00:00:00', 0), (3, '1970-01-01 00:00:02', 2.0, 0.0, '1970-01-01 00:00:00', 0), (3, '1970-01-01 00:00:03', 3.0, 0.0, '1970-01-01 00:00:00', 0), (3, '1970-01-01 00:00:04', 4.0, 0.0, '1970-01-01 00:00:00', 0), (3, '1970-01-01 00:00:05', 5.0, 0.0, '1970-01-01 00:00:00', 0)]
+--------------------+
