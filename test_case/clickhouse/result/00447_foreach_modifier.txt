--Query--
SELECT max(sketch) FROM data
--Result--
[([4, -1, 2],)]
+--------------------+
--Query--
SELECT maxArray(sketch) FROM data
--Result--
[(25,)]
+--------------------+
--Query--
SELECT maxForEach(sketch) FROM data
--Result--
[([4, 25, 7],)]
+--------------------+
--Query--
SELECT k, sumForEach(arr) FROM (SELECT number % 3 AS k, range(number) AS arr FROM system.numbers LIMIT 10) GROUP BY k ORDER BY k
--Result--
[(0, [0, 3, 6, 6, 8, 10, 6, 7, 8]), (1, [0, 2, 4, 6, 4, 5, 6]), (2, [0, 3, 4, 6, 8, 5, 6, 7])]
+--------------------+
--Query--
SELECT k, groupArrayForEach(arr) FROM (SELECT number % 3 AS k, range(number) AS arr FROM system.numbers LIMIT 10) GROUP BY k ORDER BY k
--Result--
[(0, [[0, 0, 0], [1, 1, 1], [2, 2, 2], [3, 3], [4, 4], [5, 5], [6], [7], [8]]), (1, [[0, 0, 0], [1, 1], [2, 2], [3, 3], [4], [5], [6]]), (2, [[0, 0, 0], [1, 1, 1], [2, 2], [3, 3], [4, 4], [5], [6], [7]])]
+--------------------+
--Query--
SELECT k, groupArrayForEach(arr), quantilesExactForEach(0.5, 0.9)(arr) FROM (SELECT intDiv(number, 3) AS k, arrayMap(x -> number + x, range(number)) AS arr FROM system.numbers LIMIT 10) GROUP BY k ORDER BY k
--Result--
[(0, [[1, 2], [3]], [[2, 2], [3, 3]]), (1, [[3, 4, 5], [4, 5, 6], [5, 6, 7], [7, 8], [9]], [[4, 5], [5, 6], [6, 7], [8, 8], [9, 9]]), (2, [[6, 7, 8], [7, 8, 9], [8, 9, 10], [9, 10, 11], [10, 11, 12], [11, 12, 13], [13, 14], [15]], [[7, 8], [8, 9], [9, 10], [10, 11], [11, 12], [12, 13], [14, 14], [15, 15]]), (3, [[9], [10], [11], [12], [13], [14], [15], [16], [17]], [[9, 9], [10, 10], [11, 11], [12, 12], [13, 13], [14, 14], [15, 15], [16, 16], [17, 17]])]
+--------------------+
--Query--
SELECT uniqForEach(x) FROM (SELECT emptyArrayUInt8() AS x UNION ALL SELECT [1, 2, 3] UNION ALL SELECT emptyArrayUInt8() UNION ALL SELECT [2, 2])
--Result--
[([2, 1, 1],)]
+--------------------+
