--Query--
SELECT 'ARRAY JOIN with constant'
--Result--
[('ARRAY JOIN with constant',)]
+--------------------+
--Query--
SELECT id, value, value_1 FROM test_table ARRAY JOIN [1, 2, 3] AS value_1
--Result--
[(0, 'Value', 1), (0, 'Value', 2), (0, 'Value', 3), (0, 'Value', 1), (0, 'Value', 2), (0, 'Value', 3)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT id, value FROM test_table ARRAY JOIN [1, 2, 3] AS value
--Result--
[(0, 1), (0, 2), (0, 3), (0, 1), (0, 2), (0, 3)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
WITH [1, 2, 3] AS constant_array SELECT id, value FROM test_table ARRAY JOIN constant_array AS value
--Result--
[(0, 1), (0, 2), (0, 3), (0, 1), (0, 2), (0, 3)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
WITH [1, 2, 3] AS constant_array SELECT id, value, value_1 FROM test_table ARRAY JOIN constant_array AS value_1
--Result--
[(0, 'Value', 1), (0, 'Value', 2), (0, 'Value', 3), (0, 'Value', 1), (0, 'Value', 2), (0, 'Value', 3)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT id, value, value_1, value_2 FROM test_table ARRAY JOIN [[1, 2, 3]] AS value_1 ARRAY JOIN value_1 AS value_2
--Result--
[(0, 'Value', [1, 2, 3], 1), (0, 'Value', [1, 2, 3], 2), (0, 'Value', [1, 2, 3], 3), (0, 'Value', [1, 2, 3], 1), (0, 'Value', [1, 2, 3], 2), (0, 'Value', [1, 2, 3], 3)]
+--------------------+
--Query--
SELECT 'ARRAY JOIN with column'
--Result--
[('ARRAY JOIN with column',)]
+--------------------+
--Query--
SELECT id, value, test_table.value_array FROM test_table ARRAY JOIN value_array
--Result--
[(0, 'Value', 1), (0, 'Value', 2), (0, 'Value', 3), (0, 'Value', 4), (0, 'Value', 5), (0, 'Value', 6)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT id, value_array, value FROM test_table ARRAY JOIN value_array AS value
--Result--
[(0, [1, 2, 3], 1), (0, [1, 2, 3], 2), (0, [1, 2, 3], 3), (0, [4, 5, 6], 4), (0, [4, 5, 6], 5), (0, [4, 5, 6], 6)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT id, value, value_array, value_array_element FROM test_table ARRAY JOIN value_array AS value_array_element
--Result--
[(0, 'Value', [1, 2, 3], 1), (0, 'Value', [1, 2, 3], 2), (0, 'Value', [1, 2, 3], 3), (0, 'Value', [4, 5, 6], 4), (0, 'Value', [4, 5, 6], 5), (0, 'Value', [4, 5, 6], 6)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT id, value, value_array AS value_array_array_alias FROM test_table ARRAY JOIN value_array_array_alias
--Result--
[(0, 'Value', [1, 2, 3]), (0, 'Value', [1, 2, 3]), (0, 'Value', [1, 2, 3]), (0, 'Value', [4, 5, 6]), (0, 'Value', [4, 5, 6]), (0, 'Value', [4, 5, 6])]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT id, value, value_array AS value_array_array_alias, value_array_array_alias_element FROM test_table ARRAY JOIN value_array_array_alias AS value_array_array_alias_element
--Result--
[(0, 'Value', [1, 2, 3], 1), (0, 'Value', [1, 2, 3], 2), (0, 'Value', [1, 2, 3], 3), (0, 'Value', [4, 5, 6], 4), (0, 'Value', [4, 5, 6], 5), (0, 'Value', [4, 5, 6], 6)]
+--------------------+
--Query--
SELECT '--'
--Result--
[('--',)]
+--------------------+
--Query--
SELECT id, value, value_array_array, value_array_array_inner_element, value_array_array_inner_element, value_array_array_inner_inner_element FROM test_table ARRAY JOIN value_array_array AS value_array_array_inner_element ARRAY JOIN value_array_array_inner_element AS value_array_array_inner_inner_element
--Result--
[(0, 'Value', [[1, 2, 3]], [1, 2, 3], [1, 2, 3], 1), (0, 'Value', [[1, 2, 3]], [1, 2, 3], [1, 2, 3], 2), (0, 'Value', [[1, 2, 3]], [1, 2, 3], [1, 2, 3], 3), (0, 'Value', [[1, 2, 3], [4, 5, 6]], [1, 2, 3], [1, 2, 3], 1), (0, 'Value', [[1, 2, 3], [4, 5, 6]], [1, 2, 3], [1, 2, 3], 2), (0, 'Value', [[1, 2, 3], [4, 5, 6]], [1, 2, 3], [1, 2, 3], 3), (0, 'Value', [[1, 2, 3], [4, 5, 6]], [4, 5, 6], [4, 5, 6], 4), (0, 'Value', [[1, 2, 3], [4, 5, 6]], [4, 5, 6], [4, 5, 6], 5), (0, 'Value', [[1, 2, 3], [4, 5, 6]], [4, 5, 6], [4, 5, 6], 6)]
+--------------------+
