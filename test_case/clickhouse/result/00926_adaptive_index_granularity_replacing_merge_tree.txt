--Query--
SELECT COUNT(*) FROM zero_rows_per_granule
--Result--
[(4,)]
+--------------------+
--Query--
SELECT distinct(marks) from system.parts WHERE table = 'zero_rows_per_granule' and database=currentDatabase() and active=1
--Result--
[(5,)]
+--------------------+
--Query--
OPTIMIZE TABLE zero_rows_per_granule FINAL
--Result--
[]
+--------------------+
--Query--
SELECT sum(marks) from system.parts WHERE table = 'zero_rows_per_granule' and database=currentDatabase() and active=1
--Result--
[(9,)]
+--------------------+
--Query--
SELECT '-----'
--Result--
[('-----',)]
+--------------------+
--Query--
OPTIMIZE TABLE two_rows_per_granule FINAL
--Result--
[]
+--------------------+
--Query--
SELECT '-----'
--Result--
[('-----',)]
+--------------------+
--Query--
DETACH TABLE four_rows_per_granule
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE four_rows_per_granule
--Result--
[]
+--------------------+
--Query--
OPTIMIZE TABLE four_rows_per_granule FINAL
--Result--
[]
+--------------------+
--Query--
DETACH TABLE four_rows_per_granule
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE four_rows_per_granule
--Result--
[]
+--------------------+
--Query--
SELECT '-----'
--Result--
[('-----',)]
+--------------------+
--Query--
DETACH TABLE huge_granularity_small_blocks
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE huge_granularity_small_blocks
--Result--
[]
+--------------------+
--Query--
OPTIMIZE TABLE huge_granularity_small_blocks FINAL
--Result--
[]
+--------------------+
--Query--
SELECT '-----'
--Result--
[('-----',)]
+--------------------+
--Query--
DETACH TABLE adaptive_granularity_alter
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE adaptive_granularity_alter
--Result--
[]
+--------------------+
--Query--
OPTIMIZE TABLE adaptive_granularity_alter FINAL
--Result--
[]
+--------------------+
--Query--
DETACH TABLE adaptive_granularity_alter
--Result--
[]
+--------------------+
--Query--
ATTACH TABLE adaptive_granularity_alter
--Result--
[]
+--------------------+
--Query--
OPTIMIZE TABLE adaptive_granularity_alter FINAL
--Result--
[]
+--------------------+
--Query--
SELECT k, v2 FROM adaptive_granularity_alter WHERE k >= 100 OR k = 42
--Result--
[(42, '42'), (100, 'aaaa'), (101, 'bbbb'), (102, 'cccc'), (103, 'dddd')]
+--------------------+
