--Query--
system stop merges t1
--Result--
[]
+--------------------+
--Query--
explain pipeline select a from t1 group by a
--Result--
[('(Expression)',), ('ExpressionTransform × 16',), ('  (Aggregating)',), ('  Resize 4 → 16',), ('    AggregatingTransform × 4',), ('      (Expression)',), ('      ExpressionTransform × 4',), ('        (ReadFromMergeTree)',), ('        Resize 3 → 1',), ('          MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 3 0 → 1',), ('            Resize 3 → 1',), ('              MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 3 0 → 1',), ('                Resize 3 → 1',), ('                  MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 3 0 → 1',), ('                    Resize 3 → 1',), ('                      MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 3 0 → 1',)]
+--------------------+
--Query--
select count() from (select throwIf(count() != 2) from t1 group by a)
--Result--
[(1000000,)]
+--------------------+
--Query--
system stop merges t2
--Result--
[]
+--------------------+
--Query--
explain pipeline select a from t2 group by a
--Result--
[('(Expression)',), ('ExpressionTransform × 16',), ('  (Aggregating)',), ('  Resize 8 → 16',), ('    AggregatingTransform × 8',), ('      (Expression)',), ('      ExpressionTransform × 8',), ('        (ReadFromMergeTree)',), ('        Resize 2 → 1',), ('          MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',), ('            Resize 2 → 1',), ('              MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',), ('                Resize 2 → 1',), ('                  MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',), ('                    Resize 2 → 1',), ('                      MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',), ('                        Resize 2 → 1',), ('                          MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',), ('                            Resize 2 → 1',), ('                              MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',), ('                                Resize 2 → 1',), ('                                  MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',), ('                                    Resize 2 → 1',), ('                                      MergeTreeSelect(pool: ReadPool, algorithm: Thread) × 2 0 → 1',)]
+--------------------+
--Query--
system stop merges t3
--Result--
[]
+--------------------+
--Query--
explain pipeline select a from t3 group by a
--Result--
[('(Expression)',), ('ExpressionTransform × 16',), ('  (Aggregating)',), ('  Resize 16 → 16',), ('    AggregatingTransform × 16',), ('      (Expression)',), ('      ExpressionTransform × 16',), ('        (ReadFromMergeTree)',), ('        Concat 2 → 1',), ('          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('            Concat 2 → 1',), ('              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                Concat 2 → 1',), ('                  MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                    Concat 2 → 1',), ('                      MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                        Concat 2 → 1',), ('                          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                            Concat 2 → 1',), ('                              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                Concat 2 → 1',), ('                                  MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                    Concat 2 → 1',), ('                                      MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                        Concat 2 → 1',), ('                                          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                            Concat 2 → 1',), ('                                              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                Concat 2 → 1',), ('                                                  MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                    Concat 2 → 1',), ('                                                      MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                        Concat 2 → 1',), ('                                                          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                            Concat 2 → 1',), ('                                                              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                Concat 2 → 1',), ('                                                                  MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                    Concat 2 → 1',), ('                                                                      MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',)]
+--------------------+
--Query--
system stop merges t4
--Result--
[]
+--------------------+
--Query--
explain pipeline select a from t4 group by a settings read_in_order_two_level_merge_threshold = 1e12
--Result--
[('(Expression)',), ('ExpressionTransform × 16',), ('  (Aggregating)',), ('  Resize 4 → 16',), ('    FinalizeAggregatedTransform × 4',), ('      AggregatingInOrderTransform × 4',), ('        (Expression)',), ('        ExpressionTransform × 4',), ('          (ReadFromMergeTree)',), ('          MergingSortedTransform 2 → 1',), ('            ExpressionTransform × 2',), ('              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                MergingSortedTransform 2 → 1',), ('                  ExpressionTransform × 2',), ('                    MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                      MergingSortedTransform 2 → 1',), ('                        ExpressionTransform × 2',), ('                          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                            MergingSortedTransform 2 → 1',), ('                              ExpressionTransform × 2',), ('                                MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',)]
+--------------------+
--Query--
system stop merges t5
--Result--
[]
+--------------------+
--Query--
explain pipeline select a from t5 group by a settings read_in_order_two_level_merge_threshold = 1e12
--Result--
[('(Expression)',), ('ExpressionTransform × 16',), ('  (Aggregating)',), ('  Resize 8 → 16',), ('    FinalizeAggregatedTransform × 8',), ('      AggregatingInOrderTransform × 8',), ('        (Expression)',), ('        ExpressionTransform × 8',), ('          (ReadFromMergeTree)',), ('          MergingSortedTransform 2 → 1',), ('            ExpressionTransform × 2',), ('              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                MergingSortedTransform 2 → 1',), ('                  ExpressionTransform × 2',), ('                    MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                      MergingSortedTransform 2 → 1',), ('                        ExpressionTransform × 2',), ('                          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                            MergingSortedTransform 2 → 1',), ('                              ExpressionTransform × 2',), ('                                MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                  MergingSortedTransform 2 → 1',), ('                                    ExpressionTransform × 2',), ('                                      MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                        MergingSortedTransform 2 → 1',), ('                                          ExpressionTransform × 2',), ('                                            MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                              MergingSortedTransform 2 → 1',), ('                                                ExpressionTransform × 2',), ('                                                  MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                    MergingSortedTransform 2 → 1',), ('                                                      ExpressionTransform × 2',), ('                                                        MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',)]
+--------------------+
--Query--
system stop merges t6
--Result--
[]
+--------------------+
--Query--
explain pipeline select a from t6 group by a settings read_in_order_two_level_merge_threshold = 1e12
--Result--
[('(Expression)',), ('ExpressionTransform × 16',), ('  (Aggregating)',), ('  FinalizeAggregatedTransform × 16',), ('    AggregatingInOrderTransform × 16',), ('      (Expression)',), ('      ExpressionTransform × 16',), ('        (ReadFromMergeTree)',), ('        MergingSortedTransform 2 → 1',), ('          ExpressionTransform × 2',), ('            MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('              MergingSortedTransform 2 → 1',), ('                ExpressionTransform × 2',), ('                  MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                    MergingSortedTransform 2 → 1',), ('                      ExpressionTransform × 2',), ('                        MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                          MergingSortedTransform 2 → 1',), ('                            ExpressionTransform × 2',), ('                              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                MergingSortedTransform 2 → 1',), ('                                  ExpressionTransform × 2',), ('                                    MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                      MergingSortedTransform 2 → 1',), ('                                        ExpressionTransform × 2',), ('                                          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                            MergingSortedTransform 2 → 1',), ('                                              ExpressionTransform × 2',), ('                                                MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                  MergingSortedTransform 2 → 1',), ('                                                    ExpressionTransform × 2',), ('                                                      MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                        MergingSortedTransform 2 → 1',), ('                                                          ExpressionTransform × 2',), ('                                                            MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                              MergingSortedTransform 2 → 1',), ('                                                                ExpressionTransform × 2',), ('                                                                  MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                    MergingSortedTransform 2 → 1',), ('                                                                      ExpressionTransform × 2',), ('                                                                        MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                          MergingSortedTransform 2 → 1',), ('                                                                            ExpressionTransform × 2',), ('                                                                              MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                                MergingSortedTransform 2 → 1',), ('                                                                                  ExpressionTransform × 2',), ('                                                                                    MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                                      MergingSortedTransform 2 → 1',), ('                                                                                        ExpressionTransform × 2',), ('                                                                                          MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                                            MergingSortedTransform 2 → 1',), ('                                                                                              ExpressionTransform × 2',), ('                                                                                                MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',), ('                                                                                                  MergingSortedTransform 2 → 1',), ('                                                                                                    ExpressionTransform × 2',), ('                                                                                                      MergeTreeSelect(pool: ReadPoolInOrder, algorithm: InOrder) × 2 0 → 1',)]
+--------------------+
--Query--
select replaceRegexpOne(explain, '^[ ]*(.*)', '\\1') from (     explain actions=1 select intDiv(a, 2) as a1 from t7 group by a1 ) where explain like '%Skip merging: %'
--Result--
[('Skip merging: 1',)]
+--------------------+
