--Query--
SELECT * FROM summing_composite_key ORDER BY d, k, FirstMap.k1, FirstMap.k2ID, FirstMap.s, SecondMap.k1ID, SecondMap.k2Key, SecondMap.k3Type, SecondMap.s
--Result--
[(datetime.date(2000, 1, 1), 1, [1, 2], [3, 4], [10.0, 11.0], [0, 1, 2], ['3', '4', '5'], [-1, -2, -3], [1, 10, 100]), (datetime.date(2000, 1, 1), 1, [2, 1], [4, 3], [20.0, 22.0], [2, 2, 1], ['5', '5', '0'], [-3, -3, -33], [10, 100, 1000]), (datetime.date(2000, 1, 1), 2, [1, 2], [3, 4], [10.0, 11.0], [0, 1, 2], ['3', '4', '5'], [-1, -2, -3], [1, 10, 100]), (datetime.date(2000, 1, 1), 2, [1, 2], [3, 4], [10.0, 11.0], [0, 1, 2], ['3', '4', '5'], [-1, -2, -3], [1, 10, 100]), (datetime.date(2000, 1, 1), 2, [2, 1, 1], [4, 3, 3], [20.0, 22.0, 33.0], [2, 2], ['5', '5'], [-3, -3], [10, 100])]
+--------------------+
--Query--
SELECT d, k, m.k1, m.k2ID, m.s FROM summing_composite_key ARRAY JOIN FirstMap AS m ORDER BY d, k, m.k1, m.k2ID, m.s, SecondMap.k1ID, SecondMap.k2Key, SecondMap.k3Type, SecondMap.s
--Result--
[(datetime.date(2000, 1, 1), 1, 1, 3, 10.0), (datetime.date(2000, 1, 1), 1, 1, 3, 22.0), (datetime.date(2000, 1, 1), 1, 2, 4, 11.0), (datetime.date(2000, 1, 1), 1, 2, 4, 20.0), (datetime.date(2000, 1, 1), 2, 1, 3, 10.0), (datetime.date(2000, 1, 1), 2, 1, 3, 10.0), (datetime.date(2000, 1, 1), 2, 1, 3, 22.0), (datetime.date(2000, 1, 1), 2, 1, 3, 33.0), (datetime.date(2000, 1, 1), 2, 2, 4, 11.0), (datetime.date(2000, 1, 1), 2, 2, 4, 11.0), (datetime.date(2000, 1, 1), 2, 2, 4, 20.0)]
+--------------------+
--Query--
SELECT d, k, m.k1, m.k2ID, sum(m.s) FROM summing_composite_key ARRAY JOIN FirstMap AS m GROUP BY d, k, m.k1, m.k2ID ORDER BY d, k, m.k1, m.k2ID
--Result--
[(datetime.date(2000, 1, 1), 1, 1, 3, 32.0), (datetime.date(2000, 1, 1), 1, 2, 4, 31.0), (datetime.date(2000, 1, 1), 2, 1, 3, 75.0), (datetime.date(2000, 1, 1), 2, 2, 4, 42.0)]
+--------------------+
--Query--
SELECT d, k, m.k1, m.k2ID, m.s FROM summing_composite_key FINAL ARRAY JOIN FirstMap AS m ORDER BY d, k, m.k1, m.k2ID, m.s
--Result--
[(datetime.date(2000, 1, 1), 1, 1, 3, 32.0), (datetime.date(2000, 1, 1), 1, 2, 4, 31.0), (datetime.date(2000, 1, 1), 2, 1, 3, 75.0), (datetime.date(2000, 1, 1), 2, 2, 4, 42.0)]
+--------------------+
--Query--
SELECT d, k, m.k1ID, m.k2Key, m.k3Type, m.s FROM summing_composite_key ARRAY JOIN SecondMap AS m ORDER BY d, k, m.k1ID, m.k2Key, m.k3Type, m.s
--Result--
[(datetime.date(2000, 1, 1), 1, 0, '3', -1, 1), (datetime.date(2000, 1, 1), 1, 1, '0', -33, 1000), (datetime.date(2000, 1, 1), 1, 1, '4', -2, 10), (datetime.date(2000, 1, 1), 1, 2, '5', -3, 10), (datetime.date(2000, 1, 1), 1, 2, '5', -3, 100), (datetime.date(2000, 1, 1), 1, 2, '5', -3, 100), (datetime.date(2000, 1, 1), 2, 0, '3', -1, 1), (datetime.date(2000, 1, 1), 2, 0, '3', -1, 1), (datetime.date(2000, 1, 1), 2, 1, '4', -2, 10), (datetime.date(2000, 1, 1), 2, 1, '4', -2, 10), (datetime.date(2000, 1, 1), 2, 2, '5', -3, 10), (datetime.date(2000, 1, 1), 2, 2, '5', -3, 100), (datetime.date(2000, 1, 1), 2, 2, '5', -3, 100), (datetime.date(2000, 1, 1), 2, 2, '5', -3, 100)]
+--------------------+
--Query--
SELECT d, k, m.k1ID, m.k2Key, m.k3Type, m.s FROM summing_composite_key FINAL ARRAY JOIN SecondMap AS m ORDER BY d, k, m.k1ID, m.k2Key, m.k3Type, m.s
--Result--
[(datetime.date(2000, 1, 1), 1, 0, '3', -1, 1), (datetime.date(2000, 1, 1), 1, 1, '0', -33, 1000), (datetime.date(2000, 1, 1), 1, 1, '4', -2, 10), (datetime.date(2000, 1, 1), 1, 2, '5', -3, 210), (datetime.date(2000, 1, 1), 2, 0, '3', -1, 2), (datetime.date(2000, 1, 1), 2, 1, '4', -2, 20), (datetime.date(2000, 1, 1), 2, 2, '5', -3, 310)]
+--------------------+
--Query--
OPTIMIZE TABLE summing_composite_key PARTITION 200001 FINAL
--Result--
[]
+--------------------+
--Query--
SELECT * FROM summing_composite_key ORDER BY d, k, FirstMap.k1, FirstMap.k2ID, FirstMap.s, SecondMap.k1ID, SecondMap.k2Key, SecondMap.k3Type, SecondMap.s
--Result--
[(datetime.date(2000, 1, 1), 1, [1, 2], [3, 4], [32.0, 31.0], [0, 1, 1, 2], ['3', '0', '4', '5'], [-1, -33, -2, -3], [1, 1000, 10, 210]), (datetime.date(2000, 1, 1), 2, [1, 2], [3, 4], [75.0, 42.0], [0, 1, 2], ['3', '4', '5'], [-1, -2, -3], [2, 20, 310])]
+--------------------+
--Query--
SELECT d, k, m.k1, m.k2ID, m.s FROM summing_composite_key ARRAY JOIN FirstMap AS m ORDER BY d, k, m.k1, m.k2ID, m.s
--Result--
[(datetime.date(2000, 1, 1), 1, 1, 3, 32.0), (datetime.date(2000, 1, 1), 1, 2, 4, 31.0), (datetime.date(2000, 1, 1), 2, 1, 3, 75.0), (datetime.date(2000, 1, 1), 2, 2, 4, 42.0)]
+--------------------+
--Query--
SELECT d, k, m.k1, m.k2ID, m.s FROM summing_composite_key FINAL ARRAY JOIN FirstMap AS m ORDER BY d, k, m.k1, m.k2ID, m.s
--Result--
[(datetime.date(2000, 1, 1), 1, 1, 3, 32.0), (datetime.date(2000, 1, 1), 1, 2, 4, 31.0), (datetime.date(2000, 1, 1), 2, 1, 3, 75.0), (datetime.date(2000, 1, 1), 2, 2, 4, 42.0)]
+--------------------+
--Query--
SELECT d, k, m.k1ID, m.k2Key, m.k3Type, m.s FROM summing_composite_key ARRAY JOIN SecondMap AS m ORDER BY d, k, m.k1ID, m.k2Key, m.k3Type, m.s
--Result--
[(datetime.date(2000, 1, 1), 1, 0, '3', -1, 1), (datetime.date(2000, 1, 1), 1, 1, '0', -33, 1000), (datetime.date(2000, 1, 1), 1, 1, '4', -2, 10), (datetime.date(2000, 1, 1), 1, 2, '5', -3, 210), (datetime.date(2000, 1, 1), 2, 0, '3', -1, 2), (datetime.date(2000, 1, 1), 2, 1, '4', -2, 20), (datetime.date(2000, 1, 1), 2, 2, '5', -3, 310)]
+--------------------+
--Query--
SELECT d, k, m.k1ID, m.k2Key, m.k3Type, m.s FROM summing_composite_key FINAL ARRAY JOIN SecondMap AS m ORDER BY d, k, m.k1ID, m.k2Key, m.k3Type, m.s
--Result--
[(datetime.date(2000, 1, 1), 1, 0, '3', -1, 1), (datetime.date(2000, 1, 1), 1, 1, '0', -33, 1000), (datetime.date(2000, 1, 1), 1, 1, '4', -2, 10), (datetime.date(2000, 1, 1), 1, 2, '5', -3, 210), (datetime.date(2000, 1, 1), 2, 0, '3', -1, 2), (datetime.date(2000, 1, 1), 2, 1, '4', -2, 20), (datetime.date(2000, 1, 1), 2, 2, '5', -3, 310)]
+--------------------+
