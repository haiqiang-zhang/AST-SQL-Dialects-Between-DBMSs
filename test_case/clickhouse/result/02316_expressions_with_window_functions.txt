--Query--
SELECT number, 1 + sum(number) OVER (PARTITION BY number % 10) FROM numbers(100) ORDER BY number
--Result--
[(0, 451), (1, 461), (2, 471), (3, 481), (4, 491), (5, 501), (6, 511), (7, 521), (8, 531), (9, 541), (10, 451), (11, 461), (12, 471), (13, 481), (14, 491), (15, 501), (16, 511), (17, 521), (18, 531), (19, 541), (20, 451), (21, 461), (22, 471), (23, 481), (24, 491), (25, 501), (26, 511), (27, 521), (28, 531), (29, 541), (30, 451), (31, 461), (32, 471), (33, 481), (34, 491), (35, 501), (36, 511), (37, 521), (38, 531), (39, 541), (40, 451), (41, 461), (42, 471), (43, 481), (44, 491), (45, 501), (46, 511), (47, 521), (48, 531), (49, 541), (50, 451), (51, 461), (52, 471), (53, 481), (54, 491), (55, 501), (56, 511), (57, 521), (58, 531), (59, 541), (60, 451), (61, 461), (62, 471), (63, 481), (64, 491), (65, 501), (66, 511), (67, 521), (68, 531), (69, 541), (70, 451), (71, 461), (72, 471), (73, 481), (74, 491), (75, 501), (76, 511), (77, 521), (78, 531), (79, 541), (80, 451), (81, 461), (82, 471), (83, 481), (84, 491), (85, 501), (86, 511), (87, 521), (88, 531), (89, 541), (90, 451), (91, 461), (92, 471), (93, 481), (94, 491), (95, 501), (96, 511), (97, 521), (98, 531), (99, 541)]
+--------------------+
--Query--
SELECT     number,     sum(number) OVER (PARTITION BY number % 10) / count() OVER (PARTITION BY number % 10),     avg(number) OVER (PARTITION BY number % 10) FROM numbers(100) ORDER BY number ASC
--Result--
[(0, 45.0, 45.0), (1, 46.0, 46.0), (2, 47.0, 47.0), (3, 48.0, 48.0), (4, 49.0, 49.0), (5, 50.0, 50.0), (6, 51.0, 51.0), (7, 52.0, 52.0), (8, 53.0, 53.0), (9, 54.0, 54.0), (10, 45.0, 45.0), (11, 46.0, 46.0), (12, 47.0, 47.0), (13, 48.0, 48.0), (14, 49.0, 49.0), (15, 50.0, 50.0), (16, 51.0, 51.0), (17, 52.0, 52.0), (18, 53.0, 53.0), (19, 54.0, 54.0), (20, 45.0, 45.0), (21, 46.0, 46.0), (22, 47.0, 47.0), (23, 48.0, 48.0), (24, 49.0, 49.0), (25, 50.0, 50.0), (26, 51.0, 51.0), (27, 52.0, 52.0), (28, 53.0, 53.0), (29, 54.0, 54.0), (30, 45.0, 45.0), (31, 46.0, 46.0), (32, 47.0, 47.0), (33, 48.0, 48.0), (34, 49.0, 49.0), (35, 50.0, 50.0), (36, 51.0, 51.0), (37, 52.0, 52.0), (38, 53.0, 53.0), (39, 54.0, 54.0), (40, 45.0, 45.0), (41, 46.0, 46.0), (42, 47.0, 47.0), (43, 48.0, 48.0), (44, 49.0, 49.0), (45, 50.0, 50.0), (46, 51.0, 51.0), (47, 52.0, 52.0), (48, 53.0, 53.0), (49, 54.0, 54.0), (50, 45.0, 45.0), (51, 46.0, 46.0), (52, 47.0, 47.0), (53, 48.0, 48.0), (54, 49.0, 49.0), (55, 50.0, 50.0), (56, 51.0, 51.0), (57, 52.0, 52.0), (58, 53.0, 53.0), (59, 54.0, 54.0), (60, 45.0, 45.0), (61, 46.0, 46.0), (62, 47.0, 47.0), (63, 48.0, 48.0), (64, 49.0, 49.0), (65, 50.0, 50.0), (66, 51.0, 51.0), (67, 52.0, 52.0), (68, 53.0, 53.0), (69, 54.0, 54.0), (70, 45.0, 45.0), (71, 46.0, 46.0), (72, 47.0, 47.0), (73, 48.0, 48.0), (74, 49.0, 49.0), (75, 50.0, 50.0), (76, 51.0, 51.0), (77, 52.0, 52.0), (78, 53.0, 53.0), (79, 54.0, 54.0), (80, 45.0, 45.0), (81, 46.0, 46.0), (82, 47.0, 47.0), (83, 48.0, 48.0), (84, 49.0, 49.0), (85, 50.0, 50.0), (86, 51.0, 51.0), (87, 52.0, 52.0), (88, 53.0, 53.0), (89, 54.0, 54.0), (90, 45.0, 45.0), (91, 46.0, 46.0), (92, 47.0, 47.0), (93, 48.0, 48.0), (94, 49.0, 49.0), (95, 50.0, 50.0), (96, 51.0, 51.0), (97, 52.0, 52.0), (98, 53.0, 53.0), (99, 54.0, 54.0)]
+--------------------+
