--Query--
select k, groupArraySample(10, 123456)(v) from (select number % 4 as k, number as v from numbers(1024)) group by k order by k
--Result--
[(0, [576, 800, 64, 936, 552, 216, 252, 808, 920, 780]), (1, [577, 801, 65, 937, 553, 217, 253, 809, 921, 781]), (2, [578, 802, 66, 938, 554, 218, 254, 810, 922, 782]), (3, [579, 803, 67, 939, 555, 219, 255, 811, 923, 783])]
+--------------------+
