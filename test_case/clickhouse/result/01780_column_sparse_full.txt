--Query--
SYSTEM STOP MERGES t_sparse_full
--Result--
[]
+--------------------+
--Query--
SELECT name, column, serialization_kind FROM system.parts_columns WHERE table = 't_sparse_full' AND database = currentDatabase() AND active ORDER BY name, column
--Result--
[('all_1_1_0', 'id', 'Default'), ('all_1_1_0', 's', 'Sparse'), ('all_1_1_0', 'u', 'Sparse'), ('all_2_2_0', 'id', 'Default'), ('all_2_2_0', 's', 'Default'), ('all_2_2_0', 'u', 'Default')]
+--------------------+
--Query--
SELECT id, u FROM t_sparse_full ORDER BY id, u LIMIT 4
--Result--
[(0, 0), (0, 0), (1, 0), (1, 1)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u FROM t_sparse_full ORDER BY id, u LIMIT 4 SETTINGS optimize_read_in_order = 0
--Result--
[(0, 0), (0, 0), (1, 0), (1, 1)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM t_sparse_full ORDER BY u DESC LIMIT 3
--Result--
[(990, 990, ''), (980, 980, '980'), (970, 970, '')]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM t_sparse_full WHERE u != 0 ORDER BY u DESC LIMIT 3
--Result--
[(990, 990, ''), (980, 980, '980'), (970, 970, '')]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id % 3 AS k, sum(u) FROM t_sparse_full WHERE u != 0 GROUP BY k ORDER BY k
--Result--
[(0, 58413), (1, 57920), (2, 57917)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT uniqExact(u) FROM t_sparse_full WHERE s != ''
--Result--
[(507,)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT toUInt32(s) % 5 AS k, groupUniqArray(u % 4) FROM t_sparse_full WHERE s != '' GROUP BY k ORDER BY k
--Result--
[(0, [0, 2, 1, 3]), (1, [0, 2, 1, 3]), (2, [0, 2, 1, 3]), (3, [0, 2, 1, 3]), (4, [0, 2, 1, 3])]
+--------------------+
--Query--
SELECT max(range(id % 10)[u]) FROM t_sparse_full
--Result--
[(8,)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT sum(u) AS value FROM t_sparse_full GROUP BY id % 3 AS k WITH ROLLUP ORDER BY value
--Result--
[(57917,), (57920,), (58413,), (174250,)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT sum(u) AS value FROM t_sparse_full GROUP BY id % 3 AS k WITH CUBE ORDER BY value
--Result--
[(57917,), (57920,), (58413,), (174250,)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT count() FROM t_sparse_full WHERE u % 4 = 0
--Result--
[(1075,)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT DISTINCT u FROM t_sparse_full ORDER BY id LIMIT 5
--Result--
[(0,), (1,), (2,), (3,), (4,)]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM t_sparse_full INNER JOIN (     SELECT number * 3 AS u FROM numbers(10) ) AS t1 USING(u) ORDER BY id, u, s LIMIT 5
--Result--
[(0, 0, '0'), (0, 0, '0'), (1, 0, ''), (2, 0, ''), (3, 0, '')]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM t_sparse_full FULL JOIN (     SELECT number * 3 AS u FROM numbers(10) ) AS t1 USING(u) ORDER BY id, u, s LIMIT 5
--Result--
[(0, 0, '0'), (0, 0, '0'), (1, 0, ''), (1, 1, '1'), (2, 0, '')]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM (SELECT number * 2 AS u FROM numbers(10)) AS t1 INNER JOIN t_sparse_full USING(u) ORDER BY id, u, s LIMIT 5
--Result--
[(0, 0, '0'), (0, 0, '0'), (1, 0, ''), (2, 0, ''), (2, 2, '2')]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM (SELECT number * 2 AS u FROM numbers(10)) AS t1 FULL JOIN t_sparse_full USING(u) ORDER BY id, u, s LIMIT 5
--Result--
[(0, 0, '0'), (0, 0, '0'), (1, 0, ''), (1, 1, '1'), (2, 0, '')]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM (SELECT u FROM t_sparse_full) AS t1 FULL JOIN t_sparse_full USING(u) ORDER BY id, u, s LIMIT 5
--Result--
[(0, 0, '0'), (0, 0, '0'), (0, 0, '0'), (0, 0, '0'), (0, 0, '0')]
+--------------------+
--Query--
SYSTEM START MERGES t_sparse_full
--Result--
[]
+--------------------+
--Query--
OPTIMIZE TABLE t_sparse_full FINAL
--Result--
[]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT column, serialization_kind FROM system.parts_columns WHERE table = 't_sparse_full' AND database = currentDatabase() AND active ORDER BY name, column
--Result--
[('id', 'Default'), ('s', 'Sparse'), ('u', 'Sparse')]
+--------------------+
--Query--
SELECT '======'
--Result--
[('======',)]
+--------------------+
--Query--
SELECT id, u, s FROM t_sparse_full ORDER BY u DESC LIMIT 3
--Result--
[(990, 990, ''), (980, 980, '980'), (970, 970, '')]
+--------------------+
