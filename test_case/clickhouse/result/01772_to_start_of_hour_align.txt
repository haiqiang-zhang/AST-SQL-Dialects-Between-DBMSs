--Query--
SELECT toStartOfInterval(toDateTime('2021-03-23 03:58:00'), INTERVAL 11 HOUR)
--Result--
[(datetime.datetime(2021, 3, 23, 0, 0),)]
+--------------------+
--Query--
SELECT toStartOfHour(toDateTime('2021-03-23 13:58:00', 'Asia/Kolkata'))
--Result--
[(datetime.datetime(2021, 3, 23, 13, 0, tzinfo=<DstTzInfo 'Asia/Kolkata' IST+5:30:00 STD>),)]
+--------------------+
--Query--
SELECT toDateTime('2010-03-28 00:00:00', 'Europe/Moscow') + INTERVAL 15 * number MINUTE AS src, toStartOfInterval(src, INTERVAL 2 HOUR) AS rounded, toUnixTimestamp(src) AS t FROM numbers(20)
--Result--
[(datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269723600), (datetime.datetime(2010, 3, 28, 0, 15, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269724500), (datetime.datetime(2010, 3, 28, 0, 30, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269725400), (datetime.datetime(2010, 3, 28, 0, 45, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269726300), (datetime.datetime(2010, 3, 28, 1, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269727200), (datetime.datetime(2010, 3, 28, 1, 15, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269728100), (datetime.datetime(2010, 3, 28, 1, 30, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269729000), (datetime.datetime(2010, 3, 28, 1, 45, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), datetime.datetime(2010, 3, 28, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>), 1269729900), (datetime.datetime(2010, 3, 28, 3, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 3, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269730800), (datetime.datetime(2010, 3, 28, 3, 15, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 3, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269731700), (datetime.datetime(2010, 3, 28, 3, 30, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 3, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269732600), (datetime.datetime(2010, 3, 28, 3, 45, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 3, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269733500), (datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269734400), (datetime.datetime(2010, 3, 28, 4, 15, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269735300), (datetime.datetime(2010, 3, 28, 4, 30, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269736200), (datetime.datetime(2010, 3, 28, 4, 45, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269737100), (datetime.datetime(2010, 3, 28, 5, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269738000), (datetime.datetime(2010, 3, 28, 5, 15, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269738900), (datetime.datetime(2010, 3, 28, 5, 30, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269739800), (datetime.datetime(2010, 3, 28, 5, 45, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), datetime.datetime(2010, 3, 28, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSD+4:00:00 DST>), 1269740700)]
+--------------------+
