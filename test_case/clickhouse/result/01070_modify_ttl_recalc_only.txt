--Query--
select * from ttl order by a
--Result--
[(datetime.date(2000, 10, 10), 1), (datetime.date(2000, 10, 10), 2), (datetime.date(2100, 10, 10), 3), (datetime.date(2100, 10, 10), 4)]
+--------------------+
--Query--
select delete_ttl_info_min, delete_ttl_info_max  from system.parts where database = currentDatabase() and table = 'ttl' and active > 0 order by name asc
--Result--
[(datetime.datetime(2000, 10, 11, 0, 0), datetime.datetime(2000, 10, 11, 0, 0)), (datetime.datetime(2000, 10, 11, 0, 0), datetime.datetime(2000, 10, 11, 0, 0)), (datetime.datetime(2100, 10, 11, 0, 0), datetime.datetime(2100, 10, 11, 0, 0)), (datetime.datetime(2100, 10, 11, 0, 0), datetime.datetime(2100, 10, 11, 0, 0))]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select * from ttl order by a
--Result--
[(datetime.date(2100, 10, 10), 3), (datetime.date(2100, 10, 10), 4)]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd')]
+--------------------+
--Query--
select delete_ttl_info_min, delete_ttl_info_max  from system.parts where database = currentDatabase() and table = 'ttl' and active > 0
--Result--
[(datetime.datetime(2000, 1, 1, 0, 0), datetime.datetime(2100, 1, 1, 0, 0))]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[(1, 'a'), (3, 'c')]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[(1, 'a'), (3, 'c')]
+--------------------+
--Query--
select delete_ttl_info_min, delete_ttl_info_max  from system.parts where database = currentDatabase() and table = 'ttl' and active > 0
--Result--
[(datetime.datetime(2000, 1, 1, 0, 0), datetime.datetime(2000, 1, 1, 0, 0))]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd')]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[(1, 'a'), (2, ''), (3, 'c'), (4, '')]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[(1, 'a'), (2, ''), (3, 'c'), (4, '')]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select * from ttl order by i
--Result--
[(1, ''), (2, ''), (3, ''), (4, '')]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
--Query--
select i, s from ttl order by i
--Result--
[(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd')]
+--------------------+
--Query--
select delete_ttl_info_min, delete_ttl_info_max  from system.parts where database = currentDatabase() and table = 'ttl' and active > 0
--Result--
[(datetime.datetime(2000, 1, 1, 0, 0), datetime.datetime(2100, 1, 1, 0, 0))]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select i, s from ttl order by i
--Result--
[(1, 'a'), (2, 'b'), (4, 'd')]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
--Query--
select i, s from ttl order by i
--Result--
[(1, 'a'), (2, 'b'), (4, 'd')]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select i, s from ttl order by i
--Result--
[(1, ''), (2, ''), (4, 'd')]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
--Query--
select i, s, t from ttl order by i
--Result--
[(1, 'a', 'aa'), (2, 'b', 'bb'), (3, 'c', 'cc'), (4, 'd', 'dd')]
+--------------------+
--Query--
optimize table ttl final
--Result--
[]
+--------------------+
--Query--
select i, s, t from ttl order by i
--Result--
[(1, 'a', ''), (2, 'b', 'bb'), (3, '', 'cc'), (4, 'd', '')]
+--------------------+
--Query--
select count() from system.mutations where database = currentDatabase() and table = 'ttl' and is_done
--Result--
[(1,)]
+--------------------+
--Query--
select '============='
--Result--
[('=============',)]
+--------------------+
