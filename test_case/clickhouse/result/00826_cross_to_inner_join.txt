--Query--
select * from system.one l cross join system.one r
--Result--
[(0, 0)]
+--------------------+
--Query--
SELECT '--- cross ---'
--Result--
[('--- cross ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a
--Result--
[(1, 1, 1, 1), (1, 1, 1, 2), (2, 2, 2, None)]
+--------------------+
--Query--
SELECT '--- cross nullable ---'
--Result--
[('--- cross nullable ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.b = t2_00826.b
--Result--
[(1, 1, 1, 1), (2, 2, 1, 2)]
+--------------------+
--Query--
SELECT '--- cross nullable vs not nullable ---'
--Result--
[('--- cross nullable vs not nullable ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.b ORDER BY t1_00826.a
--Result--
[(1, 1, 1, 1), (2, 2, 1, 2)]
+--------------------+
--Query--
SELECT '--- cross self ---'
--Result--
[('--- cross self ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 x cross join t1_00826 y where x.a = y.a and x.b = y.b ORDER BY x.a
--Result--
[(1, 1, 1, 1), (2, 2, 2, 2)]
+--------------------+
--Query--
SELECT '--- cross one table expr ---'
--Result--
[('--- cross one table expr ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t1_00826.b order by (t1_00826.a, t2_00826.a, t2_00826.b)
--Result--
[(1, 1, 1, 1), (1, 1, 1, 2), (1, 1, 2, None), (1, 1, 3, None), (2, 2, 1, 1), (2, 2, 1, 2), (2, 2, 2, None), (2, 2, 3, None)]
+--------------------+
--Query--
SELECT '--- cross multiple ands ---'
--Result--
[('--- cross multiple ands ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and t1_00826.b = t2_00826.b
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
SELECT '--- cross and inside and ---'
--Result--
[('--- cross and inside and ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and (t1_00826.b = t2_00826.b and 1)
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
SELECT '--- cross split conjunction ---'
--Result--
[('--- cross split conjunction ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and t1_00826.b = t2_00826.b and t1_00826.a >= 1 and t2_00826.b = 1
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
SELECT '--- and or ---'
--Result--
[('--- and or ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and t1_00826.b = t2_00826.b and (t1_00826.a >= 1 OR t2_00826.b = 1)
--Result--
[(1, 1, 1, 1)]
+--------------------+
--Query--
SELECT '--- arithmetic expr ---'
--Result--
[('--- arithmetic expr ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a + 1 = t2_00826.a + t2_00826.b AND (t1_00826.a + t1_00826.b + t2_00826.a + t2_00826.b > 5)
--Result--
[(2, 2, 1, 2)]
+--------------------+
--Query--
SELECT '--- is null or ---'
--Result--
[('--- is null or ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.b = t2_00826.a AND (t2_00826.b IS NULL OR t2_00826.b > t2_00826.a) ORDER BY t1_00826.a
--Result--
[(1, 1, 1, 2), (2, 2, 2, None)]
+--------------------+
--Query--
SELECT '--- do not rewrite alias ---'
--Result--
[('--- do not rewrite alias ---',)]
+--------------------+
--Query--
SELECT a as b FROM t1_00826 cross join t2_00826 where t1_00826.b = t2_00826.a AND b > 0
--Result--
[(1,), (1,), (2,)]
+--------------------+
--Query--
SELECT '--- comma ---'
--Result--
[('--- comma ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826, t2_00826 where t1_00826.a = t2_00826.a
--Result--
[(1, 1, 1, 1), (1, 1, 1, 2), (2, 2, 2, None)]
+--------------------+
--Query--
SELECT '--- comma nullable ---'
--Result--
[('--- comma nullable ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826, t2_00826 where t1_00826.b = t2_00826.b
--Result--
[(1, 1, 1, 1), (2, 2, 1, 2)]
+--------------------+
--Query--
SELECT '--- comma and or ---'
--Result--
[('--- comma and or ---',)]
+--------------------+
--Query--
SELECT * FROM t1_00826, t2_00826 where t1_00826.a = t2_00826.a AND (t2_00826.b IS NULL OR t2_00826.b < 2)
--Result--
[(1, 1, 1, 1), (2, 2, 2, None)]
+--------------------+
--Query--
SELECT '--- cross ---'
--Result--
[('--- cross ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON a = t2_00826.a',), ('WHERE a = t2_00826.a',)]
+--------------------+
--Query--
SELECT '--- cross nullable ---'
--Result--
[('--- cross nullable ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826, t2_00826 where t1_00826.a = t2_00826.a
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON a = t2_00826.a',), ('WHERE a = t2_00826.a',)]
+--------------------+
--Query--
SELECT '--- cross nullable vs not nullable ---'
--Result--
[('--- cross nullable vs not nullable ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.b
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON a = t2_00826.b',), ('WHERE a = t2_00826.b',)]
+--------------------+
--Query--
SELECT '--- cross self ---'
--Result--
[('--- cross self ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 x cross join t1_00826 y where x.a = y.a and x.b = y.b
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    y.a,',), ('    y.b',), ('FROM t1_00826 AS x',), ('ALL INNER JOIN t1_00826 AS y ON (a = y.a) AND (b = y.b)',), ('WHERE (a = y.a) AND (b = y.b)',)]
+--------------------+
--Query--
SELECT '--- cross one table expr ---'
--Result--
[('--- cross one table expr ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t1_00826.b
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('CROSS JOIN t2_00826',), ('WHERE a = b',)]
+--------------------+
--Query--
SELECT '--- cross multiple ands ---'
--Result--
[('--- cross multiple ands ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and t1_00826.b = t2_00826.b
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON (a = t2_00826.a) AND (b = t2_00826.b)',), ('WHERE (a = t2_00826.a) AND (b = t2_00826.b)',)]
+--------------------+
--Query--
SELECT '--- cross and inside and ---'
--Result--
[('--- cross and inside and ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and (t1_00826.a = t2_00826.a and (t1_00826.a = t2_00826.a and t1_00826.b = t2_00826.b))
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON (a = t2_00826.a) AND (a = t2_00826.a) AND (a = t2_00826.a) AND (b = t2_00826.b)',), ('WHERE (a = t2_00826.a) AND ((a = t2_00826.a) AND ((a = t2_00826.a) AND (b = t2_00826.b)))',)]
+--------------------+
--Query--
SELECT '--- cross split conjunction ---'
--Result--
[('--- cross split conjunction ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and t1_00826.b = t2_00826.b and t1_00826.a >= 1 and t2_00826.b > 0
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON (a = t2_00826.a) AND (b = t2_00826.b)',), ('WHERE (a = t2_00826.a) AND (b = t2_00826.b) AND (a >= 1) AND (t2_00826.b > 0)',)]
+--------------------+
--Query--
SELECT '--- and or ---'
--Result--
[('--- and or ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a = t2_00826.a and t1_00826.b = t2_00826.b and (t1_00826.a >= 1 OR t2_00826.b = 1)
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON (a = t2_00826.a) AND (b = t2_00826.b)',), ('WHERE (a = t2_00826.a) AND (b = t2_00826.b) AND ((a >= 1) OR (t2_00826.b = 1))',)]
+--------------------+
--Query--
SELECT '--- arithmetic expr ---'
--Result--
[('--- arithmetic expr ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.a + 1 = t2_00826.a + t2_00826.b AND (t1_00826.a + t1_00826.b + t2_00826.a + t2_00826.b > 5)
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON (a + 1) = (t2_00826.a + t2_00826.b)',), ('WHERE ((a + 1) = (t2_00826.a + t2_00826.b)) AND ((((a + b) + t2_00826.a) + t2_00826.b) > 5)',)]
+--------------------+
--Query--
SELECT '--- is null or ---'
--Result--
[('--- is null or ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826 cross join t2_00826 where t1_00826.b = t2_00826.a AND (t2_00826.b IS NULL OR t2_00826.b > t2_00826.a)
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON b = t2_00826.a',), ('WHERE (b = t2_00826.a) AND ((t2_00826.b IS NULL) OR (t2_00826.b > t2_00826.a))',)]
+--------------------+
--Query--
SELECT '--- do not rewrite alias ---'
--Result--
[('--- do not rewrite alias ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT a as b FROM t1_00826 cross join t2_00826 where t1_00826.b = t2_00826.a AND b > 0
--Result--
[('SELECT a AS b',), ('FROM t1_00826',), ('CROSS JOIN t2_00826',), ('WHERE (b = t2_00826.a) AND (b > 0)',)]
+--------------------+
--Query--
SELECT '--- comma ---'
--Result--
[('--- comma ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826, t2_00826 where t1_00826.a = t2_00826.a
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON a = t2_00826.a',), ('WHERE a = t2_00826.a',)]
+--------------------+
--Query--
SELECT '--- comma nullable ---'
--Result--
[('--- comma nullable ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826, t2_00826 where t1_00826.b = t2_00826.b
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON b = t2_00826.b',), ('WHERE b = t2_00826.b',)]
+--------------------+
--Query--
SELECT '--- comma and or ---'
--Result--
[('--- comma and or ---',)]
+--------------------+
--Query--
EXPLAIN SYNTAX SELECT * FROM t1_00826, t2_00826 where t1_00826.a = t2_00826.a AND (t2_00826.b IS NULL OR t2_00826.b < 2)
--Result--
[('SELECT',), ('    a,',), ('    b,',), ('    t2_00826.a,',), ('    t2_00826.b',), ('FROM t1_00826',), ('ALL INNER JOIN t2_00826 ON a = t2_00826.a',), ('WHERE (a = t2_00826.a) AND ((t2_00826.b IS NULL) OR (t2_00826.b < 2))',)]
+--------------------+
