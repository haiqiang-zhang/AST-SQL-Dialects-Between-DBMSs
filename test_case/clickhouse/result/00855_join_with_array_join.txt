--Query--
SELECT ax, c FROM (SELECT [1,2] ax, 0 c) ARRAY JOIN ax JOIN (SELECT 0 c) USING (c)
--Result--
[(1, 0), (2, 0)]
+--------------------+
--Query--
SELECT ax, c FROM (SELECT [3,4] ax, 0 c) JOIN (SELECT 0 c) USING (c) ARRAY JOIN ax
--Result--
[(3, 0), (4, 0)]
+--------------------+
--Query--
SELECT ax, c FROM (SELECT [5,6] ax, 0 c) s1 JOIN system.one s2 ON s1.c = s2.dummy ARRAY JOIN ax
--Result--
[(5, 0), (6, 0)]
+--------------------+
--Query--
SELECT ax, c, d FROM (SELECT [7,8] ax, 1 c, 0 d) s1 JOIN system.one s2 ON s1.c = s2.dummy OR s1.d = s2.dummy ARRAY JOIN ax
--Result--
[(7, 1, 0), (8, 1, 0)]
+--------------------+
--Query--
SELECT ax, c FROM (SELECT [101,102] ax, 0 c) s1 JOIN system.one s2 ON s1.c = s2.dummy JOIN system.one s3 ON s1.c = s3.dummy ARRAY JOIN ax
--Result--
[(101, 0), (102, 0)]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT d_ids, id, name FROM f LEFT ARRAY JOIN d_ids LEFT JOIN d ON d.id = d_ids ORDER BY id
--Result--
[(1, 0, ''), (2, 2, 'a2')]
+--------------------+
--Query--
SELECT did, id, name FROM f LEFT ARRAY JOIN d_ids as did LEFT JOIN d ON d.id = did ORDER BY id
--Result--
[(1, 0, ''), (2, 2, 'a2')]
+--------------------+
--Query--
SELECT id, name FROM f LEFT ARRAY JOIN d_ids as id LEFT JOIN d ON d.id = id ORDER BY id
--Result--
[(1, ''), (2, 'a2')]
+--------------------+
--Query--
SELECT * FROM ( SELECT [dummy, dummy] AS dummy FROM system.one ) AS x ARRAY JOIN dummy JOIN system.one AS y ON x.dummy == y.dummy
--Result--
[(0, 0), (0, 0)]
+--------------------+
--Query--
SELECT * FROM ( SELECT [dummy, dummy] AS dummy FROM system.one ) AS x ARRAY JOIN dummy JOIN system.one AS y ON x.dummy + 1 == y.dummy + 1
--Result--
[(0, 0), (0, 0)]
+--------------------+
--Query--
SELECT * FROM ( SELECT [dummy, dummy] AS dummy FROM system.one ) AS x ARRAY JOIN dummy JOIN system.one AS y USING dummy
--Result--
[(0,), (0,)]
+--------------------+
--Query--
SELECT * FROM ( SELECT [toUInt32(dummy), toUInt32(dummy)] AS dummy FROM system.one ) AS x ARRAY JOIN dummy JOIN (select toInt32(dummy) as dummy from system.one ) AS y USING dummy
--Result--
[(0,), (0,)]
+--------------------+
--Query--
SELECT dummy > 0, toTypeName(any(dummy)), any(toTypeName(dummy)) FROM ( SELECT [toUInt32(dummy), toUInt32(dummy)] AS dummy FROM system.one ) AS x ARRAY JOIN dummy JOIN ( SELECT toInt32(dummy) AS dummy FROM system.one ) AS y USING dummy GROUP BY (dummy > 0)
--Result--
[(0, 'Int64', 'Int64')]
+--------------------+
