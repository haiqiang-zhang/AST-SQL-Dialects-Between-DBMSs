--Query--
SELECT k, topK(v) FROM (SELECT number % 10 AS k, arrayMap(x -> arrayMap(x -> x = 0 ? NULL : toString(x), range(x)), range(intDiv(number, 13))) AS v FROM system.numbers LIMIT 100) GROUP BY k ORDER BY k
--Result--
[(0, [[], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[]], [[], [None]], [[], [None], [None, '1'], [None, '1', '2']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']]]), (1, [[], [[], [None], [None, '1']], [[]], [[], [None]], [[], [None], [None, '1'], [None, '1', '2']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (2, [[], [[], [None], [None, '1'], [None, '1', '2']], [[]], [[], [None]], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (3, [[[]], [[], [None], [None, '1'], [None, '1', '2']], [], [[], [None]], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (4, [[[]], [[], [None], [None, '1'], [None, '1', '2']], [], [[], [None]], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (5, [[[]], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [], [[], [None]], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (6, [[[], [None]], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [], [[]], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (7, [[[], [None]], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [], [[]], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (8, [[[], [None]], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [], [[]], [[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]]), (9, [[[], [None], [None, '1']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4']], [], [[]], [[], [None]], [[], [None], [None, '1'], [None, '1', '2']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3']], [[], [None], [None, '1'], [None, '1', '2'], [None, '1', '2', '3'], [None, '1', '2', '3', '4'], [None, '1', '2', '3', '4', '5']]])]
+--------------------+
