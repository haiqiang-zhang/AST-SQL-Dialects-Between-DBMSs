--Query--
SELECT * FROM 02702_logical_optimizer WHERE a = 1 OR 3 = a OR NULL = a
--Result--
[(1, 'test'), (3, 'another')]
+--------------------+
--Query--
EXPLAIN QUERY TREE SELECT * FROM 02702_logical_optimizer WHERE a = 1 OR 3 = a OR NULL = a
--Result--
[('QUERY id: 0',), ('  PROJECTION COLUMNS',), ('    a Int32',), ('    b LowCardinality(String)',), ('  PROJECTION',), ('    LIST id: 1, nodes: 2',), ('      COLUMN id: 2, column_name: a, result_type: Int32, source_id: 3',), ('      COLUMN id: 4, column_name: b, result_type: LowCardinality(String), source_id: 3',), ('  JOIN TREE',), ('    TABLE id: 3, alias: __table1, table_name: test.02702_logical_optimizer',), ('  WHERE',), ('    FUNCTION id: 5, function_name: or, function_type: ordinary, result_type: Nullable(UInt8)',), ('      ARGUMENTS',), ('        LIST id: 6, nodes: 3',), ('          FUNCTION id: 7, function_name: equals, function_type: ordinary, result_type: UInt8',), ('            ARGUMENTS',), ('              LIST id: 8, nodes: 2',), ('                COLUMN id: 9, column_name: a, result_type: Int32, source_id: 3',), ('                CONSTANT id: 10, constant_value: UInt64_1, constant_value_type: UInt8',), ('          FUNCTION id: 11, function_name: equals, function_type: ordinary, result_type: UInt8',), ('            ARGUMENTS',), ('              LIST id: 12, nodes: 2',), ('                CONSTANT id: 13, constant_value: UInt64_3, constant_value_type: UInt8',), ('                COLUMN id: 9, column_name: a, result_type: Int32, source_id: 3',), ('          FUNCTION id: 14, function_name: equals, function_type: ordinary, result_type: Nullable(Nothing)',), ('            ARGUMENTS',), ('              LIST id: 15, nodes: 2',), ('                CONSTANT id: 16, constant_value: NULL, constant_value_type: Nullable(Nothing)',), ('                COLUMN id: 9, column_name: a, result_type: Int32, source_id: 3',)]
+--------------------+
--Query--
SELECT * FROM 02702_logical_optimizer WHERE a = 1 OR 3 = a OR 2 = a OR a = NULL
--Result--
[(1, 'test'), (2, 'test2'), (3, 'another')]
+--------------------+
--Query--
EXPLAIN QUERY TREE SELECT * FROM 02702_logical_optimizer WHERE a = 1 OR 3 = a OR 2 = a OR a = NULL
--Result--
[('QUERY id: 0',), ('  PROJECTION COLUMNS',), ('    a Int32',), ('    b LowCardinality(String)',), ('  PROJECTION',), ('    LIST id: 1, nodes: 2',), ('      COLUMN id: 2, column_name: a, result_type: Int32, source_id: 3',), ('      COLUMN id: 4, column_name: b, result_type: LowCardinality(String), source_id: 3',), ('  JOIN TREE',), ('    TABLE id: 3, alias: __table1, table_name: test.02702_logical_optimizer',), ('  WHERE',), ('    FUNCTION id: 5, function_name: or, function_type: ordinary, result_type: Nullable(UInt8)',), ('      ARGUMENTS',), ('        LIST id: 6, nodes: 2',), ('          FUNCTION id: 7, function_name: equals, function_type: ordinary, result_type: Nullable(Nothing)',), ('            ARGUMENTS',), ('              LIST id: 8, nodes: 2',), ('                COLUMN id: 9, column_name: a, result_type: Int32, source_id: 3',), ('                CONSTANT id: 10, constant_value: NULL, constant_value_type: Nullable(Nothing)',), ('          FUNCTION id: 11, function_name: in, function_type: ordinary, result_type: UInt8',), ('            ARGUMENTS',), ('              LIST id: 12, nodes: 2',), ('                COLUMN id: 9, column_name: a, result_type: Int32, source_id: 3',), ('                CONSTANT id: 13, constant_value: Tuple_(UInt64_1, UInt64_3, UInt64_2), constant_value_type: Tuple(UInt8, UInt8, UInt8)',)]
+--------------------+
--Query--
SELECT * FROM 02702_logical_optimizer_with_null_column WHERE a = 1 OR 3 = a OR 2 = a
--Result--
[(1, 'test'), (2, 'test2'), (3, 'another')]
+--------------------+
--Query--
EXPLAIN QUERY TREE SELECT * FROM 02702_logical_optimizer_with_null_column WHERE a = 1 OR 3 = a OR 2 = a
--Result--
[('QUERY id: 0',), ('  PROJECTION COLUMNS',), ('    a Nullable(Int32)',), ('    b LowCardinality(String)',), ('  PROJECTION',), ('    LIST id: 1, nodes: 2',), ('      COLUMN id: 2, column_name: a, result_type: Nullable(Int32), source_id: 3',), ('      COLUMN id: 4, column_name: b, result_type: LowCardinality(String), source_id: 3',), ('  JOIN TREE',), ('    TABLE id: 3, alias: __table1, table_name: test.02702_logical_optimizer_with_null_column',), ('  WHERE',), ('    FUNCTION id: 5, function_name: in, function_type: ordinary, result_type: Nullable(UInt8)',), ('      ARGUMENTS',), ('        LIST id: 6, nodes: 2',), ('          COLUMN id: 7, column_name: a, result_type: Nullable(Int32), source_id: 3',), ('          CONSTANT id: 8, constant_value: Tuple_(UInt64_1, UInt64_3, UInt64_2), constant_value_type: Tuple(UInt8, UInt8, UInt8)',)]
+--------------------+
--Query--
SELECT materialize(1) AS k WHERE NULL OR (0 OR (k = 2) OR (k = CAST(1, 'Nullable(UInt8)') OR k = 3))
--Result--
[(1,)]
+--------------------+
--Query--
SELECT (k = 2) OR (k = 1) OR ((NULL OR 1) = k) FROM (SELECT 1 AS k)
--Result--
[(1,)]
+--------------------+
