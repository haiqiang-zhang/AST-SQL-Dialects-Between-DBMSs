--Query--
select URLHash('' as url) = URLHash(appendTrailingCharIfAbsent(url, '/'))
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('http://ya.ru' as url) = URLHash(appendTrailingCharIfAbsent(url, '/'))
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('http://ya.ru' as url) = URLHash(appendTrailingCharIfAbsent(url, '?'))
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('http://ya.ru' as url) = URLHash(appendTrailingCharIfAbsent(url, '#'))
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('' as url, 0) = URLHash(url)
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('' as url, 1) = URLHash(url)
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('' as url, 1000) = URLHash(url)
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('http://ya.ru/a' as url, 0 as level) = URLHash(URLHierarchy(url)[level + 1])
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash('http://ya.ru/a' as url, 1 as level) = URLHash(URLHierarchy(url)[level + 1])
--Result--
[(1,)]
+--------------------+
--Query--
select URLHash(url, 0 as level) = URLHash(URLHierarchy(url)[level + 1]) from system.one array join ['', 'http://ya.ru', 'http://ya.ru/', 'http://ya.ru/a', 'http://ya.ru/a/', 'http://ya.ru/a/b', 'http://ya.ru/a/b?'] as url
--Result--
[(1,), (1,), (1,), (1,), (1,), (1,), (1,)]
+--------------------+
--Query--
select URLHash(url, 1 as level) = URLHash(URLHierarchy(url)[level + 1]) from system.one array join ['', 'http://ya.ru', 'http://ya.ru/', 'http://ya.ru/a', 'http://ya.ru/a/', 'http://ya.ru/a/b', 'http://ya.ru/a/b?'] as url
--Result--
[(1,), (1,), (1,), (1,), (1,), (1,), (1,)]
+--------------------+
--Query--
select URLHash(url, 2 as level) = URLHash(URLHierarchy(url)[level + 1]) from system.one array join ['', 'http://ya.ru', 'http://ya.ru/', 'http://ya.ru/a', 'http://ya.ru/a/', 'http://ya.ru/a/b', 'http://ya.ru/a/b?'] as url
--Result--
[(1,), (1,), (1,), (1,), (1,), (1,), (1,)]
+--------------------+
--Query--
select URLHash(url, 3 as level) = URLHash(URLHierarchy(url)[level + 1]) from system.one array join ['', 'http://ya.ru', 'http://ya.ru/', 'http://ya.ru/a', 'http://ya.ru/a/', 'http://ya.ru/a/b', 'http://ya.ru/a/b?'] as url
--Result--
[(1,), (1,), (1,), (1,), (1,), (1,), (1,)]
+--------------------+
--Query--
select URLHash(url, 4 as level) = URLHash(URLHierarchy(url)[level + 1]) from system.one array join ['', 'http://ya.ru', 'http://ya.ru/', 'http://ya.ru/a', 'http://ya.ru/a/', 'http://ya.ru/a/b', 'http://ya.ru/a/b?'] as url
--Result--
[(1,), (1,), (1,), (1,), (1,), (1,), (1,)]
+--------------------+
