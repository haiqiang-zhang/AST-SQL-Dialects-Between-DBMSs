--Query--
SELECT * FROM t1 JOIN t2 ON t1.foo = t2.bar WHERE t2.dt >= '2020-02-01'
--Result--
[(datetime.datetime(2020, 2, 2, 13, 0), 'fact2', 't1_val2', datetime.datetime(2020, 2, 5, 13, 0), 'fact2', 't1_val2')]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT t1.*, t1.dt, t2.*, t2.dt FROM t1 JOIN t2 ON t1.foo = t2.bar WHERE t2.dt >= '2020-02-01'
--Result--
[(datetime.datetime(2020, 2, 2, 13, 0), 'fact2', 't1_val2', datetime.date(2020, 2, 2), datetime.datetime(2020, 2, 5, 13, 0), 'fact2', 't1_val2', datetime.date(2020, 2, 5))]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT t1.dt, t2.dt FROM t1 JOIN t2 ON t1.foo = t2.bar ORDER BY t1.dt
--Result--
[(datetime.date(2020, 1, 1), datetime.date(2020, 1, 1)), (datetime.date(2020, 2, 2), datetime.date(2020, 2, 5))]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT * FROM t1 ALL JOIN t2 ON t1.dt = t2.dt ORDER BY t1.time, t2.time
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't1_val1', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2'), (datetime.datetime(2020, 1, 1, 13, 0), 'fact3', 't1_val3', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2')]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT * FROM t1 ALL JOIN t2 USING (dt) ORDER BY t1.time, t2.time settings allow_experimental_analyzer=0
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't1_val1', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2'), (datetime.datetime(2020, 1, 1, 13, 0), 'fact3', 't1_val3', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2')]
+--------------------+
--Query--
SELECT * FROM t1 ALL JOIN t2 USING (dt) ORDER BY t1.time, t2.time settings allow_experimental_analyzer=1
--Result--
[(datetime.date(2020, 1, 1), datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't1_val1', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2'), (datetime.date(2020, 1, 1), datetime.datetime(2020, 1, 1, 13, 0), 'fact3', 't1_val3', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2')]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON t1.dt1 = t2.dt2 ORDER BY t1.time, t1.dimension_1, t2.time, t2.dimension_2
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't1_val1', datetime.datetime(2019, 1, 1, 12, 0), 'fact4', 't2_val2'), (datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't1_val1', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2'), (datetime.datetime(2020, 1, 1, 13, 0), 'fact3', 't1_val3', datetime.datetime(2019, 1, 1, 12, 0), 'fact4', 't2_val2'), (datetime.datetime(2020, 1, 1, 13, 0), 'fact3', 't1_val3', datetime.datetime(2020, 1, 1, 12, 0), 'fact1', 't2_val2')]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT * FROM t1 JOIN t2 ON t1.foo = t2.bar WHERE t2.aliascol2 == 'fact2t1_val2'
--Result--
[(datetime.datetime(2020, 2, 2, 13, 0), 'fact2', 't1_val2', datetime.datetime(2020, 2, 5, 13, 0), 'fact2', 't1_val2')]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT t1.aliascol1, t2.aliascol2 FROM t1 JOIN t2 ON t1.foo = t2.bar ORDER BY t1.time, t2.time
--Result--
[('fact1t1_val1', 'fact1t2_val2'), ('fact2t1_val2', 'fact2t1_val2')]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT t1.time, t2.time FROM t1 JOIN t2 ON t1.aliascol1 = t2.aliascol2 ORDER BY t1.time, t2.time
--Result--
[(datetime.datetime(2020, 2, 2, 13, 0), datetime.datetime(2020, 2, 5, 13, 0))]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT count() FROM t1 JOIN t2 ON t1.time_alias = t2.time
--Result--
[(1,)]
+--------------------+
--Query--
SELECT '-'
--Result--
[('-',)]
+--------------------+
--Query--
SELECT t1.time as talias FROM t1 JOIN t2 ON talias = t2.time
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0),)]
+--------------------+
--Query--
SELECT t1.time as talias FROM t1 JOIN t2 ON talias = t2.time_alias
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0),)]
+--------------------+
--Query--
SELECT t2.time as talias FROM t1 JOIN t2 ON t1.time = talias
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0),)]
+--------------------+
--Query--
SELECT t2.time as talias FROM t1 JOIN t2 ON t1.time_alias = talias
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0),)]
+--------------------+
--Query--
SELECT time as talias FROM t1 JOIN t2 ON talias = t2.time settings allow_experimental_analyzer=1
--Result--
[(datetime.datetime(2020, 1, 1, 12, 0),)]
+--------------------+
