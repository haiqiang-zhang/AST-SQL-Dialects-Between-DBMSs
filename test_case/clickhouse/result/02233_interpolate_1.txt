--Query--
# Test WITH FILL without INTERPOLATE SELECT n, source, inter FROM (    SELECT toFloat32(number % 10) AS n, 'original' AS source, number as inter FROM numbers(10) WHERE number % 3 = 1 ) ORDER BY n WITH FILL FROM 0 TO 11.51 STEP 0.5
--Result--
[(0.0, '', 0), (0.5, '', 0), (1.0, 'original', 1), (1.5, '', 0), (2.0, '', 0), (2.5, '', 0), (3.0, '', 0), (3.5, '', 0), (4.0, 'original', 4), (4.5, '', 0), (5.0, '', 0), (5.5, '', 0), (6.0, '', 0), (6.5, '', 0), (7.0, 'original', 7), (7.5, '', 0), (8.0, '', 0), (8.5, '', 0), (9.0, '', 0), (9.5, '', 0), (10.0, '', 0), (10.5, '', 0), (11.0, '', 0), (11.5, '', 0)]
+--------------------+
--Query--
# Test INTERPOLATE with const SELECT n, source, inter FROM (    SELECT toFloat32(number % 10) AS n, 'original' AS source, number as inter FROM numbers(10) WHERE number % 3 = 1 ) ORDER BY n WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE (inter AS 42)
--Result--
[(0.0, '', 42), (0.5, '', 42), (1.0, 'original', 1), (1.5, '', 42), (2.0, '', 42), (2.5, '', 42), (3.0, '', 42), (3.5, '', 42), (4.0, 'original', 4), (4.5, '', 42), (5.0, '', 42), (5.5, '', 42), (6.0, '', 42), (6.5, '', 42), (7.0, 'original', 7), (7.5, '', 42), (8.0, '', 42), (8.5, '', 42), (9.0, '', 42), (9.5, '', 42), (10.0, '', 42), (10.5, '', 42), (11.0, '', 42), (11.5, '', 42)]
+--------------------+
--Query--
# Test INTERPOLATE with field value SELECT n, source, inter FROM (    SELECT toFloat32(number % 10) AS n, 'original' AS source, number as inter FROM numbers(10) WHERE number % 3 = 1 ) ORDER BY n WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE (inter AS inter)
--Result--
[(0.0, '', 0), (0.5, '', 0), (1.0, 'original', 1), (1.5, '', 1), (2.0, '', 1), (2.5, '', 1), (3.0, '', 1), (3.5, '', 1), (4.0, 'original', 4), (4.5, '', 4), (5.0, '', 4), (5.5, '', 4), (6.0, '', 4), (6.5, '', 4), (7.0, 'original', 7), (7.5, '', 7), (8.0, '', 7), (8.5, '', 7), (9.0, '', 7), (9.5, '', 7), (10.0, '', 7), (10.5, '', 7), (11.0, '', 7), (11.5, '', 7)]
+--------------------+
--Query--
# Test INTERPOLATE with expression SELECT n, source, inter FROM (    SELECT toFloat32(number % 10) AS n, 'original' AS source, number as inter FROM numbers(10) WHERE number % 3 = 1 ) ORDER BY n WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE (inter AS inter + 1)
--Result--
[(0.0, '', 1), (0.5, '', 2), (1.0, 'original', 1), (1.5, '', 2), (2.0, '', 3), (2.5, '', 4), (3.0, '', 5), (3.5, '', 6), (4.0, 'original', 4), (4.5, '', 5), (5.0, '', 6), (5.5, '', 7), (6.0, '', 8), (6.5, '', 9), (7.0, 'original', 7), (7.5, '', 8), (8.0, '', 9), (8.5, '', 10), (9.0, '', 11), (9.5, '', 12), (10.0, '', 13), (10.5, '', 14), (11.0, '', 15), (11.5, '', 16)]
+--------------------+
--Query--
# Test INTERPOLATE with aliased column SELECT n, source, inter + 1 AS inter_p FROM (     SELECT toFloat32(number % 10) AS n, 'original' AS source, number AS inter FROM numbers(10) WHERE (number % 3) = 1 ) ORDER BY n ASC WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE ( inter_p AS inter_p + 1 )
--Result--
[(0.0, '', 1), (0.5, '', 2), (1.0, 'original', 2), (1.5, '', 3), (2.0, '', 4), (2.5, '', 5), (3.0, '', 6), (3.5, '', 7), (4.0, 'original', 5), (4.5, '', 6), (5.0, '', 7), (5.5, '', 8), (6.0, '', 9), (6.5, '', 10), (7.0, 'original', 8), (7.5, '', 9), (8.0, '', 10), (8.5, '', 11), (9.0, '', 12), (9.5, '', 13), (10.0, '', 14), (10.5, '', 15), (11.0, '', 16), (11.5, '', 17)]
+--------------------+
--Query--
# Test INTERPOLATE with column not present in select SELECT source, inter FROM (     SELECT toFloat32(number % 10) AS n, 'original' AS source, number AS inter, number + 1 AS inter2 FROM numbers(10) WHERE (number % 3) = 1 ) ORDER BY n ASC WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE ( inter AS inter2 + inter )
--Result--
[('', 0), ('', 0), ('original', 1), ('', 3), ('', 3), ('', 3), ('', 3), ('', 3), ('original', 4), ('', 9), ('', 9), ('', 9), ('', 9), ('', 9), ('original', 7), ('', 15), ('', 15), ('', 15), ('', 15), ('', 15), ('', 15), ('', 15), ('', 15), ('', 15)]
+--------------------+
--Query--
# Test INTERPOLATE in sub-select SELECT n, source, inter FROM (     SELECT n, source, inter, inter2 FROM (         SELECT toFloat32(number % 10) AS n, 'original' AS source, number AS inter, number + 1 AS inter2 FROM numbers(10) WHERE (number % 3) = 1     ) ORDER BY n ASC WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE ( inter AS inter + inter2 ) )
--Result--
[(0.0, '', 0), (0.5, '', 0), (1.0, 'original', 1), (1.5, '', 3), (2.0, '', 3), (2.5, '', 3), (3.0, '', 3), (3.5, '', 3), (4.0, 'original', 4), (4.5, '', 9), (5.0, '', 9), (5.5, '', 9), (6.0, '', 9), (6.5, '', 9), (7.0, 'original', 7), (7.5, '', 15), (8.0, '', 15), (8.5, '', 15), (9.0, '', 15), (9.5, '', 15), (10.0, '', 15), (10.5, '', 15), (11.0, '', 15), (11.5, '', 15)]
+--------------------+
--Query--
# Test INTERPOLATE with aggregates SELECT n, any(source), sum(inter) AS inter_s FROM (     SELECT toFloat32(number % 10) AS n, 'original' AS source, number AS inter FROM numbers(10) WHERE (number % 3) = 1 ) GROUP BY n ORDER BY n ASC WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE ( inter_s AS inter_s + 1 )
--Result--
[(0.0, '', 1), (0.5, '', 2), (1.0, 'original', 1), (1.5, '', 2), (2.0, '', 3), (2.5, '', 4), (3.0, '', 5), (3.5, '', 6), (4.0, 'original', 4), (4.5, '', 5), (5.0, '', 6), (5.5, '', 7), (6.0, '', 8), (6.5, '', 9), (7.0, 'original', 7), (7.5, '', 8), (8.0, '', 9), (8.5, '', 10), (9.0, '', 11), (9.5, '', 12), (10.0, '', 13), (10.5, '', 14), (11.0, '', 15), (11.5, '', 16)]
+--------------------+
--Query--
# Test INTERPOLATE with Nullable in result SELECT n, source, inter + NULL AS inter_p FROM (     SELECT toFloat32(number % 10) AS n, 'original' AS source, number AS inter FROM numbers(10) WHERE (number % 3) = 1 ) ORDER BY n ASC WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE ( inter_p AS inter_p + 1 )
--Result--
[(0.0, '', None), (0.5, '', None), (1.0, 'original', None), (1.5, '', None), (2.0, '', None), (2.5, '', None), (3.0, '', None), (3.5, '', None), (4.0, 'original', None), (4.5, '', None), (5.0, '', None), (5.5, '', None), (6.0, '', None), (6.5, '', None), (7.0, 'original', None), (7.5, '', None), (8.0, '', None), (8.5, '', None), (9.0, '', None), (9.5, '', None), (10.0, '', None), (10.5, '', None), (11.0, '', None), (11.5, '', None)]
+--------------------+
--Query--
# Test INTERPOLATE with Nullable in source SELECT n, source, inter AS inter_p FROM (     SELECT toFloat32(number % 10) AS n, 'original' AS source, number + NULL AS inter FROM numbers(10) WHERE (number % 3) = 1 ) ORDER BY n ASC WITH FILL FROM 0 TO 11.51 STEP 0.5 INTERPOLATE ( inter_p AS inter_p + 1 )
--Result--
[(0.0, '', None), (0.5, '', None), (1.0, 'original', None), (1.5, '', None), (2.0, '', None), (2.5, '', None), (3.0, '', None), (3.5, '', None), (4.0, 'original', None), (4.5, '', None), (5.0, '', None), (5.5, '', None), (6.0, '', None), (6.5, '', None), (7.0, 'original', None), (7.5, '', None), (8.0, '', None), (8.5, '', None), (9.0, '', None), (9.5, '', None), (10.0, '', None), (10.5, '', None), (11.0, '', None), (11.5, '', None)]
+--------------------+
--Query--
# Test INTERPOLATE for MergeTree DROP TABLE IF EXISTS t_inter_02233
--Result--
[]
+--------------------+
--Query--
SELECT n, count() AS m FROM t_inter_02233 GROUP BY n ORDER BY n WITH FILL INTERPOLATE ( m AS m + 1 )
--Result--
[(1, 1), (2, 2), (3, 2), (4, 3), (5, 4), (6, 3)]
+--------------------+
