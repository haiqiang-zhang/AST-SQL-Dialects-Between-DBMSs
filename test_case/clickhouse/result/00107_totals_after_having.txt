--Query--
SELECT '*** In-memory aggregation.'
--Result--
[('*** In-memory aggregation.',)]
+--------------------+
--Query--
SELECT '**** totals_mode = after_having_auto'
--Result--
[('**** totals_mode = after_having_auto',)]
+--------------------+
--Query--
SELECT intDiv(number, 2) AS k, count(), argMax(toString(number), number) FROM (SELECT number FROM system.numbers LIMIT 500000) GROUP BY k WITH TOTALS ORDER BY k LIMIT 10
--Result--
[(0, 2, '1'), (1, 2, '3'), (2, 2, '5'), (3, 2, '7'), (4, 2, '9'), (5, 2, '11'), (6, 2, '13'), (7, 2, '15'), (8, 2, '17'), (9, 2, '19'), (0, 500000, '499999')]
+--------------------+
--Query--
SELECT '**** totals_mode = after_having_inclusive'
--Result--
[('**** totals_mode = after_having_inclusive',)]
+--------------------+
--Query--
SELECT '**** totals_mode = after_having_exclusive'
--Result--
[('**** totals_mode = after_having_exclusive',)]
+--------------------+
--Query--
SELECT '**** totals_mode = before_having'
--Result--
[('**** totals_mode = before_having',)]
+--------------------+
--Query--
SELECT '*** External aggregation.'
--Result--
[('*** External aggregation.',)]
+--------------------+
--Query--
SELECT '**** totals_mode = after_having_auto'
--Result--
[('**** totals_mode = after_having_auto',)]
+--------------------+
--Query--
SELECT '**** totals_mode = after_having_inclusive'
--Result--
[('**** totals_mode = after_having_inclusive',)]
+--------------------+
--Query--
SELECT '**** totals_mode = after_having_exclusive'
--Result--
[('**** totals_mode = after_having_exclusive',)]
+--------------------+
--Query--
SELECT '**** totals_mode = before_having'
--Result--
[('**** totals_mode = before_having',)]
+--------------------+
