--Query--
WITH toStartOfHour(ts) AS a SELECT sum(value) v FROM normal WHERE ts > '2021-12-06 22:00:00' GROUP BY a ORDER BY v LIMIT 5
--Result--
[(276078600,), (291519000,), (304558200,), (317518200,), (330478200,)]
+--------------------+
--Query--
WITH toStartOfHour(ts) AS a SELECT sum(value) v FROM normal WHERE ts > '2021-12-06 22:00:00' GROUP BY toStartOfHour(ts), a ORDER BY v LIMIT 5
--Result--
[(276078600,), (291519000,), (304558200,), (317518200,), (330478200,)]
+--------------------+
--Query--
WITH toStartOfHour(ts) AS a SELECT sum(value) v FROM agg WHERE ts > '2021-12-06 22:00:00' GROUP BY a ORDER BY v LIMIT 5
--Result--
[(276078600,), (291519000,), (304558200,), (317518200,), (330478200,)]
+--------------------+
