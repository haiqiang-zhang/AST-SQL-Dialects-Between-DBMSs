--Query--
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'today'
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow'
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'yesterday'
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow EST'
--Result--
[(1,)]
+--------------------+
--Query--
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow zulu'
--Result--
[(1,)]
+--------------------+
--Query--
SELECT pg_sleep(0.1)
--Result--
[('',)]
+--------------------+
--Query--
SELECT count(*) AS two FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp(2) with time zone 'now'
--Result--
[(2,)]
+--------------------+
--Query--
SELECT count(d1) AS three, count(DISTINCT d1) AS two FROM TIMESTAMPTZ_TBL
--Result--
[(3, 2)]
+--------------------+
--Query--
TRUNCATE TIMESTAMPTZ_TBL
--Result--
[]
+--------------------+
--Query--
SELECT timestamptz 'infinity' = timestamptz '+infinity' AS t
--Result--
[(True,)]
+--------------------+
--Query--
SELECT '19970210 173201' AT TIME ZONE 'America/New_York'
--Result--
[(datetime.datetime(1997, 2, 10, 11, 32, 1),)]
+--------------------+
--Query--
SELECT '19970710 173201' AT TIME ZONE 'America/New_York'
--Result--
[(datetime.datetime(1997, 7, 10, 11, 32, 1),)]
+--------------------+
--Query--
SELECT '20500710 173201 Europe/Helsinki'::timestamptz
--Result--
[(datetime.datetime(2050, 7, 10, 16, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),)]
+--------------------+
--Query--
SELECT '20500110 173201 Europe/Helsinki'::timestamptz
--Result--
[(datetime.datetime(2050, 1, 10, 16, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT pg_input_is_valid('now', 'timestamptz')
--Result--
[(True,)]
+--------------------+
--Query--
SELECT * FROM pg_input_error_info('garbage', 'timestamptz')
--Result--
[('invalid input syntax for type timestamp with time zone: "garbage"', None, None, '22007')]
+--------------------+
--Query--
SELECT 'Wed Jul 11 10:51:14 America/New_York 2001'::timestamptz
--Result--
[(datetime.datetime(2001, 7, 11, 16, 51, 14, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),)]
+--------------------+
--Query--
SELECT 'Wed Jul 11 10:51:14 GMT-4 2001'::timestamptz
--Result--
[(datetime.datetime(2001, 7, 11, 8, 51, 14, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),)]
+--------------------+
--Query--
SELECT 'Wed Jul 11 10:51:14 GMT+4 2001'::timestamptz
--Result--
[(datetime.datetime(2001, 7, 11, 16, 51, 14, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),)]
+--------------------+
--Query--
SELECT 'Wed Jul 11 10:51:14 PST-03:00 2001'::timestamptz
--Result--
[(datetime.datetime(2001, 7, 11, 9, 51, 14, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),)]
+--------------------+
--Query--
SELECT 'Wed Jul 11 10:51:14 PST+03:00 2001'::timestamptz
--Result--
[(datetime.datetime(2001, 7, 11, 15, 51, 14, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),)]
+--------------------+
--Query--
SELECT d1 FROM TIMESTAMPTZ_TBL    WHERE d1 > timestamp with time zone '1997-01-02'
--Result--
[(datetime.datetime(9999, 12, 31, 23, 59, 59, 999999, tzinfo=datetime.timezone.utc),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 2, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, 400000, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, 500000, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, 600000, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 1, 2, 3, 4, 5, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 6, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(2001, 9, 22, 18, 19, 20, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(2000, 3, 15, 17, 14, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 13, 14, 2, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 11, 14, 3, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 12, 14, 4, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 10, 14, 5, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 17, 32, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 18, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 18, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 18, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 23, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 7, 10, 23, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(1997, 6, 11, 3, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(1997, 2, 10, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 12, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 13, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 14, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 15, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 16, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 16, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2097, 2, 16, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 28, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 3, 1, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 12, 30, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 12, 31, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1999, 12, 31, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 1, 1, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 12, 31, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2001, 1, 1, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT d1 FROM TIMESTAMPTZ_TBL    WHERE d1 = timestamp with time zone '1997-01-02'
--Result--
[(datetime.datetime(1997, 1, 2, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT d1 FROM TIMESTAMPTZ_TBL    WHERE d1 >= timestamp with time zone '1997-01-02'
--Result--
[(datetime.datetime(9999, 12, 31, 23, 59, 59, 999999, tzinfo=datetime.timezone.utc),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 2, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, 400000, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, 500000, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, 600000, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 1, 2, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 1, 2, 3, 4, 5, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 6, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(2001, 9, 22, 18, 19, 20, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(2000, 3, 15, 17, 14, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 13, 14, 2, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 11, 14, 3, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 12, 14, 4, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 3, 15, 10, 14, 5, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 17, 32, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 2, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 18, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 18, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 18, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 10, 23, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 7, 10, 23, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(1997, 6, 11, 3, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200))),), (datetime.datetime(1997, 2, 10, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 11, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 12, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 13, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 14, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 15, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 16, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 16, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2097, 2, 16, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 2, 28, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 3, 1, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 12, 30, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1997, 12, 31, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(1999, 12, 31, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 1, 1, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2000, 12, 31, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2001, 1, 1, 17, 32, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT d1 - timestamp with time zone '1997-01-02' AS diff    FROM TIMESTAMPTZ_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01'
--Result--
[(datetime.timedelta(days=-9863, seconds=3600),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9122),), (datetime.timedelta(days=40, seconds=9121, microseconds=400000),), (datetime.timedelta(days=40, seconds=9121, microseconds=500000),), (datetime.timedelta(days=40, seconds=9121, microseconds=600000),), (datetime.timedelta(0),), (datetime.timedelta(seconds=11045),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=160, seconds=5521),), (datetime.timedelta(days=1724, seconds=62360),), (datetime.timedelta(days=1168, seconds=62041),), (datetime.timedelta(days=1168, seconds=47642),), (datetime.timedelta(days=1168, seconds=40443),), (datetime.timedelta(days=1168, seconds=44044),), (datetime.timedelta(days=1168, seconds=36845),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=39, seconds=63121),), (datetime.timedelta(days=39, seconds=63120),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=39, seconds=66721),), (datetime.timedelta(days=39, seconds=66721),), (datetime.timedelta(days=39, seconds=66721),), (datetime.timedelta(days=39, seconds=84721),), (datetime.timedelta(days=189, seconds=81121),), (datetime.timedelta(days=160, seconds=9121),), (datetime.timedelta(days=39, seconds=63121),), (datetime.timedelta(days=40, seconds=63121),), (datetime.timedelta(days=41, seconds=63121),), (datetime.timedelta(days=42, seconds=63121),), (datetime.timedelta(days=43, seconds=63121),), (datetime.timedelta(days=44, seconds=63121),), (datetime.timedelta(days=45, seconds=63121),), (datetime.timedelta(days=45, seconds=63121),), (datetime.timedelta(days=-309, seconds=63121),), (datetime.timedelta(days=-308, seconds=63121),), (datetime.timedelta(days=-307, seconds=63121),), (datetime.timedelta(days=-3, seconds=63121),), (datetime.timedelta(days=-2, seconds=63121),), (datetime.timedelta(days=-1, seconds=63121),), (datetime.timedelta(days=57, seconds=63121),), (datetime.timedelta(days=58, seconds=63121),), (datetime.timedelta(days=362, seconds=63121),), (datetime.timedelta(days=363, seconds=63121),), (datetime.timedelta(days=1093, seconds=63121),), (datetime.timedelta(days=1094, seconds=63121),), (datetime.timedelta(days=1459, seconds=63121),), (datetime.timedelta(days=1460, seconds=63121),)]
+--------------------+
--Query--
SELECT date_trunc( 'week', timestamp with time zone '2004-02-29 15:44:17.71393' ) AS week_trunc
--Result--
[(datetime.datetime(2004, 2, 23, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'Australia/Sydney') as sydney_trunc
--Result--
[(datetime.datetime(2001, 2, 16, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'GMT') as gmt_trunc
--Result--
[(datetime.datetime(2001, 2, 16, 1, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'VET') as vet_trunc
--Result--
[(datetime.datetime(2001, 2, 16, 5, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT   str,   interval,   date_trunc(str, ts, 'Australia/Sydney') = date_bin(interval::interval, ts, timestamp with time zone '2001-01-01+11') AS equal FROM (   VALUES   ('day', '1 d'),   ('hour', '1 h'),   ('minute', '1 m'),   ('second', '1 s'),   ('millisecond', '1 ms'),   ('microsecond', '1 us') ) intervals (str, interval), (VALUES (timestamptz '2020-02-29 15:44:17.71393+00')) ts (ts)
--Result--
[('day', '1 d', True), ('hour', '1 h', True), ('minute', '1 m', True), ('second', '1 s', True), ('millisecond', '1 ms', True), ('microsecond', '1 us', True)]
+--------------------+
--Query--
SELECT   interval,   ts,   origin,   date_bin(interval::interval, ts, origin) FROM (   VALUES   ('15 days'),   ('2 hours'),   ('1 hour 30 minutes'),   ('15 minutes'),   ('10 seconds'),   ('100 milliseconds'),   ('250 microseconds') ) intervals (interval), (VALUES (timestamptz '2020-02-11 15:44:17.71393')) ts (ts), (VALUES (timestamptz '2001-01-01')) origin (origin)
--Result--
[('15 days', datetime.datetime(2020, 2, 11, 15, 44, 17, 713930, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2001, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2020, 2, 6, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600)))), ('2 hours', datetime.datetime(2020, 2, 11, 15, 44, 17, 713930, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2001, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2020, 2, 11, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600)))), ('1 hour 30 minutes', datetime.datetime(2020, 2, 11, 15, 44, 17, 713930, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2001, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2020, 2, 11, 15, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600)))), ('15 minutes', datetime.datetime(2020, 2, 11, 15, 44, 17, 713930, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2001, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2020, 2, 11, 15, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600)))), ('10 seconds', datetime.datetime(2020, 2, 11, 15, 44, 17, 713930, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2001, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2020, 2, 11, 15, 44, 10, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600)))), ('100 milliseconds', datetime.datetime(2020, 2, 11, 15, 44, 17, 713930, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2001, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2020, 2, 11, 15, 44, 17, 700000, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600)))), ('250 microseconds', datetime.datetime(2020, 2, 11, 15, 44, 17, 713930, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2001, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))), datetime.datetime(2020, 2, 11, 15, 44, 17, 713750, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))))]
+--------------------+
--Query--
SELECT date_bin('5 min'::interval, timestamptz '2020-02-01 01:01:01+00', timestamptz '2020-02-01 00:02:30+00')
--Result--
[(datetime.datetime(2020, 2, 1, 1, 57, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT d1 - timestamp with time zone '1997-01-02' AS diff   FROM TIMESTAMPTZ_TBL   WHERE d1 BETWEEN timestamp with time zone '1902-01-01' AND timestamp with time zone '2038-01-01'
--Result--
[(datetime.timedelta(days=-9863, seconds=3600),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9122),), (datetime.timedelta(days=40, seconds=9121, microseconds=400000),), (datetime.timedelta(days=40, seconds=9121, microseconds=500000),), (datetime.timedelta(days=40, seconds=9121, microseconds=600000),), (datetime.timedelta(0),), (datetime.timedelta(seconds=11045),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=160, seconds=5521),), (datetime.timedelta(days=1724, seconds=62360),), (datetime.timedelta(days=1168, seconds=62041),), (datetime.timedelta(days=1168, seconds=47642),), (datetime.timedelta(days=1168, seconds=40443),), (datetime.timedelta(days=1168, seconds=44044),), (datetime.timedelta(days=1168, seconds=36845),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=39, seconds=63121),), (datetime.timedelta(days=39, seconds=63120),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=40, seconds=9121),), (datetime.timedelta(days=39, seconds=66721),), (datetime.timedelta(days=39, seconds=66721),), (datetime.timedelta(days=39, seconds=66721),), (datetime.timedelta(days=39, seconds=84721),), (datetime.timedelta(days=189, seconds=81121),), (datetime.timedelta(days=160, seconds=9121),), (datetime.timedelta(days=39, seconds=63121),), (datetime.timedelta(days=40, seconds=63121),), (datetime.timedelta(days=41, seconds=63121),), (datetime.timedelta(days=42, seconds=63121),), (datetime.timedelta(days=43, seconds=63121),), (datetime.timedelta(days=44, seconds=63121),), (datetime.timedelta(days=45, seconds=63121),), (datetime.timedelta(days=45, seconds=63121),), (datetime.timedelta(days=-309, seconds=63121),), (datetime.timedelta(days=-308, seconds=63121),), (datetime.timedelta(days=-307, seconds=63121),), (datetime.timedelta(days=-3, seconds=63121),), (datetime.timedelta(days=-2, seconds=63121),), (datetime.timedelta(days=-1, seconds=63121),), (datetime.timedelta(days=57, seconds=63121),), (datetime.timedelta(days=58, seconds=63121),), (datetime.timedelta(days=362, seconds=63121),), (datetime.timedelta(days=363, seconds=63121),), (datetime.timedelta(days=1093, seconds=63121),), (datetime.timedelta(days=1094, seconds=63121),), (datetime.timedelta(days=1459, seconds=63121),), (datetime.timedelta(days=1460, seconds=63121),)]
+--------------------+
--Query--
SELECT date_part('epoch', '294270-01-01 00:00:00+00'::timestamptz)
--Result--
[(9224097091200.0,)]
+--------------------+
--Query--
SELECT extract(epoch from '294270-01-01 00:00:00+00'::timestamptz)
--Result--
[(9224097091200.0,)]
+--------------------+
--Query--
SELECT timestamptz '294276-12-31 23:59:59 UTC' - timestamptz '1999-12-23 19:59:04.224193 UTC' AS ok
--Result--
[(datetime.timedelta(days=106751991, seconds=14454, microseconds=775807),)]
+--------------------+
--Query--
SELECT to_char(d1, 'DAY Day day DY Dy dy MONTH Month month RM MON Mon mon')    FROM TIMESTAMPTZ_TBL
--Result--
[(None,), (None,), ('THURSDAY  Thursday  thursday  THU Thu thu JANUARY   January   january   I    JAN Jan jan',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('THURSDAY  Thursday  thursday  THU Thu thu JANUARY   January   january   I    JAN Jan jan',), ('THURSDAY  Thursday  thursday  THU Thu thu JANUARY   January   january   I    JAN Jan jan',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('WEDNESDAY Wednesday wednesday WED Wed wed JUNE      June      june      VI   JUN Jun jun',), ('SATURDAY  Saturday  saturday  SAT Sat sat SEPTEMBER September september IX   SEP Sep sep',), ('WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar',), ('WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar',), ('WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar',), ('WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar',), ('WEDNESDAY Wednesday wednesday WED Wed wed MARCH     March     march     III  MAR Mar mar',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb',), ('MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb',), ('MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb',), ('MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb',), ('MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb',), ('THURSDAY  Thursday  thursday  THU Thu thu JULY      July      july      VII  JUL Jul jul',), ('WEDNESDAY Wednesday wednesday WED Wed wed JUNE      June      june      VI   JUN Jun jun',), ('MONDAY    Monday    monday    MON Mon mon FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('WEDNESDAY Wednesday wednesday WED Wed wed FEBRUARY  February  february  II   FEB Feb feb',), ('THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb',), ('FRIDAY    Friday    friday    FRI Fri fri FEBRUARY  February  february  II   FEB Feb feb',), ('SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb',), ('SUNDAY    Sunday    sunday    SUN Sun sun FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb',), ('THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb',), ('THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue FEBRUARY  February  february  II   FEB Feb feb',), ('SUNDAY    Sunday    sunday    SUN Sun sun FEBRUARY  February  february  II   FEB Feb feb',), ('SATURDAY  Saturday  saturday  SAT Sat sat FEBRUARY  February  february  II   FEB Feb feb',), ('WEDNESDAY Wednesday wednesday WED Wed wed FEBRUARY  February  february  II   FEB Feb feb',), ('THURSDAY  Thursday  thursday  THU Thu thu FEBRUARY  February  february  II   FEB Feb feb',), ('FRIDAY    Friday    friday    FRI Fri fri MARCH     March     march     III  MAR Mar mar',), ('MONDAY    Monday    monday    MON Mon mon DECEMBER  December  december  XII  DEC Dec dec',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue DECEMBER  December  december  XII  DEC Dec dec',), ('WEDNESDAY Wednesday wednesday WED Wed wed JANUARY   January   january   I    JAN Jan jan',), ('FRIDAY    Friday    friday    FRI Fri fri FEBRUARY  February  february  II   FEB Feb feb',), ('SATURDAY  Saturday  saturday  SAT Sat sat MARCH     March     march     III  MAR Mar mar',), ('TUESDAY   Tuesday   tuesday   TUE Tue tue DECEMBER  December  december  XII  DEC Dec dec',), ('WEDNESDAY Wednesday wednesday WED Wed wed DECEMBER  December  december  XII  DEC Dec dec',), ('FRIDAY    Friday    friday    FRI Fri fri DECEMBER  December  december  XII  DEC Dec dec',), ('SATURDAY  Saturday  saturday  SAT Sat sat JANUARY   January   january   I    JAN Jan jan',), ('SUNDAY    Sunday    sunday    SUN Sun sun DECEMBER  December  december  XII  DEC Dec dec',), ('MONDAY    Monday    monday    MON Mon mon JANUARY   January   january   I    JAN Jan jan',)]
+--------------------+
--Query--
SELECT to_char(d, 'FF1 FF2 FF3 FF4 FF5 FF6  ff1 ff2 ff3 ff4 ff5 ff6  MS US')    FROM (VALUES        ('2018-11-02 12:34:56'::timestamptz),        ('2018-11-02 12:34:56.78'),        ('2018-11-02 12:34:56.78901'),        ('2018-11-02 12:34:56.78901234')    ) d(d)
--Result--
[('0 00 000 0000 00000 000000  0 00 000 0000 00000 000000  000 000000',), ('7 78 780 7800 78000 780000  7 78 780 7800 78000 780000  780 780000',), ('7 78 789 7890 78901 789010  7 78 789 7890 78901 789010  789 789010',), ('7 78 789 7890 78901 789012  7 78 789 7890 78901 789012  789 789012',)]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('+00', '+00:00')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('-02', '-02:00')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('+13', '+13:00')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('+00:30', '+00:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('-00:30', '-00:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('+04:30', '+04:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('-04:30', '-04:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('+04:15', '+04:15')]
+--------------------+
--Query--
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
--Result--
[('-04:15', '-04:15')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "Of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('+00', '+00:00')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('-02', '-02:00')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('+13', '+13:00')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('+00:30', '+00:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('-00:30', '-00:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('+04:30', '+04:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('-04:30', '-04:30')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('+04:15', '+04:15')]
+--------------------+
--Query--
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
--Result--
[('-04:15', '-04:15')]
+--------------------+
--Query--
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33)
--Result--
[(datetime.datetime(1973, 7, 15, 8, 15, 55, 330000, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=72000))),)]
+--------------------+
--Query--
WITH tzs (tz) AS (VALUES     ('+1'), ('+1:'), ('+1:0'), ('+100'), ('+1:00'), ('+01:00'),     ('+10'), ('+1000'), ('+10:'), ('+10:0'), ('+10:00'), ('+10:00:'),     ('+10:00:1'), ('+10:00:01'),     ('+10:00:10'))      SELECT make_timestamptz(2010, 2, 27, 3, 45, 00, tz), tz FROM tzs
--Result--
[(datetime.datetime(2010, 2, 26, 21, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+1'), (datetime.datetime(2010, 2, 26, 21, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+1:'), (datetime.datetime(2010, 2, 26, 21, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+1:0'), (datetime.datetime(2010, 2, 26, 21, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+100'), (datetime.datetime(2010, 2, 26, 21, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+1:00'), (datetime.datetime(2010, 2, 26, 21, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+01:00'), (datetime.datetime(2010, 2, 26, 12, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10'), (datetime.datetime(2010, 2, 26, 12, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+1000'), (datetime.datetime(2010, 2, 26, 12, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10:'), (datetime.datetime(2010, 2, 26, 12, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10:0'), (datetime.datetime(2010, 2, 26, 12, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10:00'), (datetime.datetime(2010, 2, 26, 12, 45, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10:00:'), (datetime.datetime(2010, 2, 26, 12, 44, 59, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10:00:1'), (datetime.datetime(2010, 2, 26, 12, 44, 59, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10:00:01'), (datetime.datetime(2010, 2, 26, 12, 44, 50, tzinfo=datetime.timezone(datetime.timedelta(days=-1, seconds=68400))), '+10:00:10')]
+--------------------+
--Query--
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '+2') = '1973-07-15 08:15:55.33+02'::timestamptz
--Result--
[(True,)]
+--------------------+
--Query--
SELECT make_timestamptz(2014, 12, 10, 0, 0, 0, 'Europe/Prague') = timestamptz '2014-12-10 00:00:00 Europe/Prague'
--Result--
[(True,)]
+--------------------+
--Query--
select * from generate_series('2020-01-01 00:00'::timestamptz,                               '2020-01-02 03:00'::timestamptz,                               '1 hour'::interval)
--Result--
[(datetime.datetime(2020, 1, 1, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 1, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 2, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 3, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 4, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 5, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 6, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 7, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 8, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 9, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 10, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 11, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 12, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 13, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 15, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 16, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 17, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 18, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 19, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 20, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 21, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 22, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 1, 23, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 2, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 2, 1, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 2, 2, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),), (datetime.datetime(2020, 1, 2, 3, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT date_add('2022-10-30 00:00:00+01'::timestamptz,                 '1 day'::interval)
--Result--
[(datetime.datetime(2022, 10, 30, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT date_subtract('2022-10-30 00:00:00+01'::timestamptz,                      '1 day'::interval)
--Result--
[(datetime.datetime(2022, 10, 28, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 00:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 21, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:59:59 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:01 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:59:59 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 23, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:01 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 04:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 00:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 21, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:59:59 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:01 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:59:59 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:01 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 04:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 20, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:59:59 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 20, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:01 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 02:00:00 Europe/Moscow'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 20, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:59:59 MSK'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 20, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:01 MSK'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 02:00:00 MSK'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 25, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 00:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 21, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:59:59'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:01'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:59:59'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 23, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:01'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 04:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 00:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 21, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 01:59:59'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:00:01'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 22, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 02:59:59'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 03:00:01'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-27 04:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 25, 20, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:59:59'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 25, 20, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:01'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 02:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 25, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 25, 20, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 00:59:59'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 25, 20, 59, 59, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 01:00:01'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 25, 22, 0, 1, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2014-10-26 02:00:00'::timestamp AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 25, 23, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT to_timestamp(         0)
--Result--
[(datetime.datetime(1970, 1, 1, 0, 0, tzinfo=datetime.timezone.utc),)]
+--------------------+
--Query--
SELECT '2011-03-26 21:00:00 UTC'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=10800))),)]
+--------------------+
--Query--
SELECT '2011-03-26 22:00:00 UTC'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 1, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=10800))),)]
+--------------------+
--Query--
SELECT '2011-03-26 22:59:59 UTC'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 1, 59, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=10800))),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:00:00 UTC'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 3, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=14400))),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:00:01 UTC'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 3, 0, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=14400))),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:59:59 UTC'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 3, 59, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=14400))),)]
+--------------------+
--Query--
SELECT '2011-03-27 00:00:00 UTC'::timestamptz
--Result--
[(datetime.datetime(2011, 3, 27, 4, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=14400))),)]
+--------------------+
--Query--
SELECT '2014-10-25 21:00:00 UTC'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=14400))),)]
+--------------------+
--Query--
SELECT '2014-10-25 21:59:59 UTC'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 26, 1, 59, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=14400))),)]
+--------------------+
--Query--
SELECT '2014-10-25 22:00:00 UTC'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=10800))),)]
+--------------------+
--Query--
SELECT '2014-10-25 22:00:01 UTC'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0, 1, tzinfo=datetime.timezone(datetime.timedelta(seconds=10800))),)]
+--------------------+
--Query--
SELECT '2014-10-25 23:00:00 UTC'::timestamptz
--Result--
[(datetime.datetime(2014, 10, 26, 2, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=10800))),)]
+--------------------+
--Query--
SELECT '2011-03-26 21:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 0, 0),)]
+--------------------+
--Query--
SELECT '2011-03-26 22:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 1, 0),)]
+--------------------+
--Query--
SELECT '2011-03-26 22:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 1, 59, 59),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 3, 0),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:00:01 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 3, 0, 1),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 3, 59, 59),)]
+--------------------+
--Query--
SELECT '2011-03-27 00:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2011, 3, 27, 4, 0),)]
+--------------------+
--Query--
SELECT '2014-10-25 21:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0),)]
+--------------------+
--Query--
SELECT '2014-10-25 21:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 59, 59),)]
+--------------------+
--Query--
SELECT '2014-10-25 22:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0),)]
+--------------------+
--Query--
SELECT '2014-10-25 22:00:01 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0, 1),)]
+--------------------+
--Query--
SELECT '2014-10-25 23:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
--Result--
[(datetime.datetime(2014, 10, 26, 2, 0),)]
+--------------------+
--Query--
SELECT '2011-03-26 21:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 0, 0),)]
+--------------------+
--Query--
SELECT '2011-03-26 22:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 1, 0),)]
+--------------------+
--Query--
SELECT '2011-03-26 22:59:59 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 1, 59, 59),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 3, 0),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:00:01 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 3, 0, 1),)]
+--------------------+
--Query--
SELECT '2011-03-26 23:59:59 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 3, 59, 59),)]
+--------------------+
--Query--
SELECT '2011-03-27 00:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2011, 3, 27, 4, 0),)]
+--------------------+
--Query--
SELECT '2014-10-25 21:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0),)]
+--------------------+
--Query--
SELECT '2014-10-25 21:59:59 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 59, 59),)]
+--------------------+
--Query--
SELECT '2014-10-25 22:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0),)]
+--------------------+
--Query--
SELECT '2014-10-25 22:00:01 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 26, 1, 0, 1),)]
+--------------------+
--Query--
SELECT '2014-10-25 23:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
--Result--
[(datetime.datetime(2014, 10, 26, 2, 0),)]
+--------------------+
--Query--
explain (costs off) select * from tmptz where f1 at time zone 'utc' = '2017-01-18 00:00'
--Result--
[('Seq Scan on tmptz',), ("  Filter: ((f1 AT TIME ZONE 'utc'::text) = '2017-01-18 00:00:00'::timestamp without time zone)",)]
+--------------------+
--Query--
select * from tmptz where f1 at time zone 'utc' = '2017-01-18 00:00'
--Result--
[(datetime.datetime(2017, 1, 18, 1, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=3600))),)]
+--------------------+
--Query--
SELECT age(timestamptz 'infinity')
--Result--
[(datetime.timedelta(days=-106672205, seconds=68345, microseconds=224193),)]
+--------------------+
