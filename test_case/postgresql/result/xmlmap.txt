--Query--
SELECT table_to_xml('testxmlschema.test1', false, false, '')
--Result--
[('<test1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n\n<row>\n  <a>1</a>\n  <b>one</b>\n</row>\n\n<row>\n  <a>2</a>\n  <b>two</b>\n</row>\n\n<row>\n  <a>-1</a>\n</row>\n\n</test1>\n',)]
+--------------------+
--Query--
SELECT table_to_xmlschema('testxmlschema.test1', false, false, '')
--Result--
[('<xsd:schema\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema">\n\n<xsd:simpleType name="INTEGER">\n  <xsd:restriction base="xsd:int">\n    <xsd:maxInclusive value="2147483647"/>\n    <xsd:minInclusive value="-2147483648"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.text">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType name="RowType.test_db.testxmlschema.test1">\n  <xsd:sequence>\n    <xsd:element name="a" type="INTEGER" minOccurs="0"></xsd:element>\n    <xsd:element name="b" type="UDT.test_db.pg_catalog.text" minOccurs="0"></xsd:element>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:complexType name="TableType.test_db.testxmlschema.test1">\n  <xsd:sequence>\n    <xsd:element name="row" type="RowType.test_db.testxmlschema.test1" minOccurs="0" maxOccurs="unbounded"/>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:element name="test1" type="TableType.test_db.testxmlschema.test1"/>\n\n</xsd:schema>',)]
+--------------------+
--Query--
SELECT table_to_xml_and_xmlschema('testxmlschema.test1', false, false, '')
--Result--
[('<test1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="#">\n\n<xsd:schema\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema">\n\n<xsd:simpleType name="INTEGER">\n  <xsd:restriction base="xsd:int">\n    <xsd:maxInclusive value="2147483647"/>\n    <xsd:minInclusive value="-2147483648"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.text">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType name="RowType.test_db.testxmlschema.test1">\n  <xsd:sequence>\n    <xsd:element name="a" type="INTEGER" minOccurs="0"></xsd:element>\n    <xsd:element name="b" type="UDT.test_db.pg_catalog.text" minOccurs="0"></xsd:element>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:complexType name="TableType.test_db.testxmlschema.test1">\n  <xsd:sequence>\n    <xsd:element name="row" type="RowType.test_db.testxmlschema.test1" minOccurs="0" maxOccurs="unbounded"/>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:element name="test1" type="TableType.test_db.testxmlschema.test1"/>\n\n</xsd:schema>\n\n<row>\n  <a>1</a>\n  <b>one</b>\n</row>\n\n<row>\n  <a>2</a>\n  <b>two</b>\n</row>\n\n<row>\n  <a>-1</a>\n</row>\n\n</test1>\n',)]
+--------------------+
--Query--
SELECT query_to_xml('SELECT * FROM testxmlschema.test1', false, false, '')
--Result--
[('<table xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n\n<row>\n  <a>1</a>\n  <b>one</b>\n</row>\n\n<row>\n  <a>2</a>\n  <b>two</b>\n</row>\n\n<row>\n  <a>-1</a>\n</row>\n\n</table>\n',)]
+--------------------+
--Query--
SELECT query_to_xmlschema('SELECT * FROM testxmlschema.test1', false, false, '')
--Result--
[('<xsd:schema\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema">\n\n<xsd:simpleType name="INTEGER">\n  <xsd:restriction base="xsd:int">\n    <xsd:maxInclusive value="2147483647"/>\n    <xsd:minInclusive value="-2147483648"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.text">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType name="RowType">\n  <xsd:sequence>\n    <xsd:element name="a" type="INTEGER" minOccurs="0"></xsd:element>\n    <xsd:element name="b" type="UDT.test_db.pg_catalog.text" minOccurs="0"></xsd:element>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:complexType name="TableType">\n  <xsd:sequence>\n    <xsd:element name="row" type="RowType" minOccurs="0" maxOccurs="unbounded"/>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:element name="table" type="TableType"/>\n\n</xsd:schema>',)]
+--------------------+
--Query--
SELECT query_to_xml_and_xmlschema('SELECT * FROM testxmlschema.test1', true, true, '')
--Result--
[('<xsd:schema\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema">\n\n<xsd:simpleType name="INTEGER">\n  <xsd:restriction base="xsd:int">\n    <xsd:maxInclusive value="2147483647"/>\n    <xsd:minInclusive value="-2147483648"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.text">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType name="RowType">\n  <xsd:sequence>\n    <xsd:element name="a" type="INTEGER" nillable="true"></xsd:element>\n    <xsd:element name="b" type="UDT.test_db.pg_catalog.text" nillable="true"></xsd:element>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:element name="row" type="RowType"/>\n\n</xsd:schema>\n\n<row xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n  <a>1</a>\n  <b>one</b>\n</row>\n\n<row xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n  <a>2</a>\n  <b>two</b>\n</row>\n\n<row xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n  <a>-1</a>\n  <b xsi:nil="true"/>\n</row>\n\n',)]
+--------------------+
--Query--
DECLARE xc CURSOR WITH HOLD FOR SELECT * FROM testxmlschema.test1 ORDER BY 1, 2
--Result--
[]
+--------------------+
--Query--
SELECT cursor_to_xml('xc'::refcursor, 5, false, true, '')
--Result--
[('<row xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n  <a>-1</a>\n</row>\n\n<row xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n  <a>1</a>\n  <b>one</b>\n</row>\n\n<row xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n  <a>2</a>\n  <b>two</b>\n</row>\n\n',)]
+--------------------+
--Query--
SELECT cursor_to_xmlschema('xc'::refcursor, false, true, '')
--Result--
[('<xsd:schema\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema">\n\n<xsd:simpleType name="INTEGER">\n  <xsd:restriction base="xsd:int">\n    <xsd:maxInclusive value="2147483647"/>\n    <xsd:minInclusive value="-2147483648"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.text">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType name="RowType">\n  <xsd:sequence>\n    <xsd:element name="a" type="INTEGER" minOccurs="0"></xsd:element>\n    <xsd:element name="b" type="UDT.test_db.pg_catalog.text" minOccurs="0"></xsd:element>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:element name="row" type="RowType"/>\n\n</xsd:schema>',)]
+--------------------+
--Query--
MOVE BACKWARD ALL IN xc
--Result--
[]
+--------------------+
--Query--
SELECT schema_to_xml('testxmlschema', false, true, '')
--Result--
[('<testxmlschema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n\n<test1>\n  <a>1</a>\n  <b>one</b>\n</test1>\n\n<test1>\n  <a>2</a>\n  <b>two</b>\n</test1>\n\n<test1>\n  <a>-1</a>\n</test1>\n\n\n<test2>\n  <z>55</z>\n  <y>abc</y>\n  <x>def   </x>\n  <w>98.60</w>\n  <v>2</v>\n  <u>999</u>\n  <t>0</t>\n  <s>21:07:00</s>\n  <stz>21:11:00+05</stz>\n  <r>2009-06-08T21:07:30</r>\n  <rtz>2009-06-09T06:07:30+02:00</rtz>\n  <q>2009-06-08</q>\n  <o>ABC</o>\n  <n>true</n>\n  <m>WFla</m>\n</test2>\n\n\n</testxmlschema>\n',)]
+--------------------+
--Query--
SELECT schema_to_xmlschema('testxmlschema', false, true, '')
--Result--
[('<xsd:schema\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema">\n\n<xsd:simpleType name="INTEGER">\n  <xsd:restriction base="xsd:int">\n    <xsd:maxInclusive value="2147483647"/>\n    <xsd:minInclusive value="-2147483648"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.text">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="VARCHAR">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="CHAR">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="NUMERIC">\n</xsd:simpleType>\n\n<xsd:simpleType name="SMALLINT">\n  <xsd:restriction base="xsd:short">\n    <xsd:maxInclusive value="32767"/>\n    <xsd:minInclusive value="-32768"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="BIGINT">\n  <xsd:restriction base="xsd:long">\n    <xsd:maxInclusive value="9223372036854775807"/>\n    <xsd:minInclusive value="-9223372036854775808"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="REAL">\n  <xsd:restriction base="xsd:float"></xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIME">\n  <xsd:restriction base="xsd:time">\n    <xsd:pattern value="\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIME_WTZ">\n  <xsd:restriction base="xsd:time">\n    <xsd:pattern value="\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?(\\+|-)\\p{Nd}{2}:\\p{Nd}{2}"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIMESTAMP">\n  <xsd:restriction base="xsd:dateTime">\n    <xsd:pattern value="\\p{Nd}{4}-\\p{Nd}{2}-\\p{Nd}{2}T\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIMESTAMP_WTZ">\n  <xsd:restriction base="xsd:dateTime">\n    <xsd:pattern value="\\p{Nd}{4}-\\p{Nd}{2}-\\p{Nd}{2}T\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?(\\+|-)\\p{Nd}{2}:\\p{Nd}{2}"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="DATE">\n  <xsd:restriction base="xsd:date">\n    <xsd:pattern value="\\p{Nd}{4}-\\p{Nd}{2}-\\p{Nd}{2}"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType mixed="true">\n  <xsd:sequence>\n    <xsd:any name="element" minOccurs="0" maxOccurs="unbounded" processContents="skip"/>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:simpleType name="Domain.test_db.public.testxmldomain">\n  <xsd:restriction base="VARCHAR"/>\n</xsd:simpleType>\n\n<xsd:simpleType name="BOOLEAN">\n  <xsd:restriction base="xsd:boolean"></xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.bytea">\n  <xsd:restriction base="xsd:base64Binary">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType name="SchemaType.test_db.testxmlschema">\n  <xsd:sequence>\n    <xsd:element name="test1" type="RowType.test_db.testxmlschema.test1" minOccurs="0" maxOccurs="unbounded"/>\n    <xsd:element name="test2" type="RowType.test_db.testxmlschema.test2" minOccurs="0" maxOccurs="unbounded"/>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:element name="testxmlschema" type="SchemaType.test_db.testxmlschema"/>\n\n</xsd:schema>',)]
+--------------------+
--Query--
SELECT schema_to_xml_and_xmlschema('testxmlschema', true, true, 'foo')
--Result--
[('<testxmlschema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="foo" xsi:schemaLocation="foo #">\n\n<xsd:schema\n    xmlns:xsd="http://www.w3.org/2001/XMLSchema"\n    targetNamespace="foo"\n    elementFormDefault="qualified">\n\n<xsd:simpleType name="INTEGER">\n  <xsd:restriction base="xsd:int">\n    <xsd:maxInclusive value="2147483647"/>\n    <xsd:minInclusive value="-2147483648"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.text">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="VARCHAR">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="CHAR">\n  <xsd:restriction base="xsd:string">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="NUMERIC">\n</xsd:simpleType>\n\n<xsd:simpleType name="SMALLINT">\n  <xsd:restriction base="xsd:short">\n    <xsd:maxInclusive value="32767"/>\n    <xsd:minInclusive value="-32768"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="BIGINT">\n  <xsd:restriction base="xsd:long">\n    <xsd:maxInclusive value="9223372036854775807"/>\n    <xsd:minInclusive value="-9223372036854775808"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="REAL">\n  <xsd:restriction base="xsd:float"></xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIME">\n  <xsd:restriction base="xsd:time">\n    <xsd:pattern value="\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIME_WTZ">\n  <xsd:restriction base="xsd:time">\n    <xsd:pattern value="\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?(\\+|-)\\p{Nd}{2}:\\p{Nd}{2}"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIMESTAMP">\n  <xsd:restriction base="xsd:dateTime">\n    <xsd:pattern value="\\p{Nd}{4}-\\p{Nd}{2}-\\p{Nd}{2}T\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="TIMESTAMP_WTZ">\n  <xsd:restriction base="xsd:dateTime">\n    <xsd:pattern value="\\p{Nd}{4}-\\p{Nd}{2}-\\p{Nd}{2}T\\p{Nd}{2}:\\p{Nd}{2}:\\p{Nd}{2}(.\\p{Nd}+)?(\\+|-)\\p{Nd}{2}:\\p{Nd}{2}"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="DATE">\n  <xsd:restriction base="xsd:date">\n    <xsd:pattern value="\\p{Nd}{4}-\\p{Nd}{2}-\\p{Nd}{2}"/>\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType mixed="true">\n  <xsd:sequence>\n    <xsd:any name="element" minOccurs="0" maxOccurs="unbounded" processContents="skip"/>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:simpleType name="Domain.test_db.public.testxmldomain">\n  <xsd:restriction base="VARCHAR"/>\n</xsd:simpleType>\n\n<xsd:simpleType name="BOOLEAN">\n  <xsd:restriction base="xsd:boolean"></xsd:restriction>\n</xsd:simpleType>\n\n<xsd:simpleType name="UDT.test_db.pg_catalog.bytea">\n  <xsd:restriction base="xsd:base64Binary">\n  </xsd:restriction>\n</xsd:simpleType>\n\n<xsd:complexType name="SchemaType.test_db.testxmlschema">\n  <xsd:sequence>\n    <xsd:element name="test1" type="RowType.test_db.testxmlschema.test1" minOccurs="0" maxOccurs="unbounded"/>\n    <xsd:element name="test2" type="RowType.test_db.testxmlschema.test2" minOccurs="0" maxOccurs="unbounded"/>\n  </xsd:sequence>\n</xsd:complexType>\n\n<xsd:element name="testxmlschema" type="SchemaType.test_db.testxmlschema"/>\n\n</xsd:schema>\n\n<test1>\n  <a>1</a>\n  <b>one</b>\n</test1>\n\n<test1>\n  <a>2</a>\n  <b>two</b>\n</test1>\n\n<test1>\n  <a>-1</a>\n  <b xsi:nil="true"/>\n</test1>\n\n\n<test2>\n  <z>55</z>\n  <y>abc</y>\n  <x>def   </x>\n  <w>98.60</w>\n  <v>2</v>\n  <u>999</u>\n  <t>0</t>\n  <s>21:07:00</s>\n  <stz>21:11:00+05</stz>\n  <r>2009-06-08T21:07:30</r>\n  <rtz>2009-06-09T06:07:30+02:00</rtz>\n  <q>2009-06-08</q>\n  <p xsi:nil="true"/>\n  <o>ABC</o>\n  <n>true</n>\n  <m>WFla</m>\n</test2>\n\n\n</testxmlschema>\n',)]
+--------------------+
--Query--
SELECT xmlforest(c1, c2, c3, c4) FROM testxmlschema.test3
--Result--
[('<c1>true</c1><c2>true</c2><c3>2013-02-21</c3><c4>2013-02-21</c4>',)]
+--------------------+
