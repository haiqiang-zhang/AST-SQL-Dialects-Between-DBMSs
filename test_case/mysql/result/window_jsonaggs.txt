--Query--
SELECT j, i, f, JSON_ARRAYAGG(i) OVER w jarray_i, JSON_ARRAYAGG(f)   OVER w jarray_f FROM t1 WINDOW w AS (ORDER BY j)
--Result--
[('0', 13, 1.1, '[13]', '[1.1]'), ('1', 8, 99.3, '[13, 8]', '[1.1, 99.3]'), ('6', 9, 32.4, '[13, 8, 9]', '[1.1, 99.3, 32.4]'), ('10', 1, 3.4, '[13, 8, 9, 1, 10]', '[1.1, 99.3, 32.4, 3.4, 3.4]'), ('10', 10, 3.4, '[13, 8, 9, 1, 10]', '[1.1, 99.3, 32.4, 3.4, 3.4]'), ('13', 4, 8.9, '[13, 8, 9, 1, 10, 4]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9]'), ('20', 3, 6.5, '[13, 8, 9, 1, 10, 4, 3]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5]'), ('21', 8, 1.2, '[13, 8, 9, 1, 10, 4, 3, 8]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2]'), ('23', 5, None, '[13, 8, 9, 1, 10, 4, 3, 8, 5]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null]'), ('28', 15, 0.9, '[13, 8, 9, 1, 10, 4, 3, 8, 5, 15]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null, 0.9]'), ('29', 2, 2.3, '[13, 8, 9, 1, 10, 4, 3, 8, 5, 15, 2]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null, 0.9, 2.3]'), ('30', 2, 2.3, '[13, 8, 9, 1, 10, 4, 3, 8, 5, 15, 2, 2]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null, 0.9, 2.3, 2.3]'), ('32', None, 3.4, '[13, 8, 9, 1, 10, 4, 3, 8, 5, 15, 2, 2, null]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null, 0.9, 2.3, 2.3, 3.4]'), ('39', None, 0.0, '[13, 8, 9, 1, 10, 4, 3, 8, 5, 15, 2, 2, null, null]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null, 0.9, 2.3, 2.3, 3.4, 0.0]'), ('43', 11, 21.0, '[13, 8, 9, 1, 10, 4, 3, 8, 5, 15, 2, 2, null, null, 11]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null, 0.9, 2.3, 2.3, 3.4, 0.0, 21.0]'), ('100', 4, None, '[13, 8, 9, 1, 10, 4, 3, 8, 5, 15, 2, 2, null, null, 11, 4]', '[1.1, 99.3, 32.4, 3.4, 3.4, 8.9, 6.5, 1.2, null, 0.9, 2.3, 2.3, 3.4, 0.0, 21.0, null]')]
+--------------------+
--Query--
SELECT j, s, JSON_ARRAYAGG(s) OVER w jarray_s, JSON_ARRAYAGG(j)   OVER w jarray_j FROM t1 WINDOW w AS (ORDER BY j)
--Result--
[('0', None, '[null]', '[0]'), ('1', '24324', '[null, "24324"]', '[0, 1]'), ('6', 'poipo', '[null, "24324", "poipo"]', '[0, 1, 6]'), ('10', 'efghi', '[null, "24324", "poipo", "efghi", "fsfd"]', '[0, 1, 6, 10, 10]'), ('10', 'fsfd', '[null, "24324", "poipo", "efghi", "fsfd"]', '[0, 1, 6, 10, 10]'), ('13', 'ffhfg', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg"]', '[0, 1, 6, 10, 10, 13]'), ('20', 'efghi', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi"]', '[0, 1, 6, 10, 10, 13, 20]'), ('21', 'efghi', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi"]', '[0, 1, 6, 10, 10, 13, 20, 21]'), ('23', 'dfgdf', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23]'), ('28', 'dkfhk', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28]'), ('29', None, '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29]'), ('30', 'sdfsd', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30]'), ('32', 'wqweq', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32]'), ('39', 'zxczcx', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39]'), ('43', 'uwrteu', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx", "uwrteu"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39, 43]'), ('100', None, '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx", "uwrteu", null]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39, 43, 100]')]
+--------------------+
--Query--
SELECT i, JSON_ARRAYAGG(i) OVER() FROM t1
--Result--
[(1, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (2, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (3, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (5, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (None, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (4, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (8, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (10, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (2, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (4, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (8, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (9, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (None, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (11, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (15, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]'), (13, '[1, 2, 3, 5, null, 4, 8, 10, 2, 4, 8, 9, null, 11, 15, 13]')]
+--------------------+
--Query--
SELECT s, j, JSON_ARRAYAGG(s) OVER w jarray_s, JSON_ARRAYAGG(j)   OVER w jarray_j FROM t1 WINDOW w AS (ORDER BY j) ORDER BY j DESC
--Result--
[(None, '100', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx", "uwrteu", null]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39, 43, 100]'), ('uwrteu', '43', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx", "uwrteu"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39, 43]'), ('zxczcx', '39', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39]'), ('wqweq', '32', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32]'), ('sdfsd', '30', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30]'), (None, '29', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29]'), ('dkfhk', '28', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28]'), ('dfgdf', '23', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23]'), ('efghi', '21', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi"]', '[0, 1, 6, 10, 10, 13, 20, 21]'), ('efghi', '20', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi"]', '[0, 1, 6, 10, 10, 13, 20]'), ('ffhfg', '13', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg"]', '[0, 1, 6, 10, 10, 13]'), ('efghi', '10', '[null, "24324", "poipo", "efghi", "fsfd"]', '[0, 1, 6, 10, 10]'), ('fsfd', '10', '[null, "24324", "poipo", "efghi", "fsfd"]', '[0, 1, 6, 10, 10]'), ('poipo', '6', '[null, "24324", "poipo"]', '[0, 1, 6]'), ('24324', '1', '[null, "24324"]', '[0, 1]'), (None, '0', '[null]', '[0]')]
+--------------------+
--Query--
SELECT j, i, f, JSON_ARRAYAGG(i) OVER w jarray_i, JSON_ARRAYAGG(f)   OVER w jarray_f FROM t1 WINDOW w AS (ORDER BY j DESC)
--Result--
[('100', 4, None, '[4]', '[null]'), ('43', 11, 21.0, '[4, 11]', '[null, 21.0]'), ('39', None, 0.0, '[4, 11, null]', '[null, 21.0, 0.0]'), ('32', None, 3.4, '[4, 11, null, null]', '[null, 21.0, 0.0, 3.4]'), ('30', 2, 2.3, '[4, 11, null, null, 2]', '[null, 21.0, 0.0, 3.4, 2.3]'), ('29', 2, 2.3, '[4, 11, null, null, 2, 2]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3]'), ('28', 15, 0.9, '[4, 11, null, null, 2, 2, 15]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9]'), ('23', 5, None, '[4, 11, null, null, 2, 2, 15, 5]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null]'), ('21', 8, 1.2, '[4, 11, null, null, 2, 2, 15, 5, 8]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2]'), ('20', 3, 6.5, '[4, 11, null, null, 2, 2, 15, 5, 8, 3]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2, 6.5]'), ('13', 4, 8.9, '[4, 11, null, null, 2, 2, 15, 5, 8, 3, 4]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2, 6.5, 8.9]'), ('10', 1, 3.4, '[4, 11, null, null, 2, 2, 15, 5, 8, 3, 4, 1, 10]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2, 6.5, 8.9, 3.4, 3.4]'), ('10', 10, 3.4, '[4, 11, null, null, 2, 2, 15, 5, 8, 3, 4, 1, 10]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2, 6.5, 8.9, 3.4, 3.4]'), ('6', 9, 32.4, '[4, 11, null, null, 2, 2, 15, 5, 8, 3, 4, 1, 10, 9]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2, 6.5, 8.9, 3.4, 3.4, 32.4]'), ('1', 8, 99.3, '[4, 11, null, null, 2, 2, 15, 5, 8, 3, 4, 1, 10, 9, 8]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2, 6.5, 8.9, 3.4, 3.4, 32.4, 99.3]'), ('0', 13, 1.1, '[4, 11, null, null, 2, 2, 15, 5, 8, 3, 4, 1, 10, 9, 8, 13]', '[null, 21.0, 0.0, 3.4, 2.3, 2.3, 0.9, null, 1.2, 6.5, 8.9, 3.4, 3.4, 32.4, 99.3, 1.1]')]
+--------------------+
--Query--
SELECT * FROM v
--Result--
[(15, '28', '[28]'), (13, '0', '[28, 0]'), (11, '43', '[28, 0, 43]'), (10, '10', '[28, 0, 43, 10]'), (9, '6', '[28, 0, 43, 10, 6]'), (8, '21', '[28, 0, 43, 10, 6, 21]'), (8, '1', '[28, 0, 43, 10, 6, 21, 1]'), (5, '23', '[28, 0, 43, 10, 6, 21, 1, 23]'), (4, '13', '[28, 0, 43, 10, 6, 21, 1, 23, 13]'), (4, '100', '[28, 0, 43, 10, 6, 21, 1, 23, 13, 100]'), (3, '20', '[28, 0, 43, 10, 6, 21, 1, 23, 13, 100, 20]'), (2, '30', '[28, 0, 43, 10, 6, 21, 1, 23, 13, 100, 20, 30]'), (2, '29', '[28, 0, 43, 10, 6, 21, 1, 23, 13, 100, 20, 30, 29]'), (1, '10', '[28, 0, 43, 10, 6, 21, 1, 23, 13, 100, 20, 30, 29, 10]'), (None, '32', '[28, 0, 43, 10, 6, 21, 1, 23, 13, 100, 20, 30, 29, 10, 32]'), (None, '39', '[28, 0, 43, 10, 6, 21, 1, 23, 13, 100, 20, 30, 29, 10, 32, 39]')]
+--------------------+
--Query--
SELECT s, j, JSON_ARRAYAGG(s) OVER w jarray_s, JSON_ARRAYAGG(j)   OVER w jarray_j FROM t1 GROUP BY s,j WINDOW w AS (ORDER BY j)
--Result--
[(None, '0', '[null]', '[0]'), ('24324', '1', '[null, "24324"]', '[0, 1]'), ('poipo', '6', '[null, "24324", "poipo"]', '[0, 1, 6]'), ('efghi', '10', '[null, "24324", "poipo", "efghi", "fsfd"]', '[0, 1, 6, 10, 10]'), ('fsfd', '10', '[null, "24324", "poipo", "efghi", "fsfd"]', '[0, 1, 6, 10, 10]'), ('ffhfg', '13', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg"]', '[0, 1, 6, 10, 10, 13]'), ('efghi', '20', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi"]', '[0, 1, 6, 10, 10, 13, 20]'), ('efghi', '21', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi"]', '[0, 1, 6, 10, 10, 13, 20, 21]'), ('dfgdf', '23', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23]'), ('dkfhk', '28', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28]'), (None, '29', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29]'), ('sdfsd', '30', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30]'), ('wqweq', '32', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32]'), ('zxczcx', '39', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39]'), ('uwrteu', '43', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx", "uwrteu"]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39, 43]'), (None, '100', '[null, "24324", "poipo", "efghi", "fsfd", "ffhfg", "efghi", "efghi", "dfgdf", "dkfhk", null, "sdfsd", "wqweq", "zxczcx", "uwrteu", null]', '[0, 1, 6, 10, 10, 13, 20, 21, 23, 28, 29, 30, 32, 39, 43, 100]')]
+--------------------+
--Query--
SELECT i, f, JSON_ARRAYAGG(i) OVER w jarray_i, JSON_ARRAYAGG(f)   OVER w jarray_f FROM t1 GROUP BY i,f WITH ROLLUP HAVING GROUPING(f)=1   WINDOW w AS (ORDER BY f)
--Result--
[(None, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (1, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (2, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (3, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (4, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (5, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (8, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (9, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (10, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (11, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (13, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (15, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]'), (None, None, '[null, 1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 15, null]', '[null, null, null, null, null, null, null, null, null, null, null, null, null]')]
+--------------------+
--Query--
SELECT i, f, RANK() OVER w rank1, NTH_VALUE(i,3)   OVER w nth, LEAD(f, 2) OVER w lead1, LAG(f,2) OVER w lag1, JSON_ARRAYAGG(i)   OVER w jarray_i FROM t1 WINDOW w AS (ORDER BY f)
--Result--
[(5, None, 1, None, 0.0, None, '[5, 4]'), (4, None, 1, None, 0.9, None, '[5, 4]'), (None, 0.0, 3, None, 1.1, None, '[5, 4, null]'), (15, 0.9, 4, None, 1.2, None, '[5, 4, null, 15]'), (13, 1.1, 5, None, 2.3, 0.0, '[5, 4, null, 15, 13]'), (8, 1.2, 6, None, 2.3, 0.9, '[5, 4, null, 15, 13, 8]'), (2, 2.3, 7, None, 3.4, 1.1, '[5, 4, null, 15, 13, 8, 2, 2]'), (2, 2.3, 7, None, 3.4, 1.2, '[5, 4, null, 15, 13, 8, 2, 2]'), (1, 3.4, 9, None, 3.4, 2.3, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10]'), (None, 3.4, 9, None, 6.5, 2.3, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10]'), (10, 3.4, 9, None, 8.9, 3.4, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10]'), (3, 6.5, 12, None, 21.0, 3.4, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10, 3]'), (4, 8.9, 13, None, 32.4, 3.4, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10, 3, 4]'), (11, 21.0, 14, None, 99.3, 6.5, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10, 3, 4, 11]'), (9, 32.4, 15, None, None, 8.9, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10, 3, 4, 11, 9]'), (8, 99.3, 16, None, None, 21.0, '[5, 4, null, 15, 13, 8, 2, 2, 1, null, 10, 3, 4, 11, 9, 8]')]
+--------------------+
--Query--
SELECT i, PERCENT_RANK() OVER (ORDER BY f) p_rank, JSON_ARRAYAGG(j)   OVER (ORDER BY i,j ROWS UNBOUNDED PRECEDING) jarray_j FROM t1
--Result--
[(None, 0.5333333333333333, '[32]'), (None, 0.13333333333333333, '[32, 39]'), (1, 0.5333333333333333, '[32, 39, 10]'), (2, 0.4, '[32, 39, 10, 29]'), (2, 0.4, '[32, 39, 10, 29, 30]'), (3, 0.7333333333333333, '[32, 39, 10, 29, 30, 20]'), (4, 0.8, '[32, 39, 10, 29, 30, 20, 13]'), (4, 0.0, '[32, 39, 10, 29, 30, 20, 13, 100]'), (5, 0.0, '[32, 39, 10, 29, 30, 20, 13, 100, 23]'), (8, 1.0, '[32, 39, 10, 29, 30, 20, 13, 100, 23, 1]'), (8, 0.3333333333333333, '[32, 39, 10, 29, 30, 20, 13, 100, 23, 1, 21]'), (9, 0.9333333333333333, '[32, 39, 10, 29, 30, 20, 13, 100, 23, 1, 21, 6]'), (10, 0.5333333333333333, '[32, 39, 10, 29, 30, 20, 13, 100, 23, 1, 21, 6, 10]'), (11, 0.8666666666666667, '[32, 39, 10, 29, 30, 20, 13, 100, 23, 1, 21, 6, 10, 43]'), (13, 0.26666666666666666, '[32, 39, 10, 29, 30, 20, 13, 100, 23, 1, 21, 6, 10, 43, 0]'), (15, 0.2, '[32, 39, 10, 29, 30, 20, 13, 100, 23, 1, 21, 6, 10, 43, 0, 28]')]
+--------------------+
--Query--
SELECT i, f, MIN(i) OVER w min, JSON_ARRAYAGG(i) OVER w jarray_i FROM t1        WINDOW w AS (PARTITION BY f)
--Result--
[(5, None, 4, '[5, 4]'), (4, None, 4, '[5, 4]'), (None, 0.0, None, '[null]'), (15, 0.9, 15, '[15]'), (13, 1.1, 13, '[13]'), (8, 1.2, 8, '[8]'), (2, 2.3, 2, '[2, 2]'), (2, 2.3, 2, '[2, 2]'), (1, 3.4, 1, '[1, null, 10]'), (None, 3.4, 1, '[1, null, 10]'), (10, 3.4, 1, '[1, null, 10]'), (3, 6.5, 3, '[3]'), (4, 8.9, 4, '[4]'), (11, 21.0, 11, '[11]'), (9, 32.4, 9, '[9]'), (8, 99.3, 8, '[8]')]
+--------------------+
--Query--
SELECT i, f, MAX(i) OVER w max, JSON_ARRAYAGG(i) OVER w jarray_i FROM t1        WINDOW w AS (PARTITION BY i ROWS UNBOUNDED PRECEDING)
--Result--
[(None, 3.4, None, '[null]'), (None, 0.0, None, '[null, null]'), (1, 3.4, 1, '[1]'), (2, 2.3, 2, '[2]'), (2, 2.3, 2, '[2, 2]'), (3, 6.5, 3, '[3]'), (4, 8.9, 4, '[4]'), (4, None, 4, '[4, 4]'), (5, None, 5, '[5]'), (8, 1.2, 8, '[8]'), (8, 99.3, 8, '[8, 8]'), (9, 32.4, 9, '[9]'), (10, 3.4, 10, '[10]'), (11, 21.0, 11, '[11]'), (13, 1.1, 13, '[13]'), (15, 0.9, 15, '[15]')]
+--------------------+
--Query--
SELECT i, j, f, RANK() OVER w rank1, JSON_ARRAYAGG(i)   OVER w jarray_i FROM t1 WINDOW w AS (PARTITION BY i ORDER BY j ROWS                                        BETWEEN 2 PRECEDING AND 1 PRECEDING)
--Result--
[(None, '32', 3.4, 1, None), (None, '39', 0.0, 2, '[null]'), (1, '10', 3.4, 1, None), (2, '29', 2.3, 1, None), (2, '30', 2.3, 2, '[2]'), (3, '20', 6.5, 1, None), (4, '13', 8.9, 1, None), (4, '100', None, 2, '[4]'), (5, '23', None, 1, None), (8, '1', 99.3, 1, None), (8, '21', 1.2, 2, '[8]'), (9, '6', 32.4, 1, None), (10, '10', 3.4, 1, None), (11, '43', 21.0, 1, None), (13, '0', 1.1, 1, None), (15, '28', 0.9, 1, None)]
+--------------------+
--Query--
SELECT i, j, f, CUME_DIST() OVER w c_dist, JSON_ARRAYAGG(i)   OVER w jarray_i FROM t1 WINDOW w AS (PARTITION BY i ORDER BY j ROWS                                        BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
--Result--
[(None, '32', 3.4, 0.5, '[null]'), (None, '39', 0.0, 1.0, None), (1, '10', 3.4, 1.0, None), (2, '29', 2.3, 0.5, '[2]'), (2, '30', 2.3, 1.0, None), (3, '20', 6.5, 1.0, None), (4, '13', 8.9, 0.5, '[4]'), (4, '100', None, 1.0, None), (5, '23', None, 1.0, None), (8, '1', 99.3, 0.5, '[8]'), (8, '21', 1.2, 1.0, None), (9, '6', 32.4, 1.0, None), (10, '10', 3.4, 1.0, None), (11, '43', 21.0, 1.0, None), (13, '0', 1.1, 1.0, None), (15, '28', 0.9, 1.0, None)]
+--------------------+
--Query--
SELECT i, f, PERCENT_RANK() OVER w p_rank, JSON_ARRAYAGG(i)   OVER w jarray_i FROM t1 WINDOW w AS (PARTITION BY i ORDER BY f RANGE                                        BETWEEN 2.1 FOLLOWING AND 4.5 FOLLOWING)
--Result--
[(None, 0.0, 0.0, '[null]'), (None, 3.4, 1.0, None), (1, 3.4, 0.0, None), (2, 2.3, 0.0, None), (2, 2.3, 0.0, None), (3, 6.5, 0.0, None), (4, None, 0.0, '[4]'), (4, 8.9, 1.0, None), (5, None, 0.0, '[5]'), (8, 1.2, 0.0, None), (8, 99.3, 1.0, None), (9, 32.4, 0.0, None), (10, 3.4, 0.0, None), (11, 21.0, 0.0, None), (13, 1.1, 0.0, None), (15, 0.9, 0.0, None)]
+--------------------+
--Query--
SELECT i, f, j, CUME_DIST() OVER w c_dist, JSON_ARRAYAGG(j)   OVER w jarray_j FROM t1 WINDOW w AS (PARTITION BY i ORDER BY f RANGE                                        BETWEEN 1 PRECEDING AND 10 FOLLOWING)
--Result--
[(None, 0.0, '39', 0.5, '[39, 32]'), (None, 3.4, '32', 1.0, '[32]'), (1, 3.4, '10', 1.0, '[10]'), (2, 2.3, '30', 1.0, '[30, 29]'), (2, 2.3, '29', 1.0, '[30, 29]'), (3, 6.5, '20', 1.0, '[20]'), (4, None, '100', 0.5, '[100]'), (4, 8.9, '13', 1.0, '[13]'), (5, None, '23', 1.0, '[23]'), (8, 1.2, '21', 0.5, '[21]'), (8, 99.3, '1', 1.0, '[1]'), (9, 32.4, '6', 1.0, '[6]'), (10, 3.4, '10', 1.0, '[10]'), (11, 21.0, '43', 1.0, '[43]'), (13, 1.1, '0', 1.0, '[0]'), (15, 0.9, '28', 1.0, '[28]')]
+--------------------+
--Query--
SELECT j, s, f, JSON_OBJECTAGG(j,f) OVER w jobject_f, JSON_OBJECTAGG(j,s)   OVER w jobject_s FROM t1 WINDOW w AS (ORDER BY j)
--Result--
[('10', 'efghi', 3.4, '{"10": 6.5}', '{"10": "efghi"}'), ('10', 'efghi', 6.5, '{"10": 6.5}', '{"10": "efghi"}'), ('13', 'ffhfg', 8.9, '{"10": 6.5, "13": 8.9}', '{"10": "efghi", "13": "ffhfg"}'), ('20', 'sdfsd', 3.3, '{"10": 6.5, "13": 8.9, "20": 3.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd"}'), ('21', 'efghi', 1.2, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi"}'), ('23', 'dfgdf', 8.0, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf"}'), ('29', 'efghi', 3.3, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi"}'), ('29', 'efghi', 2.3, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi"}'), ('29', 'efghi', 2.3, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi"}'), ('30', 'sdfsd', 2.3, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd"}'), ('30', 'sdfsd', 2.3, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd"}'), ('31', 'sdfsd', 2.3, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd"}'), ('32', 'wqweq', 3.4, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq"}'), ('40', 'sdfsd', 2.3, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq", "40": "sdfsd"}'), ('45', 'sdfsd', 4.5, '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq", "40": "sdfsd", "45": "sdfsd"}')]
+--------------------+
--Query--
SELECT i, JSON_OBJECTAGG(i,j) OVER() FROM t1
--Result--
[(1, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (3, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (5, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (5, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (4, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (8, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}')]
+--------------------+
--Query--
SELECT j, s, JSON_OBJECTAGG(j,s) OVER w jobject_s, JSON_OBJECTAGG(f,j)   OVER w jobject_j FROM t1 WINDOW w AS (ORDER BY j) ORDER BY j DESC
--Result--
[('45', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq", "40": "sdfsd", "45": "sdfsd"}', '{"8": 23, "1.2": 21, "2.3": 40, "3.3": 29, "3.4": 32, "4.5": 45, "6.5": 10, "8.9": 13}'), ('40', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq", "40": "sdfsd"}', '{"8": 23, "1.2": 21, "2.3": 40, "3.3": 29, "3.4": 32, "6.5": 10, "8.9": 13}'), ('32', 'wqweq', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq"}', '{"8": 23, "1.2": 21, "2.3": 31, "3.3": 29, "3.4": 32, "6.5": 10, "8.9": 13}'), ('31', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd"}', '{"8": 23, "1.2": 21, "2.3": 31, "3.3": 29, "3.4": 10, "6.5": 10, "8.9": 13}'), ('30', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd"}', '{"8": 23, "1.2": 21, "2.3": 30, "3.3": 29, "3.4": 10, "6.5": 10, "8.9": 13}'), ('30', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd"}', '{"8": 23, "1.2": 21, "2.3": 30, "3.3": 29, "3.4": 10, "6.5": 10, "8.9": 13}'), ('29', 'efghi', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi"}', '{"8": 23, "1.2": 21, "2.3": 29, "3.3": 29, "3.4": 10, "6.5": 10, "8.9": 13}'), ('29', 'efghi', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi"}', '{"8": 23, "1.2": 21, "2.3": 29, "3.3": 29, "3.4": 10, "6.5": 10, "8.9": 13}'), ('29', 'efghi', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi"}', '{"8": 23, "1.2": 21, "2.3": 29, "3.3": 29, "3.4": 10, "6.5": 10, "8.9": 13}'), ('23', 'dfgdf', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf"}', '{"8": 23, "1.2": 21, "3.3": 20, "3.4": 10, "6.5": 10, "8.9": 13}'), ('21', 'efghi', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi"}', '{"1.2": 21, "3.3": 20, "3.4": 10, "6.5": 10, "8.9": 13}'), ('20', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd"}', '{"3.3": 20, "3.4": 10, "6.5": 10, "8.9": 13}'), ('13', 'ffhfg', '{"10": "efghi", "13": "ffhfg"}', '{"3.4": 10, "6.5": 10, "8.9": 13}'), ('10', 'efghi', '{"10": "efghi"}', '{"3.4": 10, "6.5": 10}'), ('10', 'efghi', '{"10": "efghi"}', '{"3.4": 10, "6.5": 10}')]
+--------------------+
--Query--
SELECT j, i, JSON_OBJECTAGG(j,i) OVER w jobject_i, JSON_OBJECTAGG(j,f)   OVER w jobject_f FROM t1 WINDOW w AS (ORDER BY j DESC)
--Result--
[('45', 2, '{"45": 2}', '{"45": 4.5}'), ('40', 2, '{"40": 2, "45": 2}', '{"40": 2.3, "45": 4.5}'), ('32', 5, '{"32": 5, "40": 2, "45": 2}', '{"32": 3.4, "40": 2.3, "45": 4.5}'), ('31', 2, '{"31": 2, "32": 5, "40": 2, "45": 2}', '{"31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('30', 2, '{"30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('30', 2, '{"30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('29', 2, '{"29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('29', 2, '{"29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('29', 2, '{"29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('23', 5, '{"23": 5, "29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('21', 8, '{"21": 8, "23": 5, "29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('20', 2, '{"20": 2, "21": 8, "23": 5, "29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('13', 4, '{"13": 4, "20": 2, "21": 8, "23": 5, "29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('10', 1, '{"10": 3, "13": 4, "20": 2, "21": 8, "23": 5, "29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}'), ('10', 3, '{"10": 3, "13": 4, "20": 2, "21": 8, "23": 5, "29": 2, "30": 2, "31": 2, "32": 5, "40": 2, "45": 2}', '{"10": 6.5, "13": 8.9, "20": 3.3, "21": 1.2, "23": 8.0, "29": 2.3, "30": 2.3, "31": 2.3, "32": 3.4, "40": 2.3, "45": 4.5}')]
+--------------------+
--Query--
SELECT i, j, JSON_OBJECTAGG(j,f) OVER w jobject_i, JSON_OBJECTAGG(j,s)   OVER w jobject_f FROM t1 WINDOW w AS (PARTITION BY i ORDER BY j)
--Result--
[(1, '10', '{"10": 3.4}', '{"10": "efghi"}'), (2, '20', '{"20": 3.3}', '{"20": "sdfsd"}'), (2, '29', '{"20": 3.3, "29": 2.3}', '{"20": "sdfsd", "29": "efghi"}'), (2, '29', '{"20": 3.3, "29": 2.3}', '{"20": "sdfsd", "29": "efghi"}'), (2, '29', '{"20": 3.3, "29": 2.3}', '{"20": "sdfsd", "29": "efghi"}'), (2, '30', '{"20": 3.3, "29": 2.3, "30": 2.3}', '{"20": "sdfsd", "29": "efghi", "30": "sdfsd"}'), (2, '30', '{"20": 3.3, "29": 2.3, "30": 2.3}', '{"20": "sdfsd", "29": "efghi", "30": "sdfsd"}'), (2, '31', '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3}', '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd"}'), (2, '40', '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3}', '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd"}'), (2, '45', '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd", "45": "sdfsd"}'), (3, '10', '{"10": 6.5}', '{"10": "efghi"}'), (4, '13', '{"13": 8.9}', '{"13": "ffhfg"}'), (5, '23', '{"23": 8.0}', '{"23": "dfgdf"}'), (5, '32', '{"23": 8.0, "32": 3.4}', '{"23": "dfgdf", "32": "wqweq"}'), (8, '21', '{"21": 1.2}', '{"21": "efghi"}')]
+--------------------+
--Query--
SELECT j, s, f, JSON_OBJECTAGG(j,s) OVER w jobject_s, JSON_OBJECTAGG(f,j)   OVER w jobject_j FROM t1 WINDOW w AS (PARTITION BY i ORDER BY s)
--Result--
[('10', 'efghi', 3.4, '{"10": "efghi"}', '{"3.4": 10}'), ('29', 'efghi', 3.3, '{"29": "efghi"}', '{"2.3": 29, "3.3": 29}'), ('29', 'efghi', 2.3, '{"29": "efghi"}', '{"2.3": 29, "3.3": 29}'), ('29', 'efghi', 2.3, '{"29": "efghi"}', '{"2.3": 29, "3.3": 29}'), ('30', 'sdfsd', 2.3, '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd", "45": "sdfsd"}', '{"2.3": 40, "3.3": 20, "4.5": 45}'), ('30', 'sdfsd', 2.3, '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd", "45": "sdfsd"}', '{"2.3": 40, "3.3": 20, "4.5": 45}'), ('31', 'sdfsd', 2.3, '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd", "45": "sdfsd"}', '{"2.3": 40, "3.3": 20, "4.5": 45}'), ('40', 'sdfsd', 2.3, '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd", "45": "sdfsd"}', '{"2.3": 40, "3.3": 20, "4.5": 45}'), ('20', 'sdfsd', 3.3, '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd", "45": "sdfsd"}', '{"2.3": 40, "3.3": 20, "4.5": 45}'), ('45', 'sdfsd', 4.5, '{"20": "sdfsd", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "40": "sdfsd", "45": "sdfsd"}', '{"2.3": 40, "3.3": 20, "4.5": 45}'), ('10', 'efghi', 6.5, '{"10": "efghi"}', '{"6.5": 10}'), ('13', 'ffhfg', 8.9, '{"13": "ffhfg"}', '{"8.9": 13}'), ('23', 'dfgdf', 8.0, '{"23": "dfgdf"}', '{"8": 23}'), ('32', 'wqweq', 3.4, '{"23": "dfgdf", "32": "wqweq"}', '{"8": 23, "3.4": 32}'), ('21', 'efghi', 1.2, '{"21": "efghi"}', '{"1.2": 21}')]
+--------------------+
--Query--
SELECT * FROM v
--Result--
[(8, '21', '{"8": 21}'), (5, '23', '{"5": 23, "8": 21}'), (5, '32', '{"5": 32, "8": 21}'), (4, '13', '{"4": 13, "5": 32, "8": 21}'), (3, '10', '{"3": 10, "4": 13, "5": 32, "8": 21}'), (2, '29', '{"2": 29, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '29', '{"2": 29, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '29', '{"2": 29, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '30', '{"2": 30, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '30', '{"2": 30, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '31', '{"2": 31, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '40', '{"2": 40, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '20', '{"2": 20, "3": 10, "4": 13, "5": 32, "8": 21}'), (2, '45', '{"2": 45, "3": 10, "4": 13, "5": 32, "8": 21}'), (1, '10', '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}')]
+--------------------+
--Query--
SELECT j, s, JSON_OBJECTAGG(j, s) OVER w jobject_s FROM t1   GROUP BY j,s WINDOW w AS (ORDER BY j)
--Result--
[('10', 'efghi', '{"10": "efghi"}'), ('13', 'ffhfg', '{"10": "efghi", "13": "ffhfg"}'), ('20', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd"}'), ('21', 'efghi', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi"}'), ('23', 'dfgdf', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf"}'), ('29', 'efghi', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi"}'), ('30', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd"}'), ('31', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd"}'), ('32', 'wqweq', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq"}'), ('40', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq", "40": "sdfsd"}'), ('45', 'sdfsd', '{"10": "efghi", "13": "ffhfg", "20": "sdfsd", "21": "efghi", "23": "dfgdf", "29": "efghi", "30": "sdfsd", "31": "sdfsd", "32": "wqweq", "40": "sdfsd", "45": "sdfsd"}')]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(j,f) OVER w jobject_f, RANK()   OVER w rank1 FROM t1 WINDOW w AS (PARTITION BY i ORDER BY i)
--Result--
[(1, '10', 3.4, '{"10": 3.4}', 1), (2, '29', 3.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '29', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '29', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '30', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '30', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '31', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '40', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '20', 3.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (2, '45', 4.5, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 1), (3, '10', 6.5, '{"10": 6.5}', 1), (4, '13', 8.9, '{"13": 8.9}', 1), (5, '23', 8.0, '{"23": 8.0, "32": 3.4}', 1), (5, '32', 3.4, '{"23": 8.0, "32": 3.4}', 1), (8, '21', 1.2, '{"21": 1.2}', 1)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(i,j) OVER w jobject_i, RANK()   OVER w rank1, NTH_VALUE(i,2) OVER w nth, LEAD(f, 1)   OVER w lead1, LAG(f,1) OVER w lag1 FROM t1   WINDOW w AS (PARTITION BY i ORDER BY j)
--Result--
[(1, '10', 3.4, '{"1": 10}', 1, None, None, None), (2, '20', 3.3, '{"2": 20}', 1, None, 3.3, None), (2, '29', 3.3, '{"2": 29}', 2, 2, 2.3, 3.3), (2, '29', 2.3, '{"2": 29}', 2, 2, 2.3, 3.3), (2, '29', 2.3, '{"2": 29}', 2, 2, 2.3, 2.3), (2, '30', 2.3, '{"2": 30}', 5, 2, 2.3, 2.3), (2, '30', 2.3, '{"2": 30}', 5, 2, 2.3, 2.3), (2, '31', 2.3, '{"2": 31}', 7, 2, 2.3, 2.3), (2, '40', 2.3, '{"2": 40}', 8, 2, 4.5, 2.3), (2, '45', 4.5, '{"2": 45}', 9, 2, None, 2.3), (3, '10', 6.5, '{"3": 10}', 1, None, None, None), (4, '13', 8.9, '{"4": 13}', 1, None, None, None), (5, '23', 8.0, '{"5": 23}', 1, None, 3.4, None), (5, '32', 3.4, '{"5": 32}', 2, 5, None, 8.0), (8, '21', 1.2, '{"8": 21}', 1, None, None, None)]
+--------------------+
--Query--
SELECT i, f, PERCENT_RANK() OVER (ORDER BY f) p_rank, JSON_OBJECTAGG(i,j)   OVER (ORDER BY i,j ROWS UNBOUNDED PRECEDING) jobject_j FROM t1
--Result--
[(1, 3.4, 0.6428571428571429, '{"1": 10}'), (2, 3.3, 0.5, '{"1": 10, "2": 20}'), (2, 2.3, 0.07142857142857142, '{"1": 10, "2": 29}'), (2, 2.3, 0.07142857142857142, '{"1": 10, "2": 29}'), (2, 3.3, 0.5, '{"1": 10, "2": 29}'), (2, 2.3, 0.07142857142857142, '{"1": 10, "2": 30}'), (2, 2.3, 0.07142857142857142, '{"1": 10, "2": 30}'), (2, 2.3, 0.07142857142857142, '{"1": 10, "2": 31}'), (2, 2.3, 0.07142857142857142, '{"1": 10, "2": 40}'), (2, 4.5, 0.7857142857142857, '{"1": 10, "2": 45}'), (3, 6.5, 0.8571428571428571, '{"1": 10, "2": 45, "3": 10}'), (4, 8.9, 1.0, '{"1": 10, "2": 45, "3": 10, "4": 13}'), (5, 8.0, 0.9285714285714286, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 23}'), (5, 3.4, 0.6428571428571429, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32}'), (8, 1.2, 0.0, '{"1": 10, "2": 45, "3": 10, "4": 13, "5": 32, "8": 21}')]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(j,f) OVER w jobject_j, RANK()   OVER w rank1 FROM t1 WINDOW w AS (PARTITION BY f ORDER BY j ROWS                                     BETWEEN 2 PRECEDING AND 1 PRECEDING)
--Result--
[(8, '21', 1.2, None, 1), (2, '29', 2.3, None, 1), (2, '29', 2.3, '{"29": 2.3}', 1), (2, '30', 2.3, '{"29": 2.3}', 3), (2, '30', 2.3, '{"29": 2.3, "30": 2.3}', 3), (2, '31', 2.3, '{"30": 2.3}', 5), (2, '40', 2.3, '{"30": 2.3, "31": 2.3}', 6), (2, '20', 3.3, None, 1), (2, '29', 3.3, '{"20": 3.3}', 2), (1, '10', 3.4, None, 1), (5, '32', 3.4, '{"10": 3.4}', 2), (2, '45', 4.5, None, 1), (3, '10', 6.5, None, 1), (5, '23', 8.0, None, 1), (4, '13', 8.9, None, 1)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(j,f) OVER w jobject_j, RANK()   OVER w rank1 FROM t1 WINDOW w AS (PARTITION BY f ORDER BY j ROWS                                     BETWEEN 2 PRECEDING AND CURRENT ROW)
--Result--
[(8, '21', 1.2, '{"21": 1.2}', 1), (2, '29', 2.3, '{"29": 2.3}', 1), (2, '29', 2.3, '{"29": 2.3}', 1), (2, '30', 2.3, '{"29": 2.3, "30": 2.3}', 3), (2, '30', 2.3, '{"29": 2.3, "30": 2.3}', 3), (2, '31', 2.3, '{"30": 2.3, "31": 2.3}', 5), (2, '40', 2.3, '{"30": 2.3, "31": 2.3, "40": 2.3}', 6), (2, '20', 3.3, '{"20": 3.3}', 1), (2, '29', 3.3, '{"20": 3.3, "29": 3.3}', 2), (1, '10', 3.4, '{"10": 3.4}', 1), (5, '32', 3.4, '{"10": 3.4, "32": 3.4}', 2), (2, '45', 4.5, '{"45": 4.5}', 1), (3, '10', 6.5, '{"10": 6.5}', 1), (5, '23', 8.0, '{"23": 8.0}', 1), (4, '13', 8.9, '{"13": 8.9}', 1)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(j,f) OVER w jobject_j, CUME_DIST()   OVER w c_dist FROM t1 WINDOW w AS (PARTITION BY i ORDER BY j ROWS                                      BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
--Result--
[(1, '10', 3.4, None, 1.0), (2, '20', 3.3, '{"29": 2.3}', 0.1111111111111111), (2, '29', 3.3, '{"29": 2.3}', 0.4444444444444444), (2, '29', 2.3, '{"29": 2.3, "30": 2.3}', 0.4444444444444444), (2, '29', 2.3, '{"30": 2.3}', 0.4444444444444444), (2, '30', 2.3, '{"30": 2.3, "31": 2.3}', 0.6666666666666666), (2, '30', 2.3, '{"31": 2.3, "40": 2.3}', 0.6666666666666666), (2, '31', 2.3, '{"40": 2.3, "45": 4.5}', 0.7777777777777778), (2, '40', 2.3, '{"45": 4.5}', 0.8888888888888888), (2, '45', 4.5, None, 1.0), (3, '10', 6.5, None, 1.0), (4, '13', 8.9, None, 1.0), (5, '23', 8.0, '{"32": 3.4}', 0.5), (5, '32', 3.4, None, 1.0), (8, '21', 1.2, None, 1.0)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(f,j) OVER w jobject_i FROM t1 WINDOW w AS (PARTITION BY i ORDER BY f RANGE BETWEEN 2.1 FOLLOWING              AND 4.5 FOLLOWING)
--Result--
[(1, '10', 3.4, None), (2, '29', 2.3, '{"4.5": 45}'), (2, '29', 2.3, '{"4.5": 45}'), (2, '30', 2.3, '{"4.5": 45}'), (2, '30', 2.3, '{"4.5": 45}'), (2, '31', 2.3, '{"4.5": 45}'), (2, '40', 2.3, '{"4.5": 45}'), (2, '29', 3.3, None), (2, '20', 3.3, None), (2, '45', 4.5, None), (3, '10', 6.5, None), (4, '13', 8.9, None), (5, '32', 3.4, None), (5, '23', 8.0, None), (8, '21', 1.2, None)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(j,f) OVER w jobject_j, CUME_DIST()   OVER w c_dist FROM t1 WINDOW w AS (PARTITION BY i ORDER BY j,f ROWS                                      BETWEEN 2 PRECEDING AND 2 FOLLOWING)
--Result--
[(1, '10', 3.4, '{"10": 3.4}', 1.0), (2, '20', 3.3, '{"20": 3.3, "29": 2.3}', 0.1111111111111111), (2, '29', 2.3, '{"20": 3.3, "29": 3.3}', 0.3333333333333333), (2, '29', 2.3, '{"20": 3.3, "29": 3.3, "30": 2.3}', 0.3333333333333333), (2, '29', 3.3, '{"29": 3.3, "30": 2.3}', 0.4444444444444444), (2, '30', 2.3, '{"29": 3.3, "30": 2.3, "31": 2.3}', 0.6666666666666666), (2, '30', 2.3, '{"29": 3.3, "30": 2.3, "31": 2.3, "40": 2.3}', 0.6666666666666666), (2, '31', 2.3, '{"30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 0.7777777777777778), (2, '40', 2.3, '{"30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}', 0.8888888888888888), (2, '45', 4.5, '{"31": 2.3, "40": 2.3, "45": 4.5}', 1.0), (3, '10', 6.5, '{"10": 6.5}', 1.0), (4, '13', 8.9, '{"13": 8.9}', 1.0), (5, '23', 8.0, '{"23": 8.0, "32": 3.4}', 0.5), (5, '32', 3.4, '{"23": 8.0, "32": 3.4}', 1.0), (8, '21', 1.2, '{"21": 1.2}', 1.0)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(i,j) OVER w jobject_i, RANK()   OVER w rank1 FROM t1 WINDOW w AS (PARTITION BY f ORDER BY j ROWS                                     BETWEEN 2 PRECEDING AND 1 PRECEDING)
--Result--
[(8, '21', 1.2, None, 1), (2, '29', 2.3, None, 1), (2, '29', 2.3, '{"2": 29}', 1), (2, '30', 2.3, '{"2": 29}', 3), (2, '30', 2.3, '{"2": 30}', 3), (2, '31', 2.3, '{"2": 30}', 5), (2, '40', 2.3, '{"2": 31}', 6), (2, '20', 3.3, None, 1), (2, '29', 3.3, '{"2": 20}', 2), (1, '10', 3.4, None, 1), (5, '32', 3.4, '{"1": 10}', 2), (2, '45', 4.5, None, 1), (3, '10', 6.5, None, 1), (5, '23', 8.0, None, 1), (4, '13', 8.9, None, 1)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(i,j) OVER w jobject_i, RANK()   OVER w rank1 FROM t1 WINDOW w AS (PARTITION BY f ORDER BY j ROWS                                     BETWEEN 2 PRECEDING AND CURRENT ROW)
--Result--
[(8, '21', 1.2, '{"8": 21}', 1), (2, '29', 2.3, '{"2": 29}', 1), (2, '29', 2.3, '{"2": 29}', 1), (2, '30', 2.3, '{"2": 30}', 3), (2, '30', 2.3, '{"2": 30}', 3), (2, '31', 2.3, '{"2": 31}', 5), (2, '40', 2.3, '{"2": 40}', 6), (2, '20', 3.3, '{"2": 20}', 1), (2, '29', 3.3, '{"2": 29}', 2), (1, '10', 3.4, '{"1": 10}', 1), (5, '32', 3.4, '{"1": 10, "5": 32}', 2), (2, '45', 4.5, '{"2": 45}', 1), (3, '10', 6.5, '{"3": 10}', 1), (5, '23', 8.0, '{"5": 23}', 1), (4, '13', 8.9, '{"4": 13}', 1)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(i,j) OVER w jobject_i FROM t1   WINDOW w AS (PARTITION BY i ORDER BY j ROWS BETWEEN 1 FOLLOWING                AND 5 FOLLOWING)
--Result--
[(1, '10', 3.4, None), (2, '20', 3.3, '{"2": 30}'), (2, '29', 3.3, '{"2": 31}'), (2, '29', 2.3, '{"2": 40}'), (2, '29', 2.3, '{"2": 45}'), (2, '30', 2.3, '{"2": 45}'), (2, '30', 2.3, '{"2": 45}'), (2, '31', 2.3, '{"2": 45}'), (2, '40', 2.3, '{"2": 45}'), (2, '45', 4.5, None), (3, '10', 6.5, None), (4, '13', 8.9, None), (5, '23', 8.0, '{"5": 32}'), (5, '32', 3.4, None), (8, '21', 1.2, None)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(j,f) OVER w jobject_j FROM t1   WINDOW w AS (PARTITION BY i ROWS BETWEEN 1 FOLLOWING AND                UNBOUNDED FOLLOWING)
--Result--
[(1, '10', 3.4, None), (2, '29', 3.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '29', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '29', 2.3, '{"20": 3.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '30', 2.3, '{"20": 3.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '30', 2.3, '{"20": 3.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '31', 2.3, '{"20": 3.3, "40": 2.3, "45": 4.5}'), (2, '40', 2.3, '{"20": 3.3, "45": 4.5}'), (2, '20', 3.3, '{"45": 4.5}'), (2, '45', 4.5, None), (3, '10', 6.5, None), (4, '13', 8.9, None), (5, '23', 8.0, '{"32": 3.4}'), (5, '32', 3.4, None), (8, '21', 1.2, None)]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(j,f) OVER w jobject_j FROM t1   WINDOW w AS (PARTITION BY i ROWS BETWEEN 2 PRECEDING AND 4 FOLLOWING)
--Result--
[(1, '10', 3.4, '{"10": 3.4}'), (2, '29', 3.3, '{"29": 2.3, "30": 2.3}'), (2, '29', 2.3, '{"29": 2.3, "30": 2.3, "31": 2.3}'), (2, '29', 2.3, '{"29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3}'), (2, '30', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3}'), (2, '30', 2.3, '{"20": 3.3, "29": 2.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '31', 2.3, '{"20": 3.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '40', 2.3, '{"20": 3.3, "30": 2.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '20', 3.3, '{"20": 3.3, "31": 2.3, "40": 2.3, "45": 4.5}'), (2, '45', 4.5, '{"20": 3.3, "40": 2.3, "45": 4.5}'), (3, '10', 6.5, '{"10": 6.5}'), (4, '13', 8.9, '{"13": 8.9}'), (5, '23', 8.0, '{"23": 8.0, "32": 3.4}'), (5, '32', 3.4, '{"23": 8.0, "32": 3.4}'), (8, '21', 1.2, '{"21": 1.2}')]
+--------------------+
--Query--
SELECT i, j, f, JSON_OBJECTAGG(i,f) OVER w jobject_i FROM t1   WINDOW w AS (PARTITION BY i ORDER BY f RANGE BETWEEN 2.1 FOLLOWING AND                4.5 FOLLOWING)
--Result--
[(1, '10', 3.4, None), (2, '29', 2.3, '{"2": 4.5}'), (2, '29', 2.3, '{"2": 4.5}'), (2, '30', 2.3, '{"2": 4.5}'), (2, '30', 2.3, '{"2": 4.5}'), (2, '31', 2.3, '{"2": 4.5}'), (2, '40', 2.3, '{"2": 4.5}'), (2, '29', 3.3, None), (2, '20', 3.3, None), (2, '45', 4.5, None), (3, '10', 6.5, None), (4, '13', 8.9, None), (5, '32', 3.4, None), (5, '23', 8.0, None), (8, '21', 1.2, None)]
+--------------------+
--Query--
SELECT 0 & (JSON_ARRAYAGG(1) OVER w) FROM (select 1) as dt  WINDOW w as ()
--Result--
[(0,)]
+--------------------+
--Query--
SELECT MAKETIME(((1)<=> (JSON_OBJECTAGG('1',1)OVER())),'1',1)
--Result--
[(datetime.timedelta(seconds=61),)]
+--------------------+
--Query--
SELECT (1 + CAST(JSON_OBJECTAGG(1,2) OVER () AS DECIMAL))
--Result--
[(1.0,)]
+--------------------+
--Query--
SELECT JSON_OBJECTAGG(`key`, i) OVER w AS agg        FROM t WINDOW w AS (ORDER BY `key` ROWS CURRENT ROW)
--Result--
[('{"a": 4}',), ('{"a": 5}',), ('{"b": 6}',), ('{"e": 1}',), ('{"e": 2}',), ('{"f": 3}',)]
+--------------------+
--Query--
SELECT JSON_OBJECTAGG(`key`, i) OVER w AS agg        FROM t WINDOW w AS (ORDER BY i ROWS CURRENT ROW)
--Result--
[('{"e": 1}',), ('{"e": 2}',), ('{"f": 3}',), ('{"a": 4}',), ('{"a": 5}',), ('{"b": 6}',)]
+--------------------+
