--Query--
SELECT i, j, MIN(i) OVER (ROWS UNBOUNDED PRECEDING) min,       MAX(j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t
--Result--
[(1, 1, 1, 1), (1, 4, 1, 4), (1, 2, 1, 4), (1, 4, 1, 4)]
+--------------------+
--Query--
SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j
--Result--
[(1, 1, 2), (1, 2, 2), (1, 4, 2), (1, 4, 2)]
+--------------------+
--Query--
SELECT i, j, MAX(i+j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j
--Result--
[(1, 1, 2), (1, 2, 3), (1, 4, 5), (1, 4, 5)]
+--------------------+
--Query--
SELECT * FROM v
--Result--
[(1, 4, 5, 5), (1, 4, 5, 5), (1, 2, 3, 5), (1, 1, 2, 5)]
+--------------------+
--Query--
SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t GROUP BY (k)
--Result--
[(1, 1, 15.0, 1), (2, 1, 11.0, 1), (3, 1, 11.0, 1), (4, 1, 11.0, 1)]
+--------------------+
--Query--
SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,       MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
--Result--
[(1, '1,2,4,4,4', 1, 1), (2, '1,2,4,4', 1, 2), (3, '1,2,4,4', 1, 3), (4, '1,2,4,4', 1, 4)]
+--------------------+
--Query--
SELECT k, AVG(DISTINCT j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,       MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
--Result--
[(1, 2.3333, 1, 1), (2, 2.3333, 1, 2), (3, 2.3333, 1, 3), (4, 2.3333, 1, 4)]
+--------------------+
--Query--
SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k+1) OVER (ROWS UNBOUNDED PRECEDING) min FROM t GROUP BY (k)
--Result--
[(1, '1,2,4,4,4', 2), (2, '1,2,4,4', 2), (3, '1,2,4,4', 2), (4, '1,2,4,4', 2)]
+--------------------+
--Query--
SELECT k, GROUP_CONCAT(j ORDER BY j), MAX(k+1) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
--Result--
[(1, '1,2,4,4,4', 2), (2, '1,2,4,4', 3), (3, '1,2,4,4', 4), (4, '1,2,4,4', 5)]
+--------------------+
--Query--
SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1     GROUP BY sex     WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
--Result--
[('M', 3.0, 3.0, 10.5, 2), ('F', 3.0, 3.0, 10.5, 1), (None, 10.5, 10.5, 10.5, 1)]
+--------------------+
--Query--
SELECT sex, NTILE(2) OVER w , MIN(ASCII(sex)) OVER w min, MAX(ASCII(sex)) OVER w max FROM t1 HAVING sex=(SELECT c FROM ss LIMIT 1)   WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING)
--Result--
[('M', 1, 77, 77), ('M', 2, 77, 77)]
+--------------------+
--Query--
PREPARE p FROM "SELECT sex, AVG(id), MIN(AVG(id)) OVER w min,         MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1     GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL     WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC"
--Result--
[]
+--------------------+
--Query--
SELECT * from (SELECT t1.*, MIN(id) OVER (ROWS UNBOUNDED PRECEDING) min, RANK() OVER (ORDER BY sex) `rank` FROM t1) alias ORDER BY id
--Result--
[(1, 'M', 1, 4), (2, 'F', 1, 1), (3, 'F', 1, 1), (4, 'F', 1, 1), (5, 'M', 1, 4)]
+--------------------+
--Query--
SELECT * from (SELECT t1.*, MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max, PERCENT_RANK() OVER (ORDER BY sex) p_rank FROM t1) alias ORDER BY id
--Result--
[(1, 'M', 1, 0.75), (2, 'F', 2, 0.0), (3, 'F', 3, 0.0), (4, 'F', 4, 0.0), (5, 'M', 5, 0.75)]
+--------------------+
--Query--
SELECT * from (SELECT t1.*, MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max, CUME_DIST() OVER (ORDER BY sex) c_dist FROM t1) alias ORDER BY id
--Result--
[(1, 'M', 1, 1.0), (2, 'F', 2, 0.6), (3, 'F', 3, 0.6), (4, 'F', 4, 0.6), (5, 'M', 5, 1.0)]
+--------------------+
--Query--
SELECT t.*, MIN(id + r00 + r01) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) AS min,             MAX(id + r00 + r01) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) AS max FROM (    SELECT t1.*,        RANK() OVER (ORDER BY sex, id) AS r00,        RANK() OVER (ORDER BY sex, id DESC) AS r01,        RANK() OVER (ORDER BY sex, id DESC) AS r02,        RANK() OVER (PARTITION BY id ORDER BY sex) AS r03,        RANK() OVER (ORDER BY sex,id) AS r04,        RANK() OVER (ORDER BY sex,id) AS r05,        RANK() OVER (ORDER BY sex, id) AS r06,        RANK() OVER (ORDER BY sex, id) AS r07,        RANK() OVER (ORDER BY sex, id) AS r08,        RANK() OVER (ORDER BY sex, id) AS r09,        RANK() OVER (ORDER BY sex, id) AS r10,        RANK() OVER (ORDER BY sex, id) AS r11,        RANK() OVER (ORDER BY sex, id) AS r12,        RANK() OVER (ORDER BY sex, id) AS r13,        RANK() OVER (ORDER BY sex, id) AS r14        FROM t1) t
--Result--
[(1, 'M', 4, 5, 5, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 10, 10), (2, 'F', 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 10), (3, 'F', 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 6, 10), (4, 'F', 3, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 6, 10), (5, 'M', 5, 4, 4, 1, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 14)]
+--------------------+
--Query--
SELECT * FROM ( SELECT id, SUM(id) OVER w, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1        WINDOW w AS (PARTITION BY sex)        ) alias ORDER BY id
--Result--
[(1, 6.0, 1, 5, 'M'), (2, 9.0, 2, 4, 'F'), (3, 9.0, 2, 4, 'F'), (4, 9.0, 2, 4, 'F'), (5, 6.0, 1, 5, 'M')]
+--------------------+
--Query--
SELECT * FROM v
--Result--
[(2, None, None, None, 'F'), (3, 2.0, 2, 2, 'F'), (4, 5.0, 2, 3, 'F'), (1, None, None, None, 'M'), (5, 1.0, 1, 1, 'M')]
+--------------------+
--Query--
SELECT SUM(id) OVER w, MIN(id) OVER w min,        MAX(id) OVER w max FROM t1        WINDOW w AS (PARTITION BY sex ORDER BY id                     ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
--Result--
[(None, None, None), (2.0, 2, 2), (5.0, 2, 3), (None, None, None), (1.0, 1, 1)]
+--------------------+
--Query--
SELECT SUM(id) OVER w, COUNT(*) OVER w, MIN(id) OVER w min,       MAX(id) OVER w max FROM t1        WINDOW w AS (PARTITION BY sex ORDER BY id                     ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
--Result--
[(7.0, 2, 3, 4), (4.0, 1, 4, 4), (None, 0, None, None), (5.0, 1, 5, 5), (None, 0, None, None)]
+--------------------+
--Query--
SELECT id, AVG(id) OVER (ROWS UNBOUNDED PRECEDING) avg,        MIN(id) OVER (ROWS UNBOUNDED PRECEDING) min FROM t1
--Result--
[(1, 1.0, 1), (2, 1.5, 1), (3, 2.0, 1), (4, 2.5, 1), (5, 3.0, 1)]
+--------------------+
--Query--
SELECT id, AVG(id) OVER (ROWS UNBOUNDED PRECEDING),        MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max FROM t1
--Result--
[(1, 1.0, 1), (2, 1.5, 2), (3, 2.0, 3), (4, 2.5, 4), (5, 3.0, 5)]
+--------------------+
--Query--
SELECT id, AVG(id) OVER w avg, COUNT(id) OVER w count, MIN(id) OVER w min,        MAX(id) OVER w max FROM t1        WINDOW w AS (ORDER BY id ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)
--Result--
[(1, 1.5, 2, 1, 2), (2, 2.0, 3, 1, 3), (3, 3.0, 3, 2, 4), (4, 4.0, 3, 3, 5), (5, 4.5, 2, 4, 5)]
+--------------------+
--Query--
SELECT NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MIN(id) OVER w FROM t1     WINDOW w AS (ORDER BY id DESC RANGE 2 PRECEDING)
--Result--
[(1, 1, 10, 10), (1, 2, 5, 5), (2, 3, 4, 4), (3, 4, 3, 3), (4, 5, 2, 2), (5, 6, 1, 1)]
+--------------------+
--Query--
SELECT p, NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MAX(id) OVER w FROM t11     WINDOW w AS (PARTITION BY p ORDER BY id DESC RANGE 2 PRECEDING)
--Result--
[(1, 1, 1, 10, 10), (1, 1, 2, 5, 5), (1, 2, 3, 4, 5), (1, 3, 4, 3, 5), (1, 4, 5, 2, 4), (1, 5, 6, 1, 3), (2, 1, 1, 10, 10), (2, 1, 2, 5, 5), (2, 2, 3, 4, 5), (2, 3, 4, 3, 5), (2, 4, 5, 2, 4), (2, 5, 6, 1, 3)]
+--------------------+
--Query--
SELECT d, MIN(d) OVER w min, MAX(d) OVER w max, COUNT(*) OVER w FROM t3 WINDOW w AS (ORDER BY d RANGE BETWEEN 2.1 PRECEDING AND 1.1 FOLLOWING)
--Result--
[(1.1, 1.1, 1.9, 2), (1.9, 1.1, 1.9, 2), (4.0, 1.9, 4.0, 2), (8.3, 8.3, 8.3, 1), (16.0, 16.0, 16.0, 1), (20.1, 20.1, 20.1, 1), (22.0, 20.1, 23.0, 3), (23.0, 22.0, 24.0, 3), (24.0, 22.0, 24.0, 3)]
+--------------------+
--Query--
SELECT MIN(j) OVER () AS JSON FROM tj
--Result--
[('1',), ('1',), ('1',), ('1',), ('1',), ('1',), ('1',), ('1',), ('1',)]
+--------------------+
--Query--
SELECT j, JSON_TYPE(j), MIN(j) OVER (ORDER BY j ROWS 3 PRECEDING) FROM tj
--Result--
[(None, None, None), (None, None, None), ('1', 'INTEGER', '1'), ('2', 'INTEGER', '1'), ('3', 'INTEGER', '1'), ('3.14', 'DOUBLE', '1'), ('4', 'INTEGER', '2'), ('5', 'INTEGER', '3'), ('[1, 2, 3]', 'ARRAY', '3.14')]
+--------------------+
--Query--
SELECT j, JSON_TYPE(j), MAX(j) OVER (ORDER BY j ROWS 3 PRECEDING) FROM tj
--Result--
[(None, None, None), (None, None, None), ('1', 'INTEGER', '1'), ('2', 'INTEGER', '2'), ('3', 'INTEGER', '3'), ('3.14', 'DOUBLE', '3.14'), ('4', 'INTEGER', '4'), ('5', 'INTEGER', '5'), ('[1, 2, 3]', 'ARRAY', '[1, 2, 3]')]
+--------------------+
--Query--
SELECT j, JSON_TYPE(j), JSON_TYPE(MAX(j) OVER (ORDER BY j ROWS 3 PRECEDING)) FROM tj
--Result--
[(None, None, None), (None, None, None), ('1', 'INTEGER', 'INTEGER'), ('2', 'INTEGER', 'INTEGER'), ('3', 'INTEGER', 'INTEGER'), ('3.14', 'DOUBLE', 'DOUBLE'), ('3.14', 'DOUBLE', 'DOUBLE'), ('4', 'INTEGER', 'INTEGER'), ('5', 'INTEGER', 'INTEGER'), ('[1, 2, 3]', 'ARRAY', 'ARRAY')]
+--------------------+
--Query--
SELECT DISTINCT i,NTILE(3) OVER (ORDER BY i), MAX(i) OVER (), COUNT(*) OVER () FROM tj ORDER BY NTILE(3) OVER (ORDER BY i)
--Result--
[(7, 1, 7, 11), (7, 2, 7, 11), (7, 3, 7, 11)]
+--------------------+
--Query--
SELECT * FROM tj2
--Result--
[('1', 1), ('2', 0), ('3', 1), ('4', 2), ('5', 0), (None, None), ('3.14', 1), ('[1, 2, 3]', 2), (None, None), ('3.14', 1), ('[1, 2, 3]', 2)]
+--------------------+
--Query--
SELECT          COUNT(*) OVER (), MOD(MIN(i),2) FROM tj2 GROUP BY i
--Result--
[(4, 1), (4, 0), (4, 0), (4, None)]
+--------------------+
--Query--
SELECT i, MIN(i) OVER (), MOD(MIN(i),2) FROM tj2 GROUP BY i
--Result--
[(1, 0, 1), (0, 0, 0), (2, 0, 0), (None, 0, None)]
+--------------------+
--Query--
SELECT i, MAX(MAX(i)) OVER (), MAX(i) OVER (ORDER BY i), MOD(MAX(i),2), MAX(i) FROM tj2 GROUP BY i
--Result--
[(None, 2, None, None, None), (0, 2, 0, 0, 0), (1, 2, 1, 1, 1), (2, 2, 2, 0, 2)]
+--------------------+
--Query--
SELECT j,CAST(MIN(j) OVER (PARTITION BY i) AS JSON), CAST(MAX(j) OVER () AS JSON) FROM tj
--Result--
[(None, None, '[1, 2, 3]'), (None, None, '[1, 2, 3]'), ('1', '1', '[1, 2, 3]'), ('[1, 2, 3]', '[1, 2, 3]', '[1, 2, 3]'), ('[1, 2, 3]', '[1, 2, 3]', '[1, 2, 3]'), ('2', '2', '[1, 2, 3]'), ('3', '3', '[1, 2, 3]'), ('3.14', '3', '[1, 2, 3]'), ('3.14', '3', '[1, 2, 3]'), ('4', '4', '[1, 2, 3]'), ('5', '5', '[1, 2, 3]')]
+--------------------+
--Query--
SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
--Result--
[(4, 1, 4), (3, 2, 3), (2, 2, 2), (1, 2, 1), (1, 2, 1), (1, 2, 1), (1, 2, 1), (1, 2, 1), (None, 1, 1), (None, 0, None), (None, 0, None), (None, 0, None), (None, 0, None), (None, 0, None), (None, 0, None), (None, 0, None)]
+--------------------+
