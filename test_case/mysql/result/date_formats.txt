--Query--
select str_to_date(concat('15-01-2001',' 2:59:58.999'), 	           concat('%d-%m-%Y',' ','%H:%i:%s.%f'))
--Result--
[(datetime.datetime(2001, 1, 15, 2, 59, 58, 999000),)]
+--------------------+
--Query--
select STR_TO_DATE('2004.12.12 22.30.61','%Y.%m.%d %T')
--Result--
[(None,)]
+--------------------+
--Query--
select date,format,str_to_date(date, format) as str_to_date from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', datetime.datetime(2003, 1, 2, 10, 11, 12)), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(3, 1, 2, 8, 11, 2)), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', datetime.datetime(2003, 1, 2, 22, 11, 12)), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 1, 11, 12, 123450)), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', datetime.datetime(2003, 1, 2, 2, 11, 12, 123450)), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 0, 11, 12, 123450)), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', datetime.datetime(2003, 1, 2, 23, 11, 12)), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 12, 59, 58)), ('15 September 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 SEPTEMB 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 MAY 2001', '%d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('15th May 2001', '%D %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sunday 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sund 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Tuesday 00 2002', '%W %U %Y', datetime.datetime(2002, 1, 1, 0, 0)), ('Thursday 53 1998', '%W %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('Sunday 01 2001', '%W %v %x', datetime.datetime(2001, 1, 7, 0, 0)), ('Tuesday 52 2001', '%W %V %X', datetime.datetime(2002, 1, 1, 0, 0)), ('060 2004', '%j %Y', datetime.datetime(2004, 2, 29, 0, 0)), ('4 53 1998', '%w %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('15-01-2001', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 0, 0)), ('15-01-20', '%d-%m-%y', datetime.datetime(2020, 1, 15, 0, 0)), ('15-2001-1', '%d-%Y-%c', datetime.datetime(2001, 1, 15, 0, 0))]
+--------------------+
--Query--
select date,format,concat('',str_to_date(date, format)) as con from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', '2003-01-02 10:11:12.000000'), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', '2003-01-02 08:11:02.000000'), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '0003-01-02 08:11:02.000000'), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '2003-01-02 08:11:02.000000'), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', '2003-01-02 22:11:12.000000'), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', '2003-01-02 01:11:12.123450'), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', '2003-01-02 02:11:12.123450'), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', '2003-01-02 00:11:12.123450'), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', '2003-01-02 23:11:12.000000'), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', '2001-01-15 12:59:58.000000'), ('15 September 2001', '%d %M %Y', '2001-09-15 00:00:00.000000'), ('15 SEPTEMB 2001', '%d %M %Y', '2001-09-15 00:00:00.000000'), ('15 MAY 2001', '%d %b %Y', '2001-05-15 00:00:00.000000'), ('15th May 2001', '%D %b %Y', '2001-05-15 00:00:00.000000'), ('Sunday 15 MAY 2001', '%W %d %b %Y', '2001-05-15 00:00:00.000000'), ('Sund 15 MAY 2001', '%W %d %b %Y', '2001-05-15 00:00:00.000000'), ('Tuesday 00 2002', '%W %U %Y', '2002-01-01 00:00:00.000000'), ('Thursday 53 1998', '%W %u %Y', '1998-12-31 00:00:00.000000'), ('Sunday 01 2001', '%W %v %x', '2001-01-07 00:00:00.000000'), ('Tuesday 52 2001', '%W %V %X', '2002-01-01 00:00:00.000000'), ('060 2004', '%j %Y', '2004-02-29 00:00:00.000000'), ('4 53 1998', '%w %u %Y', '1998-12-31 00:00:00.000000'), ('15-01-2001', '%d-%m-%Y %H:%i:%S', '2001-01-15 00:00:00.000000'), ('15-01-20', '%d-%m-%y', '2020-01-15 00:00:00.000000'), ('15-2001-1', '%d-%Y-%c', '2001-01-15 00:00:00.000000')]
+--------------------+
--Query--
select date,format,cast(str_to_date(date, format) as datetime) as datetime from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', datetime.datetime(2003, 1, 2, 10, 11, 12)), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(3, 1, 2, 8, 11, 2)), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', datetime.datetime(2003, 1, 2, 22, 11, 12)), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 1, 11, 12)), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', datetime.datetime(2003, 1, 2, 2, 11, 12)), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 0, 11, 12)), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', datetime.datetime(2003, 1, 2, 23, 11, 12)), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 12, 59, 58)), ('15 September 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 SEPTEMB 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 MAY 2001', '%d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('15th May 2001', '%D %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sunday 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sund 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Tuesday 00 2002', '%W %U %Y', datetime.datetime(2002, 1, 1, 0, 0)), ('Thursday 53 1998', '%W %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('Sunday 01 2001', '%W %v %x', datetime.datetime(2001, 1, 7, 0, 0)), ('Tuesday 52 2001', '%W %V %X', datetime.datetime(2002, 1, 1, 0, 0)), ('060 2004', '%j %Y', datetime.datetime(2004, 2, 29, 0, 0)), ('4 53 1998', '%w %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('15-01-2001', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 0, 0)), ('15-01-20', '%d-%m-%y', datetime.datetime(2020, 1, 15, 0, 0)), ('15-2001-1', '%d-%Y-%c', datetime.datetime(2001, 1, 15, 0, 0))]
+--------------------+
--Query--
select date,format,DATE(str_to_date(date, format)) as date2 from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', datetime.date(2003, 1, 2)), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', datetime.date(2003, 1, 2)), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.date(3, 1, 2)), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.date(2003, 1, 2)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', datetime.date(2003, 1, 2)), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', datetime.date(2003, 1, 2)), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', datetime.date(2003, 1, 2)), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', datetime.date(2003, 1, 2)), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', datetime.date(2003, 1, 2)), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', datetime.date(2001, 1, 15)), ('15 September 2001', '%d %M %Y', datetime.date(2001, 9, 15)), ('15 SEPTEMB 2001', '%d %M %Y', datetime.date(2001, 9, 15)), ('15 MAY 2001', '%d %b %Y', datetime.date(2001, 5, 15)), ('15th May 2001', '%D %b %Y', datetime.date(2001, 5, 15)), ('Sunday 15 MAY 2001', '%W %d %b %Y', datetime.date(2001, 5, 15)), ('Sund 15 MAY 2001', '%W %d %b %Y', datetime.date(2001, 5, 15)), ('Tuesday 00 2002', '%W %U %Y', datetime.date(2002, 1, 1)), ('Thursday 53 1998', '%W %u %Y', datetime.date(1998, 12, 31)), ('Sunday 01 2001', '%W %v %x', datetime.date(2001, 1, 7)), ('Tuesday 52 2001', '%W %V %X', datetime.date(2002, 1, 1)), ('060 2004', '%j %Y', datetime.date(2004, 2, 29)), ('4 53 1998', '%w %u %Y', datetime.date(1998, 12, 31)), ('15-01-2001', '%d-%m-%Y %H:%i:%S', datetime.date(2001, 1, 15)), ('15-01-20', '%d-%m-%y', datetime.date(2020, 1, 15)), ('15-2001-1', '%d-%Y-%c', datetime.date(2001, 1, 15))]
+--------------------+
--Query--
select date,format,TIME(str_to_date(date, format)) as time from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', datetime.timedelta(seconds=36672)), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', datetime.timedelta(seconds=29462)), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.timedelta(seconds=29462)), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.timedelta(seconds=29462)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', datetime.timedelta(seconds=79872)), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', datetime.timedelta(seconds=4272, microseconds=123450)), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', datetime.timedelta(seconds=7872, microseconds=123450)), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', datetime.timedelta(seconds=672, microseconds=123450)), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', datetime.timedelta(seconds=83472)), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', datetime.timedelta(seconds=46798)), ('15 September 2001', '%d %M %Y', datetime.timedelta(0)), ('15 SEPTEMB 2001', '%d %M %Y', datetime.timedelta(0)), ('15 MAY 2001', '%d %b %Y', datetime.timedelta(0)), ('15th May 2001', '%D %b %Y', datetime.timedelta(0)), ('Sunday 15 MAY 2001', '%W %d %b %Y', datetime.timedelta(0)), ('Sund 15 MAY 2001', '%W %d %b %Y', datetime.timedelta(0)), ('Tuesday 00 2002', '%W %U %Y', datetime.timedelta(0)), ('Thursday 53 1998', '%W %u %Y', datetime.timedelta(0)), ('Sunday 01 2001', '%W %v %x', datetime.timedelta(0)), ('Tuesday 52 2001', '%W %V %X', datetime.timedelta(0)), ('060 2004', '%j %Y', datetime.timedelta(0)), ('4 53 1998', '%w %u %Y', datetime.timedelta(0)), ('15-01-2001', '%d-%m-%Y %H:%i:%S', datetime.timedelta(0)), ('15-01-20', '%d-%m-%y', datetime.timedelta(0)), ('15-2001-1', '%d-%Y-%c', datetime.timedelta(0))]
+--------------------+
--Query--
select date,format,concat(TIME(str_to_date(date, format))) as time2 from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', '10:11:12.000000'), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', '08:11:02.000000'), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '08:11:02.000000'), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '08:11:02.000000'), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', '22:11:12.000000'), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', '01:11:12.123450'), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', '02:11:12.123450'), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', '00:11:12.123450'), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', '23:11:12.000000'), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', '12:59:58.000000'), ('15 September 2001', '%d %M %Y', '00:00:00.000000'), ('15 SEPTEMB 2001', '%d %M %Y', '00:00:00.000000'), ('15 MAY 2001', '%d %b %Y', '00:00:00.000000'), ('15th May 2001', '%D %b %Y', '00:00:00.000000'), ('Sunday 15 MAY 2001', '%W %d %b %Y', '00:00:00.000000'), ('Sund 15 MAY 2001', '%W %d %b %Y', '00:00:00.000000'), ('Tuesday 00 2002', '%W %U %Y', '00:00:00.000000'), ('Thursday 53 1998', '%W %u %Y', '00:00:00.000000'), ('Sunday 01 2001', '%W %v %x', '00:00:00.000000'), ('Tuesday 52 2001', '%W %V %X', '00:00:00.000000'), ('060 2004', '%j %Y', '00:00:00.000000'), ('4 53 1998', '%w %u %Y', '00:00:00.000000'), ('15-01-2001', '%d-%m-%Y %H:%i:%S', '00:00:00.000000'), ('15-01-20', '%d-%m-%y', '00:00:00.000000'), ('15-2001-1', '%d-%Y-%c', '00:00:00.000000')]
+--------------------+
--Query--
select concat('',str_to_date('8:11:2.123456 03-01-02','%H:%i:%S.%f %y-%m-%d'))
--Result--
[('2003-01-02 08:11:02.123456',)]
+--------------------+
--Query--
select date,format,str_to_date(date, format) as str_to_date from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', datetime.datetime(2003, 1, 2, 10, 11, 12)), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(3, 1, 2, 8, 11, 2)), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', datetime.datetime(2003, 1, 2, 22, 11, 12)), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 1, 11, 12, 123450)), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', datetime.datetime(2003, 1, 2, 2, 11, 12, 123450)), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 0, 11, 12, 123450)), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', datetime.datetime(2003, 1, 2, 23, 11, 12)), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 12, 59, 58)), ('15 September 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 SEPTEMB 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 MAY 2001', '%d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('15th May 2001', '%D %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sunday 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sund 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Tuesday 00 2002', '%W %U %Y', datetime.datetime(2002, 1, 1, 0, 0)), ('Thursday 53 1998', '%W %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('Sunday 01 2001', '%W %v %x', datetime.datetime(2001, 1, 7, 0, 0)), ('Tuesday 52 2001', '%W %V %X', datetime.datetime(2002, 1, 1, 0, 0)), ('060 2004', '%j %Y', datetime.datetime(2004, 2, 29, 0, 0)), ('4 53 1998', '%w %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('15-01-2001', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 0, 0)), ('15-01-20', '%d-%m-%y', datetime.datetime(2020, 1, 15, 0, 0)), ('15-2001-1', '%d-%Y-%c', datetime.datetime(2001, 1, 15, 0, 0)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %H:%i:%S %p', None), ('2003-01-02 10:11:12.123456', '%Y-%m-%d %h:%i:%S %p', None), ('2003-01-02 10:11:12AM', '%Y-%m-%d %h:%i:%S.%f %p', None), ('2003-01-02 10:11:12AN', '%Y-%m-%d %h:%i:%S%p', None), ('2003-01-02 10:11:12 PM', '%y-%m-%d %H:%i:%S %p', None), ('10:20:10AM', '%H:%i:%s%p', None), ('15 Septembei 2001', '%d %M %Y', None), ('15 Ju 2001', '%d %M %Y', None), ('Sund 15 MA', '%W %d %b %Y', None), ('Thursdai 12 1998', '%W %u %Y', None), ('Sunday 01 2001', '%W %v %X', None), ('Tuesday 52 2001', '%W %V %x', None), ('Tuesday 52 2001', '%W %V %Y', None), ('Tuesday 52 2001', '%W %u %x', None), ('7 53 1998', '%w %u %Y', None), (None, '%m.%d.%Y', None)]
+--------------------+
--Query--
select date,format,concat(str_to_date(date, format),'') as con from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', '2003-01-02 10:11:12.000000'), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', '2003-01-02 08:11:02.000000'), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '0003-01-02 08:11:02.000000'), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '2003-01-02 08:11:02.000000'), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', '2003-01-02 22:11:12.000000'), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', '2003-01-02 01:11:12.123450'), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', '2003-01-02 02:11:12.123450'), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', '2003-01-02 00:11:12.123450'), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', '2003-01-02 23:11:12.000000'), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', '2001-01-15 12:59:58.000000'), ('15 September 2001', '%d %M %Y', '2001-09-15 00:00:00.000000'), ('15 SEPTEMB 2001', '%d %M %Y', '2001-09-15 00:00:00.000000'), ('15 MAY 2001', '%d %b %Y', '2001-05-15 00:00:00.000000'), ('15th May 2001', '%D %b %Y', '2001-05-15 00:00:00.000000'), ('Sunday 15 MAY 2001', '%W %d %b %Y', '2001-05-15 00:00:00.000000'), ('Sund 15 MAY 2001', '%W %d %b %Y', '2001-05-15 00:00:00.000000'), ('Tuesday 00 2002', '%W %U %Y', '2002-01-01 00:00:00.000000'), ('Thursday 53 1998', '%W %u %Y', '1998-12-31 00:00:00.000000'), ('Sunday 01 2001', '%W %v %x', '2001-01-07 00:00:00.000000'), ('Tuesday 52 2001', '%W %V %X', '2002-01-01 00:00:00.000000'), ('060 2004', '%j %Y', '2004-02-29 00:00:00.000000'), ('4 53 1998', '%w %u %Y', '1998-12-31 00:00:00.000000'), ('15-01-2001', '%d-%m-%Y %H:%i:%S', '2001-01-15 00:00:00.000000'), ('15-01-20', '%d-%m-%y', '2020-01-15 00:00:00.000000'), ('15-2001-1', '%d-%Y-%c', '2001-01-15 00:00:00.000000'), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %H:%i:%S %p', None), ('2003-01-02 10:11:12.123456', '%Y-%m-%d %h:%i:%S %p', None), ('2003-01-02 10:11:12AM', '%Y-%m-%d %h:%i:%S.%f %p', None), ('2003-01-02 10:11:12AN', '%Y-%m-%d %h:%i:%S%p', None), ('2003-01-02 10:11:12 PM', '%y-%m-%d %H:%i:%S %p', None), ('10:20:10AM', '%H:%i:%s%p', None), ('15 Septembei 2001', '%d %M %Y', None), ('15 Ju 2001', '%d %M %Y', None), ('Sund 15 MA', '%W %d %b %Y', None), ('Thursdai 12 1998', '%W %u %Y', None), ('Sunday 01 2001', '%W %v %X', None), ('Tuesday 52 2001', '%W %V %x', None), ('Tuesday 52 2001', '%W %V %Y', None), ('Tuesday 52 2001', '%W %u %x', None), ('7 53 1998', '%w %u %Y', None), (None, '%m.%d.%Y', None)]
+--------------------+
--Query--
select date,format,str_to_date(date, format) as str_to_date from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', datetime.datetime(2003, 1, 2, 10, 11, 12)), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(3, 1, 2, 8, 11, 2)), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', datetime.datetime(2003, 1, 2, 8, 11, 2)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', datetime.datetime(2003, 1, 2, 22, 11, 12)), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 1, 11, 12, 123450)), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', datetime.datetime(2003, 1, 2, 2, 11, 12, 123450)), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', datetime.datetime(2003, 1, 2, 0, 11, 12, 123450)), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', datetime.datetime(2003, 1, 2, 23, 11, 12)), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 12, 59, 58)), ('15 September 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 SEPTEMB 2001', '%d %M %Y', datetime.datetime(2001, 9, 15, 0, 0)), ('15 MAY 2001', '%d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('15th May 2001', '%D %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sunday 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Sund 15 MAY 2001', '%W %d %b %Y', datetime.datetime(2001, 5, 15, 0, 0)), ('Tuesday 00 2002', '%W %U %Y', datetime.datetime(2002, 1, 1, 0, 0)), ('Thursday 53 1998', '%W %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('Sunday 01 2001', '%W %v %x', datetime.datetime(2001, 1, 7, 0, 0)), ('Tuesday 52 2001', '%W %V %X', datetime.datetime(2002, 1, 1, 0, 0)), ('060 2004', '%j %Y', datetime.datetime(2004, 2, 29, 0, 0)), ('4 53 1998', '%w %u %Y', datetime.datetime(1998, 12, 31, 0, 0)), ('15-01-2001', '%d-%m-%Y %H:%i:%S', datetime.datetime(2001, 1, 15, 0, 0)), ('15-01-20', '%d-%m-%y', datetime.datetime(2020, 1, 15, 0, 0)), ('15-2001-1', '%d-%Y-%c', datetime.datetime(2001, 1, 15, 0, 0)), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %H:%i:%S %p', None), ('2003-01-02 10:11:12.123456', '%Y-%m-%d %h:%i:%S %p', None), ('2003-01-02 10:11:12AM', '%Y-%m-%d %h:%i:%S.%f %p', None), ('2003-01-02 10:11:12AN', '%Y-%m-%d %h:%i:%S%p', None), ('2003-01-02 10:11:12 PM', '%y-%m-%d %H:%i:%S %p', None), ('10:20:10AM', '%H:%i:%s%p', None), ('15 Septembei 2001', '%d %M %Y', None), ('15 Ju 2001', '%d %M %Y', None), ('Sund 15 MA', '%W %d %b %Y', None), ('Thursdai 12 1998', '%W %u %Y', None), ('Sunday 01 2001', '%W %v %X', None), ('Tuesday 52 2001', '%W %V %x', None), ('Tuesday 52 2001', '%W %V %Y', None), ('Tuesday 52 2001', '%W %u %x', None), ('7 53 1998', '%w %u %Y', None), (None, '%m.%d.%Y', None), ('10:20:10AM', '%h:%i:%s', None), ('2003-01-02 10:11:12', '%Y-%m-%d %h:%i:%S', datetime.datetime(2003, 1, 2, 10, 11, 12)), ('03-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', datetime.datetime(2003, 1, 2, 22, 11, 12))]
+--------------------+
--Query--
select date,format,concat(str_to_date(date, format),'') as con from t1
--Result--
[('2003-01-02 10:11:12', '%Y-%m-%d %H:%i:%S', '2003-01-02 10:11:12.000000'), ('03-01-02 8:11:2.123456', '%y-%m-%d %H:%i:%S.%#', '2003-01-02 08:11:02.000000'), ('0003-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '0003-01-02 08:11:02.000000'), ('03-01-02 8:11:2.123456', '%Y-%m-%d %H:%i:%S.%#', '2003-01-02 08:11:02.000000'), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', '2003-01-02 22:11:12.000000'), ('2003-01-02 01:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f%p', '2003-01-02 01:11:12.123450'), ('2003-01-02 02:11:12.12345AM', '%Y-%m-%d %h:%i:%S.%f %p', '2003-01-02 02:11:12.123450'), ('2003-01-02 12:11:12.12345 am', '%Y-%m-%d %h:%i:%S.%f%p', '2003-01-02 00:11:12.123450'), ('2003-01-02 11:11:12Pm', '%Y-%m-%d %h:%i:%S%p', '2003-01-02 23:11:12.000000'), ('10:20:10', '%H:%i:%s', None), ('10:20:10', '%h:%i:%s.%f', None), ('10:20:10', '%T', None), ('10:20:10AM', '%h:%i:%s%p', None), ('10:20:10AM', '%r', None), ('10:20:10.44AM', '%h:%i:%s.%f%p', None), ('15-01-2001 12:59:58', '%d-%m-%Y %H:%i:%S', '2001-01-15 12:59:58.000000'), ('15 September 2001', '%d %M %Y', '2001-09-15 00:00:00.000000'), ('15 SEPTEMB 2001', '%d %M %Y', '2001-09-15 00:00:00.000000'), ('15 MAY 2001', '%d %b %Y', '2001-05-15 00:00:00.000000'), ('15th May 2001', '%D %b %Y', '2001-05-15 00:00:00.000000'), ('Sunday 15 MAY 2001', '%W %d %b %Y', '2001-05-15 00:00:00.000000'), ('Sund 15 MAY 2001', '%W %d %b %Y', '2001-05-15 00:00:00.000000'), ('Tuesday 00 2002', '%W %U %Y', '2002-01-01 00:00:00.000000'), ('Thursday 53 1998', '%W %u %Y', '1998-12-31 00:00:00.000000'), ('Sunday 01 2001', '%W %v %x', '2001-01-07 00:00:00.000000'), ('Tuesday 52 2001', '%W %V %X', '2002-01-01 00:00:00.000000'), ('060 2004', '%j %Y', '2004-02-29 00:00:00.000000'), ('4 53 1998', '%w %u %Y', '1998-12-31 00:00:00.000000'), ('15-01-2001', '%d-%m-%Y %H:%i:%S', '2001-01-15 00:00:00.000000'), ('15-01-20', '%d-%m-%y', '2020-01-15 00:00:00.000000'), ('15-2001-1', '%d-%Y-%c', '2001-01-15 00:00:00.000000'), ('2003-01-02 10:11:12 PM', '%Y-%m-%d %H:%i:%S %p', None), ('2003-01-02 10:11:12.123456', '%Y-%m-%d %h:%i:%S %p', None), ('2003-01-02 10:11:12AM', '%Y-%m-%d %h:%i:%S.%f %p', None), ('2003-01-02 10:11:12AN', '%Y-%m-%d %h:%i:%S%p', None), ('2003-01-02 10:11:12 PM', '%y-%m-%d %H:%i:%S %p', None), ('10:20:10AM', '%H:%i:%s%p', None), ('15 Septembei 2001', '%d %M %Y', None), ('15 Ju 2001', '%d %M %Y', None), ('Sund 15 MA', '%W %d %b %Y', None), ('Thursdai 12 1998', '%W %u %Y', None), ('Sunday 01 2001', '%W %v %X', None), ('Tuesday 52 2001', '%W %V %x', None), ('Tuesday 52 2001', '%W %V %Y', None), ('Tuesday 52 2001', '%W %u %x', None), ('7 53 1998', '%w %u %Y', None), (None, '%m.%d.%Y', None), ('10:20:10AM', '%h:%i:%s', None), ('2003-01-02 10:11:12', '%Y-%m-%d %h:%i:%S', '2003-01-02 10:11:12.000000'), ('03-01-02 10:11:12 PM', '%Y-%m-%d %h:%i:%S %p', '2003-01-02 22:11:12.000000')]
+--------------------+
--Query--
select get_format(DATE, 'USA') as a
--Result--
[('%m.%d.%Y',)]
+--------------------+
--Query--
select get_format(TIME, 'internal') as a
--Result--
[('%H%i%s',)]
+--------------------+
--Query--
select get_format(DATETIME, 'eur') as a
--Result--
[('%Y-%m-%d %H.%i.%s',)]
+--------------------+
--Query--
select get_format(TIMESTAMP, 'eur') as a
--Result--
[('%Y-%m-%d %H.%i.%s',)]
+--------------------+
--Query--
select get_format(DATE, 'TEST') as a
--Result--
[(None,)]
+--------------------+
--Query--
select date_format(d,"%d") from t1 order by 1
--Result--
[('14',), ('14',)]
+--------------------+
--Query--
select str_to_date("2003-....01ABCD-02 10:11:12.0012", "%Y-%.%m%@-%d %H:%i:%S.%f") as a
--Result--
[(datetime.datetime(2003, 1, 2, 10, 11, 12, 1200),)]
+--------------------+
--Query--
select str_to_date("2003-01-02 10:11:12.0012", "%Y-%m-%d %H:%i:%S.%f") as f1,        str_to_date("2003-01-02 10:11:12.0012", "%Y-%m-%d %H:%i:%S") as f2,        str_to_date("2003-01-02", "%Y-%m-%d") as f3,        str_to_date("02 10:11:12", "%d %H:%i:%S.%f") as f4,        str_to_date("02 10:11:12", "%d %H:%i:%S") as f5,        str_to_date("02 10", "%d %f") as f6
--Result--
[(datetime.datetime(2003, 1, 2, 10, 11, 12, 1200), datetime.datetime(2003, 1, 2, 10, 11, 12), datetime.date(2003, 1, 2), None, None, None)]
+--------------------+
--Query--
select str_to_date("2003-01-02 10:11:12.0012ABCD", "%Y-%m-%d %H:%i:%S.%f") as f1,        addtime("-01:01:01.01 GGG", "-23:59:59.1") as f2,        microsecond("1997-12-31 23:59:59.01XXXX") as f3
--Result--
[(datetime.datetime(2003, 1, 2, 10, 11, 12, 1200), '-25:01:00.110000', 10000)]
+--------------------+
--Query--
select str_to_date("2003-04-05  g", "%Y-%m-%d") as f1,        str_to_date("2003-04-05 10:11:12.101010234567", "%Y-%m-%d %H:%i:%S.%f") as f2
--Result--
[(datetime.date(2003, 4, 5), datetime.datetime(2003, 4, 5, 10, 11, 12, 101010))]
+--------------------+
--Query--
SELECT TIME_FORMAT("24:00:00", '%r')
--Result--
[('12:00:00 AM',)]
+--------------------+
--Query--
SELECT DATE_FORMAT('%Y-%m-%d %H:%i:%s', 1151414896)
--Result--
[(None,)]
+--------------------+
--Query--
SELECT DATE_FORMAT("0000-01-01",'%W %d %M %Y') as valid_date
--Result--
[('Sunday 01 January 0000',)]
+--------------------+
--Query--
SELECT DATE_FORMAT("0000-02-28",'%W %d %M %Y') as valid_date
--Result--
[('Tuesday 28 February 0000',)]
+--------------------+
--Query--
SELECT DATE_FORMAT("2009-01-01",'%W %d %M %Y') as valid_date
--Result--
[('Thursday 01 January 2009',)]
+--------------------+
--Query--
SELECT LEAST('%', GET_FORMAT(datetime, 'eur'), CAST(GET_FORMAT(datetime, 'eur') AS CHAR(65535)))
--Result--
[('%',)]
+--------------------+
--Query--
SELECT CAST(TIME_FORMAT(NULL, '%s') AS CHAR)
--Result--
[(None,)]
+--------------------+
--Query--
SELECT TIME_FORMAT(NULL, '%s')+0e0
--Result--
[(None,)]
+--------------------+
--Query--
SELECT * FROM t1 LEFT JOIN t2   ON t2.a = 'test1' AND t2.b = '20161213' WHERE t1.a = 'test1'
--Result--
[('test1', 'test1', datetime.date(2016, 12, 13))]
+--------------------+
--Query--
SELECT * FROM t1 LEFT JOIN t2 IGNORE INDEX(PRIMARY)   ON t2.a = 'test1' AND t2.b = '20161213' WHERE t1.a = 'test1'
--Result--
[('test1', 'test1', datetime.date(2016, 12, 13))]
+--------------------+
--Query--
SELECT b, b = '20161213',        CASE b WHEN '20161213' then 'found' ELSE 'not found' END FROM t2
--Result--
[(datetime.date(2016, 12, 13), 1, 'found'), (datetime.date(2016, 12, 14), 0, 'not found'), (datetime.date(2016, 12, 15), 0, 'not found')]
+--------------------+
--Query--
SELECT b, b IN ('20161213'), b in ('20161213', 0) FROM t2
--Result--
[(datetime.date(2016, 12, 13), 1, 1), (datetime.date(2016, 12, 14), 0, 0), (datetime.date(2016, 12, 15), 0, 0)]
+--------------------+
--Query--
SELECT b, b = '121314',        CASE b WHEN '121314' then 'found' ELSE 'not found' END FROM t3
--Result--
[(datetime.timedelta(seconds=36794), 0, 'not found'), (datetime.timedelta(seconds=40394), 0, 'not found'), (datetime.timedelta(seconds=43994), 1, 'found')]
+--------------------+
--Query--
SELECT b, b in ('121314'), b in ('121314', 0) FROM t3
--Result--
[(datetime.timedelta(seconds=36794), 0, 0), (datetime.timedelta(seconds=40394), 0, 0), (datetime.timedelta(seconds=43994), 1, 1)]
+--------------------+
--Query--
PREPARE ps FROM "SELECT GET_FORMAT(DATE, ?) AS val"
--Result--
[]
+--------------------+
--Query--
DEALLOCATE PREPARE ps
--Result--
[]
+--------------------+
