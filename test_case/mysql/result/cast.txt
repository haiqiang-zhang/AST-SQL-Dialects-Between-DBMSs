--Query--
select CAST(1-2 AS UNSIGNED)
--Result--
[(18446744073709551615,)]
+--------------------+
--Query--
select cast(-5 as unsigned) | 1, cast(-5 as unsigned) & -1
--Result--
[(18446744073709551611, 18446744073709551611)]
+--------------------+
--Query--
select cast(-5 as unsigned) -1, cast(-5 as unsigned) + 1
--Result--
[(18446744073709551610, 18446744073709551612)]
+--------------------+
--Query--
select cast("A" as binary) = "a", cast(BINARY "a" as CHAR) = "A"
--Result--
[(0, 1)]
+--------------------+
--Query--
select CONVERT("2004-01-22 21:45:33",DATE)
--Result--
[(datetime.date(2004, 1, 22),)]
+--------------------+
--Query--
select 10+'10'
--Result--
[(20.0,)]
+--------------------+
--Query--
select 10.0+'10'
--Result--
[(20.0,)]
+--------------------+
--Query--
select 10E+0+'10'
--Result--
[(20.0,)]
+--------------------+
--Query--
select 10+'a'
--Result--
[(10.0,)]
+--------------------+
--Query--
select 10.0+cast('a' as decimal)
--Result--
[(10.0,)]
+--------------------+
--Query--
select 10E+0+'a'
--Result--
[(10.0,)]
+--------------------+
--Query--
select hex(cast(_latin1'test' as char character set latin2))
--Result--
[('74657374',)]
+--------------------+
--Query--
select   cast(_latin1'ab'  AS char charset binary)    as c1,   cast(_latin1'a '  AS char charset binary)    as c2,   cast(_latin1'abc' AS char(2) charset binary) as c3,   cast(_latin1'a  ' AS char(2) charset binary) as c4,   hex(cast(_latin1'a'   AS char(2) charset binary)) as c5
--Result--
[(b'ab', b'a ', b'ab', b'a ', '6100')]
+--------------------+
--Query--
select   cast(_koi8r x'C6C7'   AS nchar)    as c1,   cast(_koi8r x'C620'   AS nchar)    as c2,   cast(_koi8r x'C6C7C8' AS nchar(2)) as c3,   cast(_koi8r x'C62020' AS nchar(2)) as c4,   cast(_koi8r x'C6'     AS nchar(2)) as c5
--Result--
[('фг', 'ф ', 'фг', 'ф ', 'ф')]
+--------------------+
--Query--
SELECT   CAST(_gb2312 x'CAFDBEDD'     AS NATIONAL CHAR)    AS c1,   CAST(_gb2312 x'CAFD20'       AS NATIONAL CHAR)    AS c2,   CAST(_gb2312 x'CAFDBEDDBFE2' AS NATIONAL CHAR(2)) AS c3,   CAST(_gb2312 x'CAFD2020'     AS NATIONAL CHAR(2)) AS c4,   CAST(_gb2312 x'CAFD'         AS NATIONAL CHAR(2)) AS c5
--Result--
[('数据', '数 ', '数据', '数 ', '数')]
+--------------------+
--Query--
select cast("2001-1-1" as date) = "2001-01-01"
--Result--
[(1,)]
+--------------------+
--Query--
select cast("2001-1-1" as datetime) = "2001-01-01 00:00:00"
--Result--
[(1,)]
+--------------------+
--Query--
select cast("1:2:3" as TIME) = "1:02:03"
--Result--
[(0,)]
+--------------------+
--Query--
select date_add(cast('2004-12-30 12:00:00' as date), interval 0 hour)
--Result--
[(datetime.datetime(2004, 12, 30, 0, 0),)]
+--------------------+
--Query--
select timediff(cast('2004-12-30 12:00:00' as time), '12:00:00')
--Result--
[(datetime.timedelta(0),)]
+--------------------+
--Query--
SELECT f1 AS double_val, CAST(f1 AS SIGNED INT) AS cast_val FROM t1
--Result--
[(-1e+30, -9223372036854775808), (1e+30, 9223372036854775807)]
+--------------------+
--Query--
select isnull(date(NULL)), isnull(cast(NULL as DATE))
--Result--
[(1, 1)]
+--------------------+
--Query--
select 1e18 * cast('1.2' as decimal(3,2))
--Result--
[(1.2e+18,)]
+--------------------+
--Query--
select cast(NULL as decimal(6)) as t1
--Result--
[(None,)]
+--------------------+
--Query--
SELECT HOUR(f1),        MINUTE(f1),        SECOND(f1) FROM t1
--Result--
[(0, 0, 0), (None, None, None)]
+--------------------+
--Query--
SELECT 1 FROM (  SELECT CONVERT(t2.a USING utf8mb3) FROM t1, t1 t2 LIMIT 1 ) AS s LIMIT 1
--Result--
[(1,)]
+--------------------+
--Query--
SELECT a FROM t1  WHERE CAST(a as BINARY)=x'62736D697468'    AND CAST(a AS BINARY)=x'65736D697468'
--Result--
[]
+--------------------+
--Query--
SELECT CAST(c1 AS UNSIGNED) AS c5 FROM t
--Result--
[(1,), (2,), (3,)]
+--------------------+
--Query--
SELECT CAST(c1 AS UNSIGNED) AS c5 FROM (SELECT c1 FROM t) t
--Result--
[(1,), (2,), (3,)]
+--------------------+
--Query--
SELECT CAST(1/3 AS FLOAT) as float_col,        CAST(1/3 AS DOUBLE) as double_col,        CAST(1/3 AS DOUBLE PRECISION) as double_prec_col,        CAST(1/3 AS REAL) as real_col
--Result--
[(0.333333, 0.333333333, 0.333333333, 0.333333333)]
+--------------------+
--Query--
SELECT ADDDATE(CAST("20010101235959.9" AS DOUBLE), INTERVAL 1 DAY)
--Result--
[('2001-01-02 23:59:59.898438',)]
+--------------------+
--Query--
SELECT TIMEDIFF(CAST("101112" AS DOUBLE), TIME'101010')
--Result--
[(datetime.timedelta(seconds=62),)]
+--------------------+
--Query--
SELECT -1.0 *  CAST(3.14e19 AS DOUBLE)
--Result--
[(-3.14e+19,)]
+--------------------+
--Query--
SELECT CONCAT("value=", CAST("3.4e5" AS FLOAT))
--Result--
[('value=340000',)]
+--------------------+
--Query--
SELECT MAKETIME(1, 2, CAST("1.6" AS FLOAT))
--Result--
[(datetime.timedelta(seconds=3721, microseconds=600000),)]
+--------------------+
--Query--
SELECT STRCMP(a, b) FROM t1
--Result--
[(-1,)]
+--------------------+
--Query--
SELECT col_char /*CAST(col_char as datetime)*/ <> col_datetime FROM t
--Result--
[(1,), (None,)]
+--------------------+
--Query--
SELECT col_char <> col_date FROM t
--Result--
[(1,), (None,)]
+--------------------+
--Query--
SELECT col_char <> col_time FROM t
--Result--
[(1,), (None,)]
+--------------------+
--Query--
SELECT COUNT(table1.pk) FROM CC table1 JOIN BB table3 JOIN CC table2 WHERE (table3.col_char_key < table2.col_datetime_key)
--Result--
[(4,)]
+--------------------+
--Query--
SELECT * FROM t
--Result--
[]
+--------------------+
--Query--
SELECT CAST(1988 AS YEAR) + 1.5e0
--Result--
[(1989.5,)]
+--------------------+
--Query--
SELECT DATE_ADD(CAST(1988 AS YEAR), INTERVAL 1 DAY)
--Result--
[(None,)]
+--------------------+
--Query--
SELECT TIME_TO_SEC(CAST('2030' AS YEAR))
--Result--
[(1230,)]
+--------------------+
--Query--
SELECT TIMESTAMPADD(MINUTE, 1, CAST(1988 AS YEAR))
--Result--
[(None,)]
+--------------------+
--Query--
SELECT CAST('0000-00-00' AS DATE) AS d1,        CAST(@zero_date AS DATE) AS d2,        CAST('0000-00-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-01-00' AS DATE) AS d1,        CAST(@zero_day AS DATE) AS d2,        CAST('2000-01-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_day_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-00-01' AS DATE) AS d1,        CAST(@zero_month AS DATE) AS d2,        CAST('2000-00-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_month_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('0000-01-01' AS DATE) AS d1,        CAST(@zero_year AS DATE) AS d2,        CAST('0000-01-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_year_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-02-31' AS DATE) AS d1,        CAST(@invalid_date AS DATE) AS d2,        CAST('2000-02-31 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@invalid_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('YYYY-MM-DD' AS DATE) AS d1,        CAST(@bad_date AS DATE) AS d2,        CAST('YYYY-MM-DD HH:MM:SS.ffffff' AS DATETIME(6)) AS dt1,        CAST(@bad_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('0000-00-00' AS DATE) AS d1,        CAST(@zero_date AS DATE) AS d2,        CAST('0000-00-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-01-00' AS DATE) AS d1,        CAST(@zero_day AS DATE) AS d2,        CAST('2000-01-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_day_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-00-01' AS DATE) AS d1,        CAST(@zero_month AS DATE) AS d2,        CAST('2000-00-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_month_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('0000-01-01' AS DATE) AS d1,        CAST(@zero_year AS DATE) AS d2,        CAST('0000-01-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_year_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-02-31' AS DATE) AS d1,        CAST(@invalid_date AS DATE) AS d2,        CAST('2000-02-31 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@invalid_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('YYYY-MM-DD' AS DATE) AS d1,        CAST(@bad_date AS DATE) AS d2,        CAST('YYYY-MM-DD HH:MM:SS.ffffff' AS DATETIME(6)) AS dt1,        CAST(@bad_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('0000-00-00' AS DATE) AS d1,        CAST(@zero_date AS DATE) AS d2,        CAST('0000-00-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-01-00' AS DATE) AS d1,        CAST(@zero_day AS DATE) AS d2,        CAST('2000-01-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_day_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-00-01' AS DATE) AS d1,        CAST(@zero_month AS DATE) AS d2,        CAST('2000-00-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_month_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('0000-01-01' AS DATE) AS d1,        CAST(@zero_year AS DATE) AS d2,        CAST('0000-01-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_year_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-02-31' AS DATE) AS d1,        CAST(@invalid_date AS DATE) AS d2,        CAST('2000-02-31 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@invalid_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('YYYY-MM-DD' AS DATE) AS d1,        CAST(@bad_date AS DATE) AS d2,        CAST('YYYY-MM-DD HH:MM:SS.ffffff' AS DATETIME(6)) AS dt1,        CAST(@bad_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('0000-00-00' AS DATE) AS d1,        CAST(@zero_date AS DATE) AS d2,        CAST('0000-00-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-01-00' AS DATE) AS d1,        CAST(@zero_day AS DATE) AS d2,        CAST('2000-01-00 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_day_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-00-01' AS DATE) AS d1,        CAST(@zero_month AS DATE) AS d2,        CAST('2000-00-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_month_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('0000-01-01' AS DATE) AS d1,        CAST(@zero_year AS DATE) AS d2,        CAST('0000-01-01 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@zero_year_dt AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('2000-02-31' AS DATE) AS d1,        CAST(@invalid_date AS DATE) AS d2,        CAST('2000-02-31 00:00:00.000000' AS DATETIME(6)) AS dt1,        CAST(@invalid_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT CAST('YYYY-MM-DD' AS DATE) AS d1,        CAST(@bad_date AS DATE) AS d2,        CAST('YYYY-MM-DD HH:MM:SS.ffffff' AS DATETIME(6)) AS dt1,        CAST(@bad_datetime AS DATETIME(6)) AS dt2
--Result--
[(None, None, None, None)]
+--------------------+
--Query--
SELECT * FROM t
--Result--
[('18446744073709551615', 1.8446744073709552e+19, '-9223372036854775808')]
+--------------------+
--Query--
SELECT HEX(beer), beer FROM tmp
--Result--
[('F09F8DBA', '🍺')]
+--------------------+
--Query--
SELECT a FROM t
--Result--
[('a',)]
+--------------------+
--Query--
SELECT HEX(beer), CHAR_LENGTH(beer) FROM t
--Result--
[('D83CDF7A', 1)]
+--------------------+
--Query--
SELECT CAST(1111111111111111 AS FLOAT) = CAST(1111111111111110 AS FLOAT) AS eq
--Result--
[(1,)]
+--------------------+
--Query--
SELECT CAST(CAST(1111111111111111 AS FLOAT) AS CHAR) AS v
--Result--
[('1.11111e15',)]
+--------------------+
--Query--
SELECT CAST(CAST(1111111111111111 AS FLOAT) AS SIGNED) AS v
--Result--
[(1111111126482944,)]
+--------------------+
--Query--
SELECT CAST(CAST(1111111111111111 AS FLOAT) AS DECIMAL(20,2)) AS v
--Result--
[(1111111126482944.0,)]
+--------------------+
