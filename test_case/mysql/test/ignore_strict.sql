CREATE TABLE t1 (a int) ENGINE = InnoDB PARTITION BY HASH (a) PARTITIONS 2;
INSERT INTO t1 VALUES (0), (1), (2), (3);
CREATE VIEW v1 AS SELECT a FROM t1 PARTITION (p0);
SELECT * FROM t1;
SELECT * FROM v1;
INSERT IGNORE INTO v1 VALUES (10),(11);
UPDATE IGNORE v1 SET a=11 WHERE a=2;
SELECT * FROM v1;
SELECT * from t1;
DROP TABLE t1;
DROP VIEW v1;
CREATE TABLE t1 (a int) ENGINE = InnoDB PARTITION BY LIST (a)
(PARTITION x1 VALUES IN (2,5), PARTITION x2 VALUES IN (3));
INSERT INTO t1 VALUES (2), (3), (5);
INSERT IGNORE INTO t1 VALUES (2),(4);
SELECT * FROM t1;
UPDATE IGNORE t1 SET a=a+1;
SELECT * FROM t1;
DROP TABLE t1;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t2 (b INT, FOREIGN KEY(b) REFERENCES t1(a)) ENGINE = InnoDB;
CREATE TABLE t3 (c INT PRIMARY KEY, FOREIGN KEY(c) REFERENCES t2(b)) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1), (2), (5);
INSERT INTO t2 VALUES (1);
INSERT IGNORE INTO t3 VALUES (1), (2);
UPDATE IGNORE t3 SET c=2 where c=1;
DELETE IGNORE FROM t1;
SELECT * FROM t1;
UPDATE IGNORE t2 SET b=b+5;
SELECT * FROM t2;
DROP TABLE t3,t2,t1;
CREATE TABLE t1 (a INT) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1),(NULL),(2);
SELECT * FROM t1;
UPDATE IGNORE t1 SET a=NULL WHERE a=0;
SELECT * FROM t1;
DELETE FROM t1;
INSERT INTO t1 VALUES (NULL);
INSERT IGNORE INTO t1 VALUES (NULL);
SELECT * FROM t1;
INSERT IGNORE INTO t1 VALUES (NULL),(3);
SELECT * FROM t1;
DROP TABLE t1;
CREATE TABLE t1(a INT, b INT) ENGINE = InnoDB;
CREATE TABLE t2(a INT, b INT NOT NULL) ENGINE = InnoDB;
INSERT INTO t1 VALUES(1, NULL),(2,NULL);
INSERT INTO t2 VALUES (1,3), (2,4);
UPDATE IGNORE t1,t2 SET t2.b=NULL;
DROP TABLE t1,t2;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t2 (b INT PRIMARY KEY, FOREIGN KEY(b) REFERENCES t1(a)) ENGINE = InnoDB;
CREATE TABLE t3 (c INT PRIMARY KEY) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (1);
INSERT INTO t3 VALUES (1),(2),(3),(4),(5);
INSERT IGNORE INTO t1 VALUES(3);
SELECT * FROM t1;
UPDATE IGNORE t1 SET a=3 WHERE a=2;
SELECT * FROM t1;
SELECT * FROM t3;
INSERT IGNORE INTO t1 VALUES(2),(3);
SELECT * FROM t1;
SELECT * FROM t3;
UPDATE IGNORE t1 SET a=3 WHERE a=2;
DROP TABLE t2,t1,t3;
CREATE TABLE t1 (a INT) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1),(NULL),(2);
DROP TABLE t1;
CREATE TABLE t1(a INT NOT NULL) ENGINE = InnoDB;
INSERT IGNORE INTO t1 VALUES(NULL);
SELECT * FROM t1;
INSERT IGNORE INTO t1 VALUES (NULL),(1);
SELECT * FROM t1;
UPDATE IGNORE t1 SET a=NULL WHERE a=0;
SELECT * FROM t1;
DROP TABLE t1;
CREATE TABLE t1(a INT, b INT) ENGINE = InnoDB;
CREATE TABLE t2(a INT, b INT NOT NULL) ENGINE = InnoDB;
INSERT INTO t1 VALUES(1, NULL),(2,NULL);
INSERT INTO t2 VALUES (1,3), (2,4);
UPDATE IGNORE t1,t2 SET t2.b=NULL;
DROP TABLE t1, t2;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t2 (b INT, FOREIGN KEY(b) REFERENCES t1(a)) ENGINE = InnoDB;
CREATE TABLE t3 (c INT PRIMARY KEY, FOREIGN KEY(c) REFERENCES t2(b)) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1), (2), (5);
INSERT INTO t2 VALUES (1);
INSERT IGNORE INTO t3 VALUES (1), (2);
UPDATE IGNORE t3 SET c=2 where c=1;
DELETE IGNORE FROM t1;
SELECT * FROM t1;
UPDATE IGNORE t2 SET b=b+5;
SELECT * FROM t2;
DROP TABLE t3,t2,t1;
CREATE TABLE t1 (a int) ENGINE = InnoDB PARTITION BY HASH (a) PARTITIONS 2;
INSERT INTO t1 VALUES (0), (1), (2), (3);
CREATE VIEW v1 AS SELECT a FROM t1 PARTITION (p0);
SELECT * FROM t1;
SELECT * FROM v1;
INSERT IGNORE INTO v1 VALUES (10),(11);
UPDATE IGNORE v1 SET a=11 WHERE a=2;
DROP VIEW v1;
DROP TABLE t1;
CREATE TABLE t1 (a int) ENGINE = InnoDB PARTITION BY LIST (a)
(PARTITION x1 VALUES IN (2,5), PARTITION x2 VALUES IN (3));
INSERT INTO t1 VALUES (2), (3),(5);
INSERT IGNORE INTO t1 VALUES (2),(4);
UPDATE IGNORE t1 SET a=4 WHERE a=5;
DROP TABLE t1;
CREATE TABLE t11 (a INT NOT NULL, b INT, PRIMARY KEY (a)) ENGINE = InnoDB;
CREATE TABLE t2 (a INT NOT NULL, b INT, PRIMARY KEY (a)) ENGINE = InnoDB;
INSERT INTO t11 VALUES (0, 10),(1, 11),(2, 12);
INSERT INTO t2 VALUES (1, 21),(2, 12),(3, 23);
DELETE IGNORE FROM t11 WHERE t11.b = (SELECT b FROM t2 WHERE t11.a < t2.a);
DROP TABLE t11, t2;
CREATE TABLE t1 (a INT) ENGINE = InnoDB;
CREATE VIEW v1 AS SELECT * FROM t1 WHERE a < 2 WITH CHECK OPTION;
INSERT IGNORE INTO v1 VALUES (1), (3);
SELECT * FROM t1;
SELECT * FROM t1;
UPDATE IGNORE v1 SET a=5 WHERE a=1;
SELECT * FROM t1;
INSERT INTO t1 VALUES (1);
UPDATE IGNORE v1 STRAIGHT_JOIN (SELECT 1) AS dt SET a=5 WHERE a=1;
SELECT * FROM t1;
DROP VIEW v1;
DROP TABLE t1;
CREATE TABLE t1( a INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t2( a INT PRIMARY KEY) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1), (2), (3), (4);
INSERT INTO t2 VALUES (2), (4);
DELETE FROM t2;
INSERT INTO t2 VALUES (2),(4);
SELECT * from t2;
DROP TABLE t1,t2;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (col1 INT NOT NULL, col2 INT NOT NULL) ENGINE = InnoDB;
CREATE VIEW v1 (vcol1) AS SELECT col1 FROM t1;
INSERT IGNORE INTO t1 (col1) VALUES(12);
INSERT IGNORE INTO v1 (vcol1) VALUES(12);
DROP TABLE t1;
DROP VIEW v1;
CREATE TABLE t1(a INT) ENGINE = InnoDB;
INSERT IGNORE INTO t1 VALUES(2147483648);
UPDATE IGNORE t1 SET a=2147483648 WHERE a=0;
DROP TABLE t1;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(a INT) ENGINE = InnoDB;
INSERT IGNORE INTO t1 values('a');
UPDATE IGNORE t1 SET a='a' WHERE a=0;
DROP TABLE t1;
DROP TABLE IF EXISTS t3;
CREATE TABLE t3(c1 CHAR(10) NOT NULL) ENGINE = InnoDB;
INSERT INTO t3 VALUES('a');
INSERT IGNORE INTO t3 (c1) VALUES('12345678901.x');
UPDATE IGNORE t3 SET c1='12345678901.x' WHERE c1='a';
DROP TABLE t3;
CREATE TABLE t1 (col1 DATETIME) ENGINE = InnoDB;
INSERT INTO t1 VALUES('1000-01-01 00:00:00');
INSERT IGNORE INTO t1 VALUES(STR_TO_DATE('32.10.2004 15.30','%D.%D.%Y %H.%I'));
UPDATE IGNORE t1 SET col1=STR_TO_DATE('32.10.2004 15.30','%D.%D.%Y %H.%I') WHERE col1='1000-01-01 00:00:00';
DROP TABLE t1;
CREATE TABLE t1 (d DATE) ENGINE = InnoDB;
INSERT IGNORE INTO t1 (d) SELECT DATE_SUB('2000-01-01',INTERVAL 2001 YEAR);
DROP TABLE t1;
CREATE TABLE t1 (col1 CHAR(3), col2 INT) ENGINE = InnoDB;
SELECT * FROM t1;
INSERT IGNORE into t1 (col1) VALUES (CAST(1000 as CHAR(3)));
SELECT * FROM t1;
SELECT * FROM t1;
INSERT IGNORE into t1 (col1) VALUES (CAST(1000 as CHAR(3)));
SELECT * FROM t1;
DROP TABLE t1;
CREATE TABLE t1(a TINYINT);
INSERT IGNORE INTO t1 VALUES(2/0);
SELECT * FROM t1;
DELETE FROM t1;
INSERT IGNORE INTO t1 VALUES ('a59b');
INSERT IGNORE INTO t1 VALUES ('1a');
DROP TABLE t1;
CREATE TABLE t1(a INT) ENGINE = InnoDB;
INSERT IGNORE into t1(SELECT SLEEP(NULL));
SELECT * FROM t1;
DROP TABLE t1;
CREATE TABLE t1(a INT, b INT NOT NULL, c INT NOT NULL, d INT NOT NULL) ENGINE = InnoDB;
SELECT * FROM t1;
SELECT * FROM t1;
DROP TABLE t1;
CREATE TABLE t1 (a INT) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1),(NULL),(2);
SELECT * FROM t1;
UPDATE IGNORE t1 SET a=NULL WHERE a=0;
SELECT * FROM t1;
DELETE FROM t1;
INSERT INTO t1 VALUES (NULL);
INSERT IGNORE INTO t1 VALUES (NULL);
SELECT * FROM t1;
INSERT IGNORE INTO t1 VALUES (NULL),(3);
SELECT * FROM t1;
DROP TABLE t1;
CREATE TABLE t1(a INT, b INT) ENGINE = InnoDB;
CREATE TABLE t2(a INT, b INT NOT NULL) ENGINE = InnoDB;
INSERT INTO t1 VALUES(1, NULL),(2,NULL);
INSERT INTO t2 VALUES (1,3), (2,4);
UPDATE IGNORE t1,t2 SET t2.b=NULL;
UPDATE IGNORE t2,t1 SET t2.b=NULL;
DROP TABLE t1,t2;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t2 (b INT, FOREIGN KEY(b) REFERENCES t1(a)) ENGINE = InnoDB;
CREATE TABLE t3 (c INT PRIMARY KEY, FOREIGN KEY(c) REFERENCES t2(b)) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1), (2), (5);
INSERT INTO t2 VALUES (1);
INSERT IGNORE INTO t3 VALUES (1), (2);
UPDATE IGNORE t3 SET c=2 where c=1;
DELETE IGNORE FROM t1;
SELECT * FROM t1;
UPDATE IGNORE t2 SET b=b+5;
SELECT * FROM t2;
DROP TABLE t3,t2,t1;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t2 (b INT PRIMARY KEY, FOREIGN KEY(b) REFERENCES t1(a)) ENGINE = InnoDB;
CREATE TABLE t3 (c INT PRIMARY KEY) ENGINE = InnoDB;
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES (1);
INSERT INTO t3 VALUES (1);
UPDATE IGNORE t1,t3 SET t1.a=5 where t1.a=t3.c;
UPDATE IGNORE t2,t3 SET t2.b=5 where t2.b=t3.c;
DROP TABLE t3,t2,t1;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t2 (b INT PRIMARY KEY) ENGINE = InnoDB;
CREATE TABLE t3 (c INT PRIMARY KEY, FOREIGN KEY(c) REFERENCES t2(b)) ENGINE = InnoDB;
INSERT INTO t1 VALUES(1),(2);
INSERT INTO t2 VALUES (3),(4);
INSERT INTO t3 VALUES(3),(4);
DELETE IGNORE t1.*,t2.* FROM t1,t2;
SELECT * FROM t1;
SELECT * FROM t2;
DROP TABLE t3,t2,t1;
CREATE TABLE t1 (a INT PRIMARY KEY) ENGINE=InnoDB;
CREATE TABLE t2 (b INT PRIMARY KEY, FOREIGN KEY(b) REFERENCES t1(a)) ENGINE=InnoDB;
INSERT INTO t1 VALUES(1);
INSERT IGNORE INTO t2 VALUES(2) ON DUPLICATE KEY UPDATE b=b-1;
DROP table t2,t1;
CREATE TABLE t(a int) engine=innodb;
ALTER TABLE t DISCARD TABLESPACE;
DROP TABLE t;
CREATE TABLE t1(a INT);
INSERT INTO t1 VALUES(5);
CREATE TABLE t2(b int);
INSERT INTO t2 VALUES(7);
DELETE IGNORE FROM t1 where a <=> ln(0);
DELETE IGNORE t1, t2 FROM t1 INNER JOIN t2 WHERE t1.a <=> ln(0) AND t2.b <=> ln(0);
DROP TABLE t1,t2;
CREATE TABLE t2 (a int default 0, b int primary key) engine=innodb;
INSERT INTO t2 VALUES (0, 17);
DROP TABLE t2;
CREATE TABLE t1(a INT);
DELETE IGNORE FROM t1 WHERE a=1;
DROP TABLE t1;
