SELECT @@block_encryption_mode;
SELECT TO_BASE64(AES_ENCRYPT('a', 'b'));
SELECT LENGTH(AES_ENCRYPT('a', 'b'));
SELECT CHARSET(AES_ENCRYPT('a', 'b'));
SELECT AES_ENCRYPT('a', 'b') = AES_ENCRYPT('a', 'b');
SELECT AES_ENCRYPT('a', NULL);
SELECT AES_ENCRYPT(NULL, 'a');
SELECT AES_ENCRYPT(NULL, NULL);
SELECT TO_BASE64(AES_ENCRYPT('a', 0));
SELECT TO_BASE64(AES_ENCRYPT('a', 12.04));
SELECT TO_BASE64(AES_ENCRYPT(0, 'a'));
SELECT TO_BASE64(AES_ENCRYPT(12.04, 'a'));
SELECT TO_BASE64(AES_ENCRYPT(0, 0));
SELECT TO_BASE64(AES_ENCRYPT(12.04, 12.04));
SELECT AES_ENCRYPT('a', 12.04) = AES_ENCRYPT('a', '12.04');
SELECT AES_ENCRYPT('a', 0) = AES_ENCRYPT('a', '0');
SELECT AES_ENCRYPT(12.04, 'a') = AES_ENCRYPT('12.04', 'a');
SELECT AES_ENCRYPT(0, 'a') = AES_ENCRYPT('0', 'a');
SELECT AES_ENCRYPT('\x0Z', 'a') = AES_ENCRYPT('\x0Z', 'a');
SELECT AES_ENCRYPT('a', '\x0Z') = AES_ENCRYPT('a', '\x0Z');
SELECT AES_ENCRYPT('a', '\x0Y') = AES_ENCRYPT('a', '\x0Z');
SELECT AES_ENCRYPT('\x0Y', 'a') = AES_ENCRYPT('\x0Z', 'a');
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT('b', 'a');
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT('a', 'b');
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT('aa', 'a');
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT('a', 'aa');
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT(REPEAT('a',1000), 'a');
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT('a', REPEAT('a',1000));

CREATE TABLE t1 (a BINARY(16) PRIMARY KEY);
INSERT INTO t1 VALUES (AES_ENCRYPT('a','a'));
INSERT INTO t1 VALUES (AES_ENCRYPT('a','a'));
INSERT INTO t1 VALUES (AES_ENCRYPT('b','a'));
SELECT COUNT(*) FROM t1 WHERE a = AES_ENCRYPT('a', 'a');
SELECT COUNT(*) FROM t1 WHERE a = AES_ENCRYPT('b', 'a');
SELECT COUNT(*) FROM t1 WHERE a = AES_ENCRYPT('c', 'a');
SELECT COUNT(*) FROM t1 WHERE a = AES_ENCRYPT('a', 'c');

SELECT TO_BASE64(a) FROM t1 ORDER BY a;
DROP TABLE t1;
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT('a', 'a', REPEAT('a', 16));
SELECT AES_ENCRYPT('a', 'a') = AES_ENCRYPT('a', 'a', REPEAT('b', 16));
SELECT TO_BASE64(AES_ENCRYPT('a', 'a', 'a'));
SELECT TO_BASE64(AES_ENCRYPT('a', 'a', NULL));
SELECT TO_BASE64(AES_ENCRYPT('a', 'a', REPEAT('a', 1024)));
SELECT TO_BASE64(AES_ENCRYPT('a', 'a', RANDOM_BYTES(16)));
SELECT LENGTH(RANDOM_BYTES(1));
SELECT CHARSET(RANDOM_BYTES(1));
SELECT RANDOM_BYTES(1000000000000);
SELECT LENGTH(RANDOM_BYTES(0));
SELECT CHARSET(AES_DECRYPT(AES_ENCRYPT('a', 'a'), 'a'));
SELECT LENGTH(AES_DECRYPT(AES_ENCRYPT('a', 'a'), 'a'));
SELECT AES_DECRYPT(AES_ENCRYPT('a','a'), 'a') = 'a';
SELECT AES_DECRYPT(AES_ENCRYPT(_UTF8MB3'Жоро', 'a'), 'a') = _UTF8MB3'Жоро';
SELECT AES_DECRYPT(AES_ENCRYPT('Жоро', 'a'), 'a') = 'Жоро';
SELECT AES_DECRYPT(NULL, 'a');
SELECT AES_DECRYPT('a', NULL);
SELECT AES_DECRYPT(NULL, NULL);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a', 'a'), 'a', NULL);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a', 'a'), 'a', REPEAT('a',16));
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a', 'a'), 'a', REPEAT('a',100));
SELECT TO_BASE64(AES_DECRYPT(AES_ENCRYPT('a', 'a'), 'a', 'a'));

CREATE TABLE aes_ecb(a VARBINARY(16), b128 CHAR(16), b192 CHAR(16), b256 CHAR(16)) charset latin1;
INSERT INTO aes_ecb (a) VALUES ('a'), ('Жоро'), (REPEAT('a', 10));

SET SESSION block_encryption_mode='aes-128-ecb';
UPDATE aes_ecb SET b128 = AES_ENCRYPT(a, 'a');

SET SESSION block_encryption_mode='aes-192-ecb';
UPDATE aes_ecb SET b192 = AES_ENCRYPT(a, 'a');

SET SESSION block_encryption_mode='aes-256-ecb';
UPDATE aes_ecb SET b256 = AES_ENCRYPT(a, 'a');
SELECT COUNT(*) FROM aes_ecb WHERE b128 = b192 OR B192 = b256 OR b128=b256;

SET SESSION block_encryption_mode='aes-256-ecb';
SELECT COUNT(*) FROM aes_ecb WHERE a = AES_DECRYPT(b256, 'a');
SELECT COUNT(*) FROM aes_ecb WHERE a = AES_DECRYPT(b256, 'b');

SET SESSION block_encryption_mode='aes-192-ecb';
SELECT COUNT(*) FROM aes_ecb WHERE a = AES_DECRYPT(b192, 'a');
SELECT COUNT(*) FROM aes_ecb WHERE a = AES_DECRYPT(b192, 'b');

SET SESSION block_encryption_mode='aes-128-ecb';
SELECT COUNT(*) FROM aes_ecb WHERE a = AES_DECRYPT(b128, 'a');
SELECT COUNT(*) FROM aes_ecb WHERE a = AES_DECRYPT(b128, 'b');


SET SESSION block_encryption_mode=DEFAULT;
DROP TABLE aes_ecb;


let $block_mode=cbc;

let $block_mode=default;
SELECT RANDOM_BYTES(2147483647 - 9);
