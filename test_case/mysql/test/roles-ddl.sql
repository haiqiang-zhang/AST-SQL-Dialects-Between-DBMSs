CREATE ROLE r1;

CREATE USER u1@localhost IDENTIFIED BY 'foo';

CREATE DATABASE db2;
SET ROLE r1;

-- test positive
CREATE DATABASE db1;

-- test negative
--error ER_DBACCESS_DENIED_ERROR
DROP DATABASE db1;
SELECT CURRENT_USER(), CURRENT_ROLE();

-- negative test
--error ER_TABLEACCESS_DENIED_ERROR
CREATE TABLE db2.test (c1 int);
CREATE DATABASE db3;
CREATE TABLE db2.t1 (c1 INT);
DROP TABLE db2.t1;
CREATE TABLE db2.t1 (c1 INT);
INSERT INTO db2.t1 VALUES (1),(2),(3);

-- negative test
--error ER_TABLEACCESS_DENIED_ERROR
SELECT * FROM db2.t1;
SELECT c1 FROM db2.t1;
UPDATE db2.t1 SET c1=1;
ALTER TABLE db1.t1 ADD COLUMN (c2 INT);
DROP DATABASE db1;
DROP ROLE r1;
DROP USER u1@localhost;
DROP DATABASE db1;
DROP DATABASE db2;
