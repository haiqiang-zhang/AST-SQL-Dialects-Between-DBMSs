
SET @IV='abcd1234efgh5678';
SET @KEYS=REPEAT('c', 16);
SET @ENCSTR=REPEAT('d', 256);
let $block_mode=aes-128-ecb;
SELECT @@global.block_encryption_mode;
SELECT @@session.block_encryption_mode;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(f1 varchar(256));
INSERT INTO t1 values(@ENCSTR);
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR FROM t1;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR FROM t1;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(f1 varchar(256)) engine=InnoDB;
INSERT INTO t1 values(@ENCSTR);
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR FROM t1;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR FROM t1;
let $block_mode=aes-192-ecb;
SELECT @@global.block_encryption_mode;
SELECT @@session.block_encryption_mode;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(f1 varchar(256));
INSERT INTO t1 values(@ENCSTR);
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR FROM t1;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR FROM t1;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(f1 varchar(256)) engine=InnoDB;
INSERT INTO t1 values(@ENCSTR);
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR FROM t1;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR FROM t1;
let $block_mode=aes-256-ecb;
SELECT @@global.block_encryption_mode;
SELECT @@session.block_encryption_mode;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(f1 varchar(256));
INSERT INTO t1 values(@ENCSTR);
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR FROM t1;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR FROM t1;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1(f1 varchar(256)) engine=InnoDB;
INSERT INTO t1 values(@ENCSTR);
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS), @KEYS)=@ENCSTR FROM t1;
SELECT AES_DECRYPT(AES_ENCRYPT(@ENCSTR, @KEYS, @IV), @KEYS, @IV)=@ENCSTR FROM t1;
DROP TABLE IF EXISTS t1;
select LENGTH(RANDOM_BYTES(1))=1;
select LENGTH(RANDOM_BYTES(1024))=1024;
SET @KEYS=RANDOM_BYTES(1);
SET @KEYS=RANDOM_BYTES(1024);
select RANDOM_BYTES(0);
select RANDOM_BYTES(1025);
SET @IV='abcdefghijklmnophelloworldworldisgreat';
SET @IV1='abcdefghijklmnopqrstuvwxyz';
SET @KEYS='helloworld';
SET @ENCSTR=REPEAT('K',100);
SET @@session.block_encryption_mode = 'aes-256-cbc';
select AES_ENCRYPT(@ENCSTR, @KEYS, @IV)=AES_ENCRYPT(@ENCSTR, @KEYS, @IV1);
SET @IV='ijkl8765mnop2345';
SET @KEYS='helloworld1234567890';
SET @ENCSTR=REPEAT('J',255);

SET @@session.block_encryption_mode = 'aes-128-ecb';

DROP TABLE IF EXISTS t1;
CREATE TABLE t1(f1 varchar(256)) charset latin1;
INSERT INTO t1 values(AES_ENCRYPT(@ENCSTR, @KEYS, @IV));
SET @@session.block_encryption_mode = 'aes-192-ecb';
SELECT AES_DECRYPT(f1, @KEYS, @IV)=@ENCSTR FROM t1;
SET @@session.block_encryption_mode = 'aes-256-ecb';
SELECT AES_DECRYPT(f1, @KEYS, @IV)=@ENCSTR FROM t1;
SET @@session.block_encryption_mode = 'aes-128-cbc';
SELECT COALESCE (AES_DECRYPT(f1, @KEYS, @IV)=@ENCSTR,0) FROM t1;
SET @@session.block_encryption_mode = 'aes-192-cbc';
SELECT AES_DECRYPT(f1, @KEYS, @IV)=@ENCSTR FROM t1;
SET @@session.block_encryption_mode = 'aes-256-cbc';
SELECT AES_DECRYPT(f1, @KEYS, @IV)=@ENCSTR FROM t1;
SET @@session.block_encryption_mode = 'aes-128-ecb';
SELECT AES_DECRYPT(f1, @KEYS, @IV)=@ENCSTR FROM t1;

SET @@session.block_encryption_mode = DEFAULT;
DROP TABLE IF EXISTS t1;
