ATTACH '__TEST_DIR__/reattach_schema.db' AS new_db;;
CREATE SCHEMA new_db.my_schema;;
CREATE TABLE new_db.my_schema.my_table(col INTEGER);;
INSERT INTO new_db.my_schema.my_table VALUES (42);;
CREATE VIEW new_db.my_schema.my_view AS SELECT 84;
CREATE SEQUENCE new_db.my_schema.my_sequence;;
CREATE MACRO new_db.my_schema.one() AS (SELECT 1);;
CREATE MACRO new_db.my_schema.range(a) as TABLE SELECT * FROM range(a);
DETACH new_db;
ATTACH '__TEST_DIR__/reattach_schema.db' AS new_name;;
USE new_name.my_schema;
USE new_name.my_schema.my_table;
SELECT new_db.my_schema.one();
SELECT * FROM new_db.my_schema.range(3);
SELECT * FROM new_name.my_schema.my_table;
SELECT * FROM new_name.my_schema.my_view;
SELECT nextval('new_name.my_schema.my_sequence');
SELECT new_name.my_schema.one();
SELECT * FROM new_name.my_schema.range(3);
SELECT * FROM my_table;
SELECT * FROM my_view;
SELECT nextval('my_sequence');
SELECT one();
SELECT * FROM range(3);
