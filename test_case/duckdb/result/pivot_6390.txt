--Query--
PRAGMA enable_verification
--Result--
[]
+--------------------+
--Query--
pivot cpb_tbl on nf using sum(jg)group by cpdh
--Result--
[('C3', 80, None, None, None), ('C2', 30, None, None, 10), ('C1', None, 0, 20, 10)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) pivot CPB on nf IN (2010, 2017, 2018, 2022) using sum(jg)group by cpdh
--Result--
[('C3', 80, None, None, None), ('C1', None, 0, 20, 10), ('C2', 30, None, None, 10)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) pivot CPB on nf using sum(jg)group by cpdh
--Result--
[('C1', None, 0, 20, 10), ('C3', 80, None, None, None), ('C2', 30, None, None, 10)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) SELECT * FROM  (pivot CPB on nf using sum(jg)group by cpdh)
--Result--
[('C1', None, 0, 20, 10), ('C3', 80, None, None, None), ('C2', 30, None, None, 10)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) from CPB pivot (sum(jg) for nf in (2010, 2017, 2018, 2022) group by cpdh)
--Result--
[('C2', 30, None, None, 10), ('C3', 80, None, None, None), ('C1', None, 0, 20, 10)]
+--------------------+
--Query--
WITH CPB AS (SELECT 42) SELECT * FROM  ( 	WITH CPB(CPDH,NF,JG) AS ( 		SELECT 'C1',2022,10 		UNION ALL 		SELECT 'C1',2018,20 		UNION ALL 		SELECT 'C1',2017,0 		UNION ALL 		SELECT 'C2',2022,10 		UNION ALL 		SELECT 'C2',2010,30 		UNION ALL 		SELECT 'C3',2010,80 	) 	pivot CPB on nf using sum(jg) group by cpdh)
--Result--
[('C2', 30, None, None, 10), ('C1', None, 0, 20, 10), ('C3', 80, None, None, None)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS MATERIALIZED ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) pivot CPB on nf IN (2010, 2017, 2018, 2022) using sum(jg)group by cpdh
--Result--
[('C3', 80, None, None, None), ('C1', None, 0, 20, 10), ('C2', 30, None, None, 10)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS MATERIALIZED ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) pivot CPB on nf using sum(jg)group by cpdh
--Result--
[('C3', 80, None, None, None), ('C1', None, 0, 20, 10), ('C2', 30, None, None, 10)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS MATERIALIZED ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) SELECT * FROM  (pivot CPB on nf using sum(jg)group by cpdh)
--Result--
[('C3', 80, None, None, None), ('C1', None, 0, 20, 10), ('C2', 30, None, None, 10)]
+--------------------+
--Query--
WITH CPB(CPDH,NF,JG) AS MATERIALIZED ( SELECT 'C1',2022,10 UNION ALL SELECT 'C1',2018,20 UNION ALL SELECT 'C1',2017,0 UNION ALL SELECT 'C2',2022,10 UNION ALL SELECT 'C2',2010,30 UNION ALL SELECT 'C3',2010,80 ) from CPB pivot (sum(jg) for nf in (2010, 2017, 2018, 2022) group by cpdh)
--Result--
[('C3', 80, None, None, None), ('C1', None, 0, 20, 10), ('C2', 30, None, None, 10)]
+--------------------+
--Query--
WITH CPB AS (SELECT 42) SELECT * FROM  ( 	WITH CPB(CPDH,NF,JG) AS MATERIALIZED ( 		SELECT 'C1',2022,10 		UNION ALL 		SELECT 'C1',2018,20 		UNION ALL 		SELECT 'C1',2017,0 		UNION ALL 		SELECT 'C2',2022,10 		UNION ALL 		SELECT 'C2',2010,30 		UNION ALL 		SELECT 'C3',2010,80 	) 	pivot CPB on nf using sum(jg) group by cpdh)
--Result--
[('C1', None, 0, 20, 10), ('C3', 80, None, None, None), ('C2', 30, None, None, 10)]
+--------------------+
