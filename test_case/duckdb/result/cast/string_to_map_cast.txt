--Query--
COPY (SELECT '{8="hello, DuckDB"}') TO '__TEST_DIR__/assembled_maps.csv'
--Result--
[(1,)]
+--------------------+
--Query--
COPY assembled_maps FROM '__TEST_DIR__/assembled_maps.csv'
--Result--
[(1,)]
+--------------------+
--Query--
SELECT '{a=1, b=2, c=3}'::MAP(VARCHAR, INT)
--Result--
[({'key': ['a', 'b', 'c'], 'value': [1, 2, 3]},)]
+--------------------+
--Query--
SELECT '{key_A=Duck, key_B="hello world"}'::MAP(VARCHAR, VARCHAR)
--Result--
[({'key': ['key_A', 'key_B'], 'value': ['Duck', 'hello world']},)]
+--------------------+
--Query--
SELECT '{1=Duck, 2=hello world, 3=!}'::MAP(INT, VARCHAR)
--Result--
[({'key': [1, 2, 3], 'value': ['Duck', 'hello world', '!']},)]
+--------------------+
--Query--
SELECT '{greetings=[Hello World!, Hello DuckDB, Howdy], farewells=[Bye World, Bye DuckDB]}'::MAP(VARCHAR, VARCHAR[])
--Result--
[({'key': ['greetings', 'farewells'], 'value': [['Hello World!', 'Hello DuckDB', 'Howdy'], ['Bye World', 'Bye DuckDB']]},)]
+--------------------+
--Query--
SELECT '{"key=A"=Duck, "key=B"="hello=world"}'::MAP(VARCHAR, VARCHAR)
--Result--
[({'key': ['key=A', 'key=B'], 'value': ['Duck', 'hello=world']},)]
+--------------------+
--Query--
SELECT '{{1=100, 2=200}=value}'::MAP(MAP(INT, INT), VARCHAR)
--Result--
[({'key': [{'key': [1, 2], 'value': [100, 200]}], 'value': ['value']},)]
+--------------------+
--Query--
SELECT '{{1=100, 2=200}={3=c, 5=e, 7=g}}'::MAP(MAP(INT, INT), MAP(INT, VARCHAR))
--Result--
[({'key': [{'key': [1, 2], 'value': [100, 200]}], 'value': [{'key': [3, 5, 7], 'value': ['c', 'e', 'g']}]},)]
+--------------------+
--Query--
SELECT CAST('{''hello''=2, ''world''=50, ''!''=12}' AS MAP(VARCHAR, INT))
--Result--
[({'key': ['hello', 'world', '!'], 'value': [2, 50, 12]},)]
+--------------------+
--Query--
SELECT CAST('{''''hello''''=hello, ''''world''''=world, ''''!''''=!}' AS MAP(VARCHAR, VARCHAR))
--Result--
[({'key': ["'hello'", "'world'", "'!'"], 'value': ['hello', 'world', '!']},)]
+--------------------+
--Query--
SELECT CAST('{"can''t"="you''re", "i''m"="q''u''o''t''e"}' AS MAP(VARCHAR, VARCHAR))
--Result--
[({'key': ["can't", "i'm"], 'value': ["you're", "q'u'o't'e"]},)]
+--------------------+
--Query--
SELECT CAST('{"{"="}", "["="]"}' AS MAP(VARCHAR, VARCHAR))
--Result--
[({'key': ['{', '['], 'value': ['}', ']']},)]
+--------------------+
--Query--
SELECT CAST('{''}''="{", '']''="["}' AS MAP(VARCHAR, VARCHAR))
--Result--
[({'key': ['}', ']'], 'value': ['{', '[']},)]
+--------------------+
--Query--
SELECT ' {greetings    =[    Hello World  !, Hello     DuckDB  , Howdy ]  ,      farewells=  [Bye World, Bye DuckDB  ] }    '::MAP(VARCHAR, VARCHAR[])
--Result--
[({'key': ['greetings', 'farewells'], 'value': [['Hello World  !', 'Hello     DuckDB', 'Howdy'], ['Bye World', 'Bye DuckDB']]},)]
+--------------------+
--Query--
SELECT CAST('{ [12,     13,14]=val, [       8, 9         ]      =val, [ 4    ]=val   }' AS MAP(INT[], VARCHAR))
--Result--
[({'key': [[12, 13, 14], [8, 9], [4]], 'value': ['val', 'val', 'val']},)]
+--------------------+
--Query--
SELECT CAST('   { { a:[2,    3], b:  Duckster      }=         {50.0        =50}, {a    : [9,1,4], b:Duck          }
                ={  1      =    0}  }' AS MAP(STRUCT(a INT[], b VARCHAR), MAP(INT, DOUBLE)))
--Result--
[({'key': [{'a': [2, 3], 'b': 'Duckster'}, {'a': [9, 1, 4], 'b': 'Duck'}], 'value': [{'key': [50], 'value': [50.0]}, {'key': [1], 'value': [0.0]}]},)]
+--------------------+
--Query--
SELECT col1::MAP(VARCHAR, VARCHAR) FROM null_tbl
--Result--
[(None,), ({'key': ['key'], 'value': [None]},), ({'key': ['zero', 'key'], 'value': ['0', None]},)]
+--------------------+
--Query--
SELECT CAST(NULL AS MAP(INT, VARCHAR))
--Result--
[(None,)]
+--------------------+
--Query--
SELECT CAST('{12=34, 56=NULL, 910=1112, 1314=NULL}' AS MAP(INT, INT))
--Result--
[({'key': [12, 56, 910, 1314], 'value': [34, None, 1112, None]},)]
+--------------------+
--Query--
SELECT CAST('{}' AS MAP(INT, INT))
--Result--
[({'key': [], 'value': []},)]
+--------------------+
--Query--
SELECT TRY_CAST('Hello World' AS MAP(VARCHAR, VARCHAR))
--Result--
[(None,)]
+--------------------+
--Query--
SELECT TRY_CAST(col1 AS MAP(INT, INT)) FROM try_cast_tbl
--Result--
[(None,), (None,), ({'key': [3, 5], 'value': [None, None]},), (None,), ({'key': [5, 7], 'value': [None, 7000]},), (None,)]
+--------------------+
--Query--
SELECT col1::MAP(INT, VARCHAR) FROM Duck_tbl WHERE cardinality(cast(col1 as MAP(INT, VARCHAR))) < 3
--Result--
[({'key': [1, 3], 'value': ['Duck', 'DB']},), ({'key': [12], 'value': ['DuckDB']},), ({'key': [0], 'value': ['DuckParty']},), ({'key': [1], 'value': ['final Quack']},)]
+--------------------+
--Query--
SELECT CAST('{{a:Meow=Meow}={a:12, b:0.8, c:MeowMeow}, {a:Quack}={a:13, b:3.2, c:QuackQuack}}' AS MAP(STRUCT(a VARCHAR), STRUCT(a INT, b DOUBLE, c VARCHAR)))
--Result--
[({'key': [{'a': 'Meow=Meow'}, {'a': 'Quack'}], 'value': [{'a': 12, 'b': 0.8, 'c': 'MeowMeow'}, {'a': 13, 'b': 3.2, 'c': 'QuackQuack'}]},)]
+--------------------+
--Query--
SELECT '{[[a, b], [c, d], [e]]= {a:2000}, [[aaa]]={a:100}, [[z],[y], [x]]={}}'::MAP(VARCHAR[][], STRUCT(a INT))
--Result--
[({'key': [[['a', 'b'], ['c', 'd'], ['e']], [['aaa']], [['z'], ['y'], ['x']]], 'value': [{'a': 2000}, {'a': 100}, {'a': None}]},)]
+--------------------+
--Query--
SELECT CAST('{a=True, b=False, z=true, X=FALSE}' AS MAP(VARCHAR, BOOL))
--Result--
[({'key': ['a', 'b', 'z', 'X'], 'value': [True, False, True, False]},)]
+--------------------+
--Query--
SELECT CAST('{True=[true, FALSE, true], False=[false, false, false]}' AS MAP(BOOL, BOOL[]))
--Result--
[({'key': [True, False], 'value': [[True, False, True], [False, False, False]]},)]
+--------------------+
--Query--
SELECT '{ok=happy, sad=ok}'::MAP(MOOD, MOOD)
--Result--
[({'key': ['ok', 'sad'], 'value': ['happy', 'ok']},)]
+--------------------+
--Query--
SELECT MAX(CAST(col AS MAP(INT, INT))) FROM intMap
--Result--
[({'key': [9999], 'value': [10000]},)]
+--------------------+
--Query--
SELECT * FROM assembled_maps
--Result--
[({'key': [8], 'value': ['hello, DuckDB']},)]
+--------------------+
