--Query--
SELECT r % 2, r, r//3, mode(r//3) over (partition by r % 2 order by r) FROM modes ORDER BY 1, 2
--Result--
[(None, None, None, None), (None, None, None, None), (None, None, None, None), (0, 0, 0, 0), (0, 2, 0, 0), (0, 4, 1, 0), (0, 6, 2, 0), (0, 8, 2, 0), (1, 1, 0, 0), (1, 3, 1, 0), (1, 5, 1, 1), (1, 7, 2, 1), (1, 9, 3, 1)]
+--------------------+
--Query--
SELECT r, r//3, mode(r//3) over (order by r rows between 1 preceding and 1 following)  FROM modes  ORDER BY ALL
--Result--
[(None, None, None), (None, None, None), (None, None, 0), (0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 1, 1), (4, 1, 1), (5, 1, 1), (6, 2, 2), (7, 2, 2), (8, 2, 2), (9, 3, 2)]
+--------------------+
--Query--
SELECT r, r//3, mode(r//3) over (order by r rows between 1 preceding and 3 following) FROM modes ORDER BY 1, 2
--Result--
[(None, None, 0), (None, None, 0), (None, None, 0), (0, 0, 0), (1, 0, 0), (2, 0, 1), (3, 1, 1), (4, 1, 1), (5, 1, 2), (6, 2, 2), (7, 2, 2), (8, 2, 2), (9, 3, 2)]
+--------------------+
--Query--
SELECT r, r // 3, n, mode(n) over (partition by r % 3 order by r) FROM (SELECT r, CASE r % 2 WHEN 0 THEN r ELSE NULL END AS n FROM modes) nulls ORDER BY 1
--Result--
[(None, None, None, None), (None, None, None, None), (None, None, None, None), (0, 0, 0, 0), (1, 0, None, None), (2, 0, 2, 2), (3, 1, None, 0), (4, 1, 4, 4), (5, 1, None, 2), (6, 2, 6, 0), (7, 2, None, 4), (8, 2, 8, 2), (9, 3, None, 0)]
+--------------------+
--Query--
SELECT r, n, mode(n) over (order by r rows between 1 preceding and 1 following) FROM (SELECT r, CASE r % 2 WHEN 0 THEN r ELSE NULL END AS n FROM modes) nulls ORDER BY ALL
--Result--
[(None, None, None), (None, None, None), (None, None, 0), (0, 0, 0), (1, None, 0), (2, 2, 2), (3, None, 2), (4, 4, 4), (5, None, 4), (6, 6, 6), (7, None, 6), (8, 8, 8), (9, None, 8)]
+--------------------+
--Query--
SELECT r, n, mode(n) over (order by r rows between 1 preceding and 3 following) FROM (SELECT r, CASE r % 2 WHEN 0 THEN r ELSE NULL END AS n FROM modes) nulls ORDER BY 1
--Result--
[(None, None, 0), (None, None, 0), (None, None, 0), (0, 0, 0), (1, None, 0), (2, 2, 2), (3, None, 2), (4, 4, 4), (5, None, 4), (6, 6, 6), (7, None, 6), (8, 8, 8), (9, None, 8)]
+--------------------+
--Query--
SELECT r, n, mode(n) over (order by r rows between unbounded preceding and unbounded following) FROM (SELECT r, CASE r % 2 WHEN 0 THEN r ELSE NULL END AS n FROM modes) nulls ORDER BY 1
--Result--
[(None, None, 0), (None, None, 0), (None, None, 0), (0, 0, 0), (1, None, 0), (2, 2, 0), (3, None, 0), (4, 4, 0), (5, None, 0), (6, 6, 0), (7, None, 0), (8, 8, 0), (9, None, 0)]
+--------------------+
--Query--
WITH t(r) AS (VALUES (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (NULL), (NULL), (NULL)) SELECT r, r//3, mode(r//3) over (order by r rows between 1 preceding and 1 following)  FROM t  ORDER BY ALL
--Result--
[(None, None, None), (None, None, None), (None, None, 0), (0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 1, 1), (4, 1, 1), (5, 1, 1), (6, 2, 2), (7, 2, 2), (8, 2, 2), (9, 3, 2)]
+--------------------+
