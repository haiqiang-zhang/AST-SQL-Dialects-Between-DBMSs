--Query--
SELECT "id", "requested_date", "city", "wait_time", min("wait_time") OVER win_3d  FROM rides  WINDOW win_3d AS ( 	PARTITION BY "city"  	ORDER BY requested_date ASC  	RANGE BETWEEN INTERVAL 3 DAYS PRECEDING AND INTERVAL 1 DAYS PRECEDING)  ORDER BY "requested_date", "city", "id"
--Result--
[(5, datetime.date(2023, 1, 1), 'San Francisco', 1210, None), (10, datetime.date(2023, 1, 1), 'San Francisco', 856, None), (7, datetime.date(2023, 1, 2), 'San Francisco', 980, 856), (8, datetime.date(2023, 1, 2), 'San Francisco', 430, 856), (11, datetime.date(2023, 1, 2), 'San Francisco', 490, 856), (12, datetime.date(2023, 1, 2), 'San Francisco', 720, 856), (1, datetime.date(2023, 1, 3), 'San Francisco', 755, 430), (2, datetime.date(2023, 1, 3), 'San Francisco', 2880, 430), (4, datetime.date(2023, 1, 3), 'San Francisco', 2900, 430), (6, datetime.date(2023, 1, 4), 'San Francisco', 200, 430), (0, datetime.date(2023, 1, 5), 'San Francisco', 2925, 200), (3, datetime.date(2023, 1, 5), 'San Francisco', 1502, 200), (9, datetime.date(2023, 1, 5), 'San Francisco', 2999, 200)]
+--------------------+
