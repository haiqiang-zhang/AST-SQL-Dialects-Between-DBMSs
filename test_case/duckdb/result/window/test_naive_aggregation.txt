--Query--
SELECT depname, empno, salary, sum(salary) OVER (PARTITION BY depname ORDER BY empno) FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 7, 4200, 4200), ('develop', 8, 6000, 10200), ('develop', 9, 4500, 14700), ('develop', 10, 5200, 19900), ('develop', 11, 5200, 25100), ('personnel', 2, 3900, 3900), ('personnel', 5, 3500, 7400), ('sales', 1, 5000, 5000), ('sales', 3, 4800, 9800), ('sales', 4, 4800, 14600)]
+--------------------+
--Query--
SELECT sum(salary) OVER (PARTITION BY depname ORDER BY salary) ss FROM empsalary ORDER BY depname, ss
--Result--
[(4200,), (8700,), (19100,), (19100,), (25100,), (3500,), (7400,), (9600,), (9600,), (14600,)]
+--------------------+
--Query--
SELECT depname, min(salary) OVER (PARTITION BY depname ORDER BY salary, empno) m1, max(salary) OVER (PARTITION BY depname ORDER BY salary, empno) m2, AVG(salary) OVER (PARTITION BY depname ORDER BY salary, empno) m3 FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 4200, 4200, 4200.0), ('develop', 4200, 6000, 5020.0), ('develop', 4200, 4500, 4350.0), ('develop', 4200, 5200, 4633.333333333333), ('develop', 4200, 5200, 4775.0), ('personnel', 3500, 3900, 3700.0), ('personnel', 3500, 3500, 3500.0), ('sales', 4800, 5000, 4866.666666666667), ('sales', 4800, 4800, 4800.0), ('sales', 4800, 4800, 4800.0)]
+--------------------+
--Query--
SELECT depname, STDDEV_POP(salary) OVER (PARTITION BY depname ORDER BY salary, empno) s FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 0.0), ('develop', 627.375485654325), ('develop', 150.0), ('develop', 418.9935029992179), ('develop', 438.03538669838093), ('personnel', 200.0), ('personnel', 0.0), ('sales', 94.28090415820623), ('sales', 0.0), ('sales', 0.0)]
+--------------------+
--Query--
SELECT depname, COVAR_POP(salary, empno) OVER (PARTITION BY depname ORDER BY salary, empno) c FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 0.0), ('develop', 240.00000000000017), ('develop', 150.0), ('develop', 477.777777777778), ('develop', 606.2500000000002), ('personnel', -300.0), ('personnel', 0.0), ('sales', -111.11111111111086), ('sales', 0.0), ('sales', 0.0)]
+--------------------+
--Query--
SELECT 	 x 	,y 	,z 	,avg(x) OVER (PARTITION BY y) AS plain_window 	,avg(x) FILTER (WHERE x = 1) OVER (PARTITION BY y) AS x_filtered_window 	,avg(x) FILTER (WHERE z = 0) OVER (PARTITION BY y) AS z_filtered_window FROM filtering ORDER BY y, x
--Result--
[(0, 0.0, 0.0, 5.6, 1.0, 5.6), (1, 0.0, 0.0, 5.6, 1.0, 5.6), (8, 0.0, 0.0, 5.6, 1.0, 5.6), (9, 0.0, 0.0, 5.6, 1.0, 5.6), (10, 0.0, 0.0, 5.6, 1.0, 5.6), (2, 1.0, 1.0, 3.0, None, None), (3, 1.0, 1.0, 3.0, None, None), (4, 1.0, 1.0, 3.0, None, None), (5, 2.0, 2.0, 6.0, None, None), (6, 2.0, 2.0, 6.0, None, None), (7, 2.0, 2.0, 6.0, None, None)]
+--------------------+
--Query--
SELECT 	 x 	,y 	,z 	,count(*) OVER (PARTITION BY y) AS plain_window 	,count(*) FILTER (WHERE x = 1) OVER (PARTITION BY y) AS x_filtered_window 	,count(*) FILTER (WHERE z = 0) OVER (PARTITION BY y) AS z_filtered_window FROM filtering ORDER BY y, x
--Result--
[(0, 0.0, 0.0, 5, 1, 5), (1, 0.0, 0.0, 5, 1, 5), (8, 0.0, 0.0, 5, 1, 5), (9, 0.0, 0.0, 5, 1, 5), (10, 0.0, 0.0, 5, 1, 5), (2, 1.0, 1.0, 3, 0, 0), (3, 1.0, 1.0, 3, 0, 0), (4, 1.0, 1.0, 3, 0, 0), (5, 2.0, 2.0, 3, 0, 0), (6, 2.0, 2.0, 3, 0, 0), (7, 2.0, 2.0, 3, 0, 0)]
+--------------------+
--Query--
SELECT 	 x 	,y 	,z 	,median(x) OVER (PARTITION BY y) AS plain_window 	,median(x) FILTER (WHERE x = 1) OVER (PARTITION BY y) AS x_filtered_window 	,median(x) FILTER (WHERE z = 0) OVER (PARTITION BY y) AS z_filtered_window FROM filtering ORDER BY y, x
--Result--
[(0, 0.0, 0.0, 8.0, 1.0, 8.0), (1, 0.0, 0.0, 8.0, 1.0, 8.0), (8, 0.0, 0.0, 8.0, 1.0, 8.0), (9, 0.0, 0.0, 8.0, 1.0, 8.0), (10, 0.0, 0.0, 8.0, 1.0, 8.0), (2, 1.0, 1.0, 3.0, None, None), (3, 1.0, 1.0, 3.0, None, None), (4, 1.0, 1.0, 3.0, None, None), (5, 2.0, 2.0, 6.0, None, None), (6, 2.0, 2.0, 6.0, None, None), (7, 2.0, 2.0, 6.0, None, None)]
+--------------------+
--Query--
SELECT x, count(x) FILTER (WHERE x % 2 = 0) OVER (ORDER BY x ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) FROM generate_series(0,10) tbl(x)
--Result--
[(0, 2), (1, 2), (2, 3), (3, 2), (4, 3), (5, 2), (6, 3), (7, 2), (8, 3), (9, 2), (10, 2)]
+--------------------+
--Query--
SELECT i 	, s 	, COUNT(DISTINCT s) OVER( ORDER BY i ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS c FROM figure1 ORDER BY i
--Result--
[(1, 'a', 2), (2, 'b', 3), (3, 'b', 3), (4, 'c', 2), (5, 'c', 2), (6, 'b', 3), (7, 'c', 3), (8, 'a', 3)]
+--------------------+
--Query--
SELECT i 	, s 	, COUNT(DISTINCT s) OVER( ORDER BY i ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING EXCLUDE TIES) AS c FROM figure1 ORDER BY i
--Result--
[(1, 'a', 2), (2, 'b', 3), (3, 'b', 3), (4, 'c', 2), (5, 'c', 2), (6, 'b', 3), (7, 'c', 3), (8, 'a', 3)]
+--------------------+
