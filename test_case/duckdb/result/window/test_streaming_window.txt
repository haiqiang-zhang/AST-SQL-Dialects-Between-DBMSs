--Query--
PREPARE sw1 AS 	SELECT i, row_number() OVER() AS row_no 	FROM range(10, 20) tbl(i) 	QUALIFY row_no <= ?::BIGINT
--Result--
[]
+--------------------+
--Query--
explain select first_value(i IGNORE NULLS) over () from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   first_value(integers.i  │\n│    IGNORE NULLS) OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│FIRST_VALUE(i IGNORE NULLS)│\n│           OVER ()         │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
EXPLAIN SELECT i, COUNT(*) OVER() FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│      count() OVER ()      │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
EXPLAIN SELECT i, SUM(i) OVER() FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│       sum(i) OVER ()      │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
EXPLAIN SELECT j, COUNT(j) FILTER(WHERE i = 2) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             j             │\n│ count(integers.j) FILTER  │\n│(WHERE (integers.i = 2...  │\n│   (ROWS BETWEEN UNBOUNDED │\n│ PRECEDING AND CURRENT ROW)│\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│count(j) FILTER (WHERE (i =│\n│   2)) OVER (ROWS BETWEEN  │\n│   UNBOUNDED PRECEDING AND │\n│        CURRENT ROW)       │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             j             │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
EXPLAIN SELECT j, SUM(j) FILTER(WHERE i = 2) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             j             │\n│  sum(integers.j) FILTER   │\n│(WHERE (integers.i = 2...  │\n│  (ROWS BETWEEN UNBOUNDED  │\n│ PRECEDING AND CURRENT ROW)│\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│sum(j) FILTER (WHERE (i = 2│\n│   )) OVER (ROWS BETWEEN   │\n│ UNBOUNDED PRECEDING A...  │\n│            ROW)           │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             j             │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
explain select row_number() over (), i, j from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│    row_number() OVER ()   │\n│             i             │\n│             j             │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│    ROW_NUMBER() OVER ()   │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
select row_number() over (), i, j from integers
--Result--
[(1, 2, 2), (2, 2, 1), (3, 1, 2), (4, 1, None)]
+--------------------+
--Query--
explain select rank() over (), i, j from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│       rank() OVER ()      │\n│             i             │\n│             j             │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│       RANK() OVER ()      │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
select rank() over (), i, j from integers
--Result--
[(1, 2, 2), (1, 2, 1), (1, 1, 2), (1, 1, None)]
+--------------------+
--Query--
explain select dense_rank() over (), i, j from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│    dense_rank() OVER ()   │\n│             i             │\n│             j             │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│    RANK_DENSE() OVER ()   │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
select dense_rank() over (), i, j from integers
--Result--
[(1, 2, 2), (1, 2, 1), (1, 1, 2), (1, 1, None)]
+--------------------+
--Query--
explain select percent_rank() over (), i, j from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   percent_rank() OVER ()  │\n│             i             │\n│             j             │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   PERCENT_RANK() OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
select percent_rank() over (), i, j from integers
--Result--
[(0.0, 2, 2), (0.0, 2, 1), (0.0, 1, 2), (0.0, 1, None)]
+--------------------+
--Query--
EXPLAIN SELECT i, COUNT(*) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│ count() OVER (ROWS BETWEEN│\n│   UNBOUNDED PRECEDING AND │\n│        CURRENT ROW)       │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
SELECT i, COUNT(*) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[(2, 1), (2, 2), (1, 3), (1, 4)]
+--------------------+
--Query--
EXPLAIN SELECT j, COUNT(j) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│count(j) OVER (ROWS BETWEEN│\n│   UNBOUNDED PRECEDING AND │\n│        CURRENT ROW)       │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
SELECT j, COUNT(j) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[(2, 1), (1, 2), (2, 3), (None, 3)]
+--------------------+
--Query--
EXPLAIN SELECT i, SUM(i) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│ sum(i) OVER (ROWS BETWEEN │\n│   UNBOUNDED PRECEDING AND │\n│        CURRENT ROW)       │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
EXPLAIN SELECT i, SUM(i) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│ sum(i) OVER (ROWS BETWEEN │\n│   UNBOUNDED PRECEDING AND │\n│        CURRENT ROW)       │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
SELECT i, SUM(i) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM integers
--Result--
[(2, 2), (2, 4), (1, 5), (1, 6)]
+--------------------+
--Query--
EXPLAIN SELECT SUM(s) FROM ( 	SELECT SUM(i) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) s 	FROM range(5000) tbl(i) )
--Result--
[('physical_plan', '┌───────────────────────────┐\n│    UNGROUPED_AGGREGATE    │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          sum(#0)          │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             s             │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             s             │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│ sum(i) OVER (ROWS BETWEEN │\n│   UNBOUNDED PRECEDING AND │\n│        CURRENT ROW)       │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           RANGE           │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          EC: 5000         │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
SELECT SUM(s) FROM ( 	SELECT SUM(i) OVER(ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) s 	FROM range(5000) tbl(i) )
--Result--
[(20833332500,)]
+--------------------+
--Query--
explain select i, j, first_value(i) over (), first_value(j) over () from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n│             #3            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   FIRST_VALUE(i) OVER ()  │\n│   FIRST_VALUE(j) OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
select i, j, first_value(i) over (), first_value(j) over () from integers
--Result--
[(2, 2, 2, 2), (2, 1, 2, 2), (1, 2, 2, 2), (1, None, 2, 2)]
+--------------------+
--Query--
select row_number() over (), first_value(i) over (), first_value(j) over () from integers
--Result--
[(1, 2, 2), (2, 2, 2), (3, 2, 2), (4, 2, 2)]
+--------------------+
--Query--
select row_number() over (), row_number() over () from integers
--Result--
[(1, 1), (2, 2), (3, 3), (4, 4)]
+--------------------+
--Query--
explain select first_value(i IGNORE NULLS) over () from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   first_value(integers.i  │\n│    IGNORE NULLS) OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│FIRST_VALUE(i IGNORE NULLS)│\n│           OVER ()         │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
explain select first_value(i) over (), last_value(i) over () from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│  first_value(integers.i)  │\n│           OVER ()         │\n│last_value(integers.i) OVER│\n│             ()            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #2            │\n│             #1            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   FIRST_VALUE(i) OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   LAST_VALUE(i) OVER ()   │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
explain select last_value(i) over (), first_value(i) over () from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│last_value(integers.i) OVER│\n│             ()            │\n│  first_value(integers.i)  │\n│           OVER ()         │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   FIRST_VALUE(i) OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   LAST_VALUE(i) OVER ()   │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
explain select first_value(i) over (), last_value(i) over (order by j) from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│  first_value(integers.i)  │\n│           OVER ()         │\n│last_value(integers.i) OVER│\n│    (ORDER BY integers.j)  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #3            │\n│             #2            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   FIRST_VALUE(i) OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│ LAST_VALUE(i) OVER (ORDER │\n│    BY j ASC NULLS LAST)   │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
explain select last_value(i) over (order by j), first_value(i) over () from integers
--Result--
[('physical_plan', '┌───────────────────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│last_value(integers.i) OVER│\n│    (ORDER BY integers.j)  │\n│  first_value(integers.i)  │\n│           OVER ()         │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         PROJECTION        │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             #0            │\n│             #1            │\n│             #2            │\n│             #3            │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│      STREAMING_WINDOW     │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│   FIRST_VALUE(i) OVER ()  │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│           WINDOW          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│ LAST_VALUE(i) OVER (ORDER │\n│    BY j ASC NULLS LAST)   │\n└─────────────┬─────────────┘                             \n┌─────────────┴─────────────┐\n│         SEQ_SCAN          │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│          integers         │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│             i             │\n│             j             │\n│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │\n│           EC: 4           │\n└───────────────────────────┘                             \n')]
+--------------------+
--Query--
SELECT id AS sparse_id, row_number() OVER () AS rnum FROM vertices_view
--Result--
[(11, 1), (12, 2), (13, 3), (21, 4), (22, 5)]
+--------------------+
--Query--
WITH RECURSIVE rte AS ( 	SELECT 1 l, 1::BIGINT r 	UNION  ALL 	SELECT l+1, row_number() OVER() 	FROM rte 	WHERE l < 3 ) SELECT * FROM rte
--Result--
[(1, 1), (2, 1), (3, 1)]
+--------------------+
--Query--
EXECUTE sw1(10)
--Result--
[(10, 1), (11, 2), (12, 3), (13, 4), (14, 5), (15, 6), (16, 7), (17, 8), (18, 9), (19, 10)]
+--------------------+
--Query--
EXECUTE sw1(2)
--Result--
[(10, 1), (11, 2)]
+--------------------+
