--Query--
select COUNT(*) from (SELECT * FROM a UNION ALL SELECT * FROM b) t1 join (select 43) t2(l) on t1.l=t2.l
--Result--
[(1,)]
+--------------------+
--Query--
select COUNT(*) from (SELECT * FROM a UNION ALL SELECT * FROM b) t1
--Result--
[(2,)]
+--------------------+
--Query--
select COUNT(*) from (SELECT i, j, MIN(k), MIN(l) FROM a GROUP BY i, j UNION ALL SELECT * FROM b) t1
--Result--
[(2,)]
+--------------------+
--Query--
select COUNT(*) from (SELECT DISTINCT i, j, k, l FROM a UNION ALL SELECT * FROM b) t1
--Result--
[(2,)]
+--------------------+
--Query--
select COUNT(*) from (SELECT DISTINCT * FROM (SELECT DISTINCT i, j, k, l FROM a UNION ALL SELECT * FROM b) t1) t2
--Result--
[(2,)]
+--------------------+
--Query--
select COUNT(*) from (SELECT * FROM a UNION ALL SELECT * FROM b UNION ALL SELECT a.i,a.j,a.k,a.l FROM a,b) t1
--Result--
[(3,)]
+--------------------+
--Query--
select COUNT(*) from (SELECT * FROM a UNION SELECT * FROM b UNION SELECT a.i,a.j,a.k,a.l FROM a,b) t1
--Result--
[(2,)]
+--------------------+
--Query--
select COUNT(*) from (SELECT * FROM a WHERE 1=0 UNION ALL SELECT * FROM b) t1
--Result--
[(1,)]
+--------------------+
--Query--
select j from (SELECT * FROM a WHERE i=42 UNION ALL SELECT * FROM b) t1 WHERE i=40
--Result--
[(41,)]
+--------------------+
--Query--
select j from (SELECT i, COUNT(*) j, COUNT(*) k, COUNT(*) l FROM a WHERE i=42 GROUP BY i UNION ALL SELECT * FROM b) t1 WHERE i=40
--Result--
[(41,)]
+--------------------+
--Query--
select j from (SELECT i i, i j, k, l FROM a UNION ALL SELECT * FROM b) t1 WHERE i=40 AND j=41
--Result--
[(41,)]
+--------------------+
--Query--
select * from (select 'hello' i union all select 'h' i) t1 where i='h'
--Result--
[('h',)]
+--------------------+
--Query--
select COUNT(*) from (SELECT * FROM a UNION ALL SELECT * FROM b) t1 join (select 43) t2(l) on t1.l=t2.l
--Result--
[(1,)]
+--------------------+
--Query--
select MIN(t2.b) from (SELECT * FROM a UNION ALL SELECT * FROM b) t1 join (select 43, 'hello', 44, 'world') t2(l, a, b, c) on t1.l=t2.l
--Result--
[(44,)]
+--------------------+
