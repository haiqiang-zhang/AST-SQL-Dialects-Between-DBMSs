--Query--
SELECT x, y FROM t1 UNION ALL BY NAME SELECT y, z FROM t2
--Result--
[(3, 3, None), (1, 1, None), (None, 2, 2), (None, 4, 4)]
+--------------------+
--Query--
SELECT t1.x FROM t1 UNION ALL BY NAME SELECT x FROM t1 ORDER BY t1.x
--Result--
[(1,), (1,), (3,), (3,)]
+--------------------+
--Query--
SELECT x FROM t1 UNION ALL BY NAME SELECT x FROM t1 ORDER BY t1.x
--Result--
[(1,), (1,), (3,), (3,)]
+--------------------+
--Query--
(SELECT x FROM t1 UNION ALL SELECT x FROM t1) UNION ALL BY NAME SELECT 5 ORDER BY t1.x
--Result--
[(None, 5), (1, None), (1, None), (3, None), (3, None)]
+--------------------+
--Query--
(SELECT x FROM t1 UNION ALL SELECT y FROM t1) UNION ALL BY NAME SELECT 5 ORDER BY y
--Result--
[(None, 5), (1, None), (1, None), (3, None), (3, None)]
+--------------------+
--Query--
(SELECT x FROM t1 UNION ALL SELECT y FROM t1) UNION ALL BY NAME (SELECT z FROM t2 UNION ALL SELECT y FROM t2) ORDER BY y, z
--Result--
[(None, 2), (None, 2), (None, 4), (None, 4), (1, None), (1, None), (3, None), (3, None)]
+--------------------+
--Query--
(SELECT x FROM t1 UNION ALL SELECT y FROM t1) UNION ALL BY NAME (SELECT z FROM t2 UNION ALL SELECT y FROM t2) ORDER BY t1.y
--Result--
[(None, 2), (None, 4), (None, 2), (None, 4), (1, None), (1, None), (3, None), (3, None)]
+--------------------+
--Query--
SELECT 1 UNION ALL BY NAME SELECT * FROM range(2, 100) UNION ALL BY NAME SELECT 999 LIMIT 5
--Result--
[(1, None, None), (None, 2, None), (None, 3, None), (None, 4, None), (None, 5, None)]
+--------------------+
--Query--
SELECT x, y FROM t1 UNION ALL BY NAME SELECT y, z FROM t2 ORDER BY z DESC
--Result--
[(3, 3, None), (1, 1, None), (None, 4, 4), (None, 2, 2)]
+--------------------+
--Query--
SELECT x, y FROM t1 UNION ALL BY NAME SELECT y, z FROM t2 ORDER BY y
--Result--
[(1, 1, None), (None, 2, 2), (3, 3, None), (None, 4, 4)]
+--------------------+
--Query--
SELECT x, y FROM t1 UNION ALL BY NAME SELECT y, z FROM t2 ORDER BY 3
--Result--
[(3, 3, None), (1, 1, None), (None, 2, 2), (None, 4, 4)]
+--------------------+
--Query--
(SELECT x FROM t1 ORDER BY y) UNION ALL BY NAME (SELECT y FROM t2 ORDER BY z) ORDER BY x DESC
--Result--
[(None, 2), (None, 4), (3, None), (1, None)]
+--------------------+
--Query--
SELECT 1 UNION ALL BY NAME SELECT x, y FROM t1 UNION ALL BY NAME SELECT y, z FROM t2
--Result--
[(1, None, None, None), (None, 3, 3, None), (None, 1, 1, None), (None, None, 2, 2), (None, None, 4, 4)]
+--------------------+
--Query--
SELECT x, y FROM t1 UNION ALL BY NAME SELECT y, z FROM t2 INTERSECT SELECT 2, 2 FROM t1
--Result--
[(3, 3, None), (1, 1, None), (None, 2, 2)]
+--------------------+
--Query--
SELECT x, x as a FROM t1 UNION ALL BY NAME SELECT y FROM t2
--Result--
[(3, 3, None), (1, 1, None), (None, None, 2), (None, None, 4)]
+--------------------+
--Query--
SELECT x as a FROM t1 UNION ALL BY NAME SELECT x FROM t1
--Result--
[(3, None), (1, None), (None, 3), (None, 1)]
+--------------------+
--Query--
SELECT DISTINCT ON(x) x FROM (SELECT 1 as x UNION ALL BY NAME SELECT '1' as x)
--Result--
[('1',)]
+--------------------+
--Query--
SELECT * FROM new_table
--Result--
[(3, 3, None), (1, 1, None), (None, 2, 2), (None, 4, 4)]
+--------------------+
