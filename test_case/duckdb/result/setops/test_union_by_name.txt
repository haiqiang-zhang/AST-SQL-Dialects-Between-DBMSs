--Query--
SELECT t1.x FROM t1 UNION BY NAME SELECT x FROM t1 ORDER BY t1.x
--Result--
[(1,), (3,)]
+--------------------+
--Query--
SELECT x FROM t1 UNION BY NAME SELECT x FROM t1 ORDER BY t1.x
--Result--
[(1,), (3,)]
+--------------------+
--Query--
(SELECT x FROM t1 UNION ALL SELECT x FROM t1) UNION BY NAME SELECT 5 ORDER BY t1.x
--Result--
[(None, 5), (1, None), (3, None)]
+--------------------+
--Query--
(SELECT x FROM t1 UNION ALL SELECT y FROM t1) UNION BY NAME SELECT 5 ORDER BY y
--Result--
[(None, 5), (1, None), (3, None)]
+--------------------+
--Query--
(SELECT x FROM t1 UNION ALL SELECT y FROM t1) UNION BY NAME (SELECT z FROM t2 UNION ALL SELECT y FROM t2) ORDER BY y, z
--Result--
[(None, 2), (None, 4), (1, None), (3, None)]
+--------------------+
--Query--
SELECT 1 UNION BY NAME SELECT * FROM range(2, 100) UNION BY NAME SELECT 999 ORDER BY #2, #1 LIMIT 5
--Result--
[(None, None, 999), (1, None, None), (None, 2, None), (None, 3, None), (None, 4, None)]
+--------------------+
--Query--
SELECT x, y FROM t1 UNION BY NAME SELECT y, z FROM t2 ORDER BY y
--Result--
[(1, 1, None), (None, 2, 2), (3, 3, None), (None, 4, 4)]
+--------------------+
--Query--
SELECT x, y FROM t1 UNION BY NAME SELECT y, z FROM t2 ORDER BY 3, 1
--Result--
[(1, 1, None), (3, 3, None), (None, 2, 2), (None, 4, 4)]
+--------------------+
--Query--
(SELECT 1 UNION BY NAME SELECT x, y FROM t1) UNION BY NAME SELECT y, z FROM t2 ORDER BY ALL
--Result--
[(None, None, 2, 2), (None, None, 4, 4), (None, 1, 1, None), (None, 3, 3, None), (1, None, None, None)]
+--------------------+
--Query--
SELECT x, y FROM t1 UNION BY NAME (SELECT y, z FROM t2 INTERSECT SELECT 2, 2 FROM t1 ORDER BY #1) ORDER BY #1
--Result--
[(None, 2, 2), (1, 1, None), (3, 3, None)]
+--------------------+
--Query--
(SELECT x, y FROM t1 UNION BY NAME SELECT y, z FROM t2 ORDER BY #1) EXCEPT SELECT NULL, 2, 2 FROM t1 ORDER BY #1
--Result--
[(None, 4, 4), (1, 1, None), (3, 3, None)]
+--------------------+
--Query--
SELECT x, x as a FROM t1 UNION BY NAME SELECT y FROM t2 ORDER BY #1, #3
--Result--
[(None, None, 2), (None, None, 4), (1, 1, None), (3, 3, None)]
+--------------------+
--Query--
SELECT x as a FROM t1 UNION BY NAME SELECT x FROM t1 ORDER BY #1, #2
--Result--
[(None, 1), (None, 3), (1, None), (3, None)]
+--------------------+
--Query--
select '0' as c union all select 0 as c
--Result--
[('0',), ('0',)]
+--------------------+
--Query--
select '0' as c union all by name select 0 as c
--Result--
[('0',), ('0',)]
+--------------------+
--Query--
select {'a': '0'} as c union all by name select {'a': 0} as c
--Result--
[({'a': '0'},), ({'a': '0'},)]
+--------------------+
