--Query--
PRAGMA enable_verification
--Result--
[]
+--------------------+
--Query--
select j, i, sum(i) over () from a order by 1,2
--Result--
[(datetime.timedelta(days=360), 2, 10), (datetime.timedelta(days=360), 4, 10), (datetime.timedelta(days=720), 1, 10), (datetime.timedelta(days=720), 3, 10)]
+--------------------+
--Query--
select j, i, sum(i) over (partition by j) from a order by 1,2
--Result--
[(datetime.timedelta(days=360), 2, 6), (datetime.timedelta(days=360), 4, 6), (datetime.timedelta(days=720), 1, 4), (datetime.timedelta(days=720), 3, 4)]
+--------------------+
--Query--
select j, i, sum(i) over (partition by j order by i) from a order by 1,2
--Result--
[(datetime.timedelta(days=360), 2, 2), (datetime.timedelta(days=360), 4, 6), (datetime.timedelta(days=720), 1, 1), (datetime.timedelta(days=720), 3, 4)]
+--------------------+
