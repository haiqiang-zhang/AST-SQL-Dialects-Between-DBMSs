--Query--
PRAGMA enable_verification
--Result--
[]
+--------------------+
--Query--
SELECT depname, empno, salary, sum(salary) OVER (PARTITION BY depname ORDER BY empno) FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 7, 4200, 4200), ('develop', 8, 6000, 10200), ('develop', 9, 4500, 14700), ('develop', 10, 5200, 19900), ('develop', 11, 5200, 25100), ('personnel', 2, 3900, 3900), ('personnel', 5, 3500, 7400), ('sales', 1, 5000, 5000), ('sales', 3, 4800, 9800), ('sales', 4, 4800, 14600)]
+--------------------+
--Query--
SELECT sum(salary) OVER (PARTITION BY depname ORDER BY salary) ss FROM empsalary ORDER BY depname, ss
--Result--
[(4200,), (8700,), (19100,), (19100,), (25100,), (3500,), (7400,), (9600,), (9600,), (14600,)]
+--------------------+
--Query--
SELECT row_number() OVER (PARTITION BY depname ORDER BY salary) rn FROM empsalary ORDER BY depname, rn
--Result--
[(1,), (2,), (3,), (4,), (5,), (1,), (2,), (1,), (2,), (3,)]
+--------------------+
--Query--
SELECT empno, first_value(empno) OVER (PARTITION BY depname ORDER BY empno) fv FROM empsalary ORDER BY 2 DESC, 1 ASC
--Result--
[(7, 7), (8, 7), (9, 7), (10, 7), (11, 7), (2, 2), (5, 2), (1, 1), (3, 1), (4, 1)]
+--------------------+
--Query--
SELECT depname, empno, 	last_value(empno) OVER ( 		PARTITION BY depname ORDER BY empno ASC 		ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING 		) fv FROM empsalary ORDER BY 1, 2
--Result--
[('develop', 7, 11), ('develop', 8, 11), ('develop', 9, 11), ('develop', 10, 11), ('develop', 11, 11), ('personnel', 2, 5), ('personnel', 5, 5), ('sales', 1, 4), ('sales', 3, 4), ('sales', 4, 4)]
+--------------------+
--Query--
SELECT depname, salary, dense_rank() OVER (PARTITION BY depname ORDER BY salary) FROM empsalary order by depname, salary
--Result--
[('develop', 4200, 1), ('develop', 4500, 2), ('develop', 5200, 3), ('develop', 5200, 3), ('develop', 6000, 4), ('personnel', 3500, 1), ('personnel', 3900, 2), ('sales', 4800, 1), ('sales', 4800, 1), ('sales', 5000, 2)]
+--------------------+
--Query--
SELECT depname, salary, rank() OVER (PARTITION BY depname ORDER BY salary) FROM empsalary order by depname, salary
--Result--
[('develop', 4200, 1), ('develop', 4500, 2), ('develop', 5200, 3), ('develop', 5200, 3), ('develop', 6000, 5), ('personnel', 3500, 1), ('personnel', 3900, 2), ('sales', 4800, 1), ('sales', 4800, 1), ('sales', 5000, 3)]
+--------------------+
--Query--
SELECT depname, min(salary) OVER (PARTITION BY depname ORDER BY salary, empno) m1, max(salary) OVER (PARTITION BY depname ORDER BY salary, empno) m2, AVG(salary) OVER (PARTITION BY depname ORDER BY salary, empno) m3 FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 4200, 4200, 4200.0), ('develop', 4200, 6000, 5020.0), ('develop', 4200, 4500, 4350.0), ('develop', 4200, 5200, 4633.333333333333), ('develop', 4200, 5200, 4775.0), ('personnel', 3500, 3900, 3700.0), ('personnel', 3500, 3500, 3500.0), ('sales', 4800, 5000, 4866.666666666667), ('sales', 4800, 4800, 4800.0), ('sales', 4800, 4800, 4800.0)]
+--------------------+
--Query--
SELECT depname, STDDEV_POP(salary) OVER (PARTITION BY depname ORDER BY salary, empno) s FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 0.0), ('develop', 627.375485654325), ('develop', 150.0), ('develop', 418.9935029992179), ('develop', 438.03538669838093), ('personnel', 200.0), ('personnel', 0.0), ('sales', 94.28090415820623), ('sales', 0.0), ('sales', 0.0)]
+--------------------+
--Query--
SELECT depname, COVAR_POP(salary, empno) OVER (PARTITION BY depname ORDER BY salary, empno) c FROM empsalary ORDER BY depname, empno
--Result--
[('develop', 0.0), ('develop', 240.00000000000017), ('develop', 150.0), ('develop', 477.777777777778), ('develop', 606.2500000000002), ('personnel', -300.0), ('personnel', 0.0), ('sales', -111.11111111111086), ('sales', 0.0), ('sales', 0.0)]
+--------------------+
