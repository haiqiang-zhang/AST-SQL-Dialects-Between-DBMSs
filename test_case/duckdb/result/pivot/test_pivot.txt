--Query--
SELECT DaysToManufacture, AVG(StandardCost) AS AverageCost FROM Product GROUP BY DaysToManufacture
--Result--
[(0, 5.0), (1, 224.0), (2, 359.0), (4, 949.0)]
+--------------------+
--Query--
SELECT 'AverageCost' AS Cost_Sorted_By_Production_Days,   "0", "1", "2", "3", "4" FROM (   SELECT DaysToManufacture, StandardCost   FROM Product ) AS SourceTable PIVOT (   AVG(StandardCost)   FOR DaysToManufacture IN (0, 1, 2, 3, 4) ) AS PivotTable
--Result--
[('AverageCost', 5.0, 224.0, 359.0, None, 949.0)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN ('JAN', 'FEB', 'MAR', 'APR'))       AS p   ORDER BY EMPID
--Result--
[(1, 10400, 8000, 11000, 18000), (2, 39500, 90700, 12000, 5300)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount+1) FOR MONTH IN ('JAN', 'FEB', 'MAR', 'DEC'))       AS p   ORDER BY EMPID
--Result--
[(1, 10402, 8002, 11002, None), (2, 39502, 90702, 12002, None)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(COUNT(*) FOR MONTH IN ('JAN', 'FEB', 'MAR', 'DEC') GROUP BY empid)       AS p   ORDER BY EMPID
--Result--
[(1, 2, 2, 2, 0), (2, 2, 2, 2, 0)]
+--------------------+
--Query--
SELECT empid, January, February, March, April   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN ('JAN' AS January, 'FEB' AS February, 'MAR' AS March, 'APR' AS April))       AS p   ORDER BY EMPID
--Result--
[(1, 10400, 8000, 11000, 18000), (2, 39500, 90700, 12000, 5300)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN ('JAN', 'FEB', 'MAR'))       AS p   ORDER BY EMPID
--Result--
[(1, 10400, 8000, 11000), (2, 39500, 90700, 12000)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN ('JAN', 'FEB', 'MAR', 'DEC'))       AS p   ORDER BY EMPID
--Result--
[(1, 10400, 8000, 11000, None), (2, 39500, 90700, 12000, None)]
+--------------------+
--Query--
SELECT * FROM monthly_sales PIVOT(SUM(amount) FOR MONTH IN ('JAN', 'FEB', 'MAR', 'APR'))   AS p (EMP_ID_renamed, JAN, FEB, MAR, APR) ORDER BY EMP_ID_renamed
--Result--
[(1, 10400, 8000, 11000, 18000), (2, 39500, 90700, 12000, 5300)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN (NULL, 'JAN', 'FEB', 'MAR', 'APR'))       AS p   ORDER BY EMPID
--Result--
[(1, 250, 10400, 8000, 11000, 18000), (2, None, 39500, 90700, 12000, 5300)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN (NULL, 'JAN', 'FEB', 'MAR', 'APR'))       AS p     UNPIVOT INCLUDE NULLS(amount FOR MONTH IN ("NULL", JAN, FEB, MAR, APR))   ORDER BY ALL
--Result--
[(1, 'APR', 18000), (1, 'FEB', 8000), (1, 'JAN', 10400), (1, 'MAR', 11000), (1, 'NULL', 250), (2, 'APR', 5300), (2, 'FEB', 90700), (2, 'JAN', 39500), (2, 'MAR', 12000), (2, 'NULL', None)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN (NULL, 'JAN', 'FEB', 'MAR', 'APR'))       AS p     UNPIVOT EXCLUDE NULLS(amount FOR MONTH IN ("NULL", JAN, FEB, MAR, APR))   ORDER BY ALL
--Result--
[(1, 'APR', 18000), (1, 'FEB', 8000), (1, 'JAN', 10400), (1, 'MAR', 11000), (1, 'NULL', 250), (2, 'APR', 5300), (2, 'FEB', 90700), (2, 'JAN', 39500), (2, 'MAR', 12000)]
+--------------------+
--Query--
SELECT *   FROM monthly_sales     PIVOT(SUM(amount) FOR MONTH IN (NULL, 'JAN', 'FEB', 'MAR', 'APR'))       AS p     UNPIVOT EXCLUDE NULLS(amount FOR MONTH IN ("NULL", JAN, FEB, MAR, APR))   ORDER BY EMPID
--Result--
[(1, 'NULL', 250), (1, 'JAN', 10400), (1, 'FEB', 8000), (1, 'MAR', 11000), (1, 'APR', 18000), (2, 'JAN', 39500), (2, 'FEB', 90700), (2, 'MAR', 12000), (2, 'APR', 5300)]
+--------------------+
--Query--
FROM (   SELECT DaysToManufacture, StandardCost   FROM Product ) AS SourceTable PIVOT (   AVG(StandardCost)   FOR DaysToManufacture IN ('zz') ) AS PivotTable
--Result--
[(None,)]
+--------------------+
