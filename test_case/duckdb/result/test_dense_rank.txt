--Query--
PRAGMA enable_verification
--Result--
[]
+--------------------+
--Query--
WITH t AS ( 	SELECT i, DENSE_RANK() OVER (ORDER BY i % 50) AS d 	FROM range(3000) tbl(i) ), w AS ( 	SELECT d, COUNT(*) as c 	FROM t 	GROUP BY ALL ) SELECT COUNT(*), MIN(d), MAX(d), MIN(c), MAX(c) FROM w
--Result--
[(50, 1, 50, 60, 60)]
+--------------------+
--Query--
WITH t AS ( 	SELECT i, DENSE_RANK() OVER (PARTITION BY i // 3000 ORDER BY i % 50) AS d 	FROM range(9000) tbl(i) ), w AS ( 	SELECT d, COUNT(*) as c 	FROM t 	GROUP BY ALL ) SELECT COUNT(*), MIN(d), MAX(d), MIN(c), MAX(c) FROM w
--Result--
[(50, 1, 50, 180, 180)]
+--------------------+
--Query--
WITH dups AS (   SELECT ROW_NUMBER() OVER same_idx AS dup   , COUNT(*) OVER same_idx AS n_dup   , (DENSE_RANK() OVER asc_spcmn) + (DENSE_RANK() OVER desc_spcmn) - 1 AS n_spcmn   , *   FROM issue9416   WINDOW same_idx AS (     PARTITION BY idx     ORDER BY source, project, specimen     ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING   )   , asc_spcmn AS (     PARTITION BY idx     ORDER BY specimen ASC NULLS FIRST     ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING   )   , desc_spcmn AS (     PARTITION BY idx     ORDER BY specimen DESC NULLS LAST     ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING   ) ) SELECT * FROM dups WHERE n_spcmn > 1 ORDER BY idx, dup
--Result--
[(1, 3, 3, '3afcae2318313f112b62536fa160678d', 'json', '24ed1657', '08b8de7c543d', '129c0a0fd3e82a8'), (2, 3, 3, '3afcae2318313f112b62536fa160678d', 'json', '24ed1657', '5311f290', '129c0a0fd3e82a8'), (3, 3, 3, '3afcae2318313f112b62536fa160678d', 'json', '24ed1657', 'ce001fa3a2a4', '129c0a0fd3e82a8'), (1, 2, 2, '6193ffd18b0da96e80e2a38baac9a7e4', 'json', '14b5b262c52400', '3c03d64c34', '1b5cfdd6a5de'), (2, 2, 2, '6193ffd18b0da96e80e2a38baac9a7e4', 'rprt', '1a5cf3833', None, '1b5cfdd6a5de'), (1, 3, 3, '79acd6669071e95a5b2fe5456216ab32', 'json', '24ed1657', '08b8de7c543d', '129c0a0fd3e82a8'), (2, 3, 3, '79acd6669071e95a5b2fe5456216ab32', 'json', '24ed1657', '5311f290', '129c0a0fd3e82a8'), (3, 3, 3, '79acd6669071e95a5b2fe5456216ab32', 'json', '24ed1657', 'ce001fa3a2a4', '129c0a0fd3e82a8'), (1, 3, 3, 'a59a3a4ad8d2ab867c9b830974588645', 'json', '24ed1657', '08b8de7c543d', '129c0a0fd3e82a8'), (2, 3, 3, 'a59a3a4ad8d2ab867c9b830974588645', 'json', '24ed1657', '5311f290', '129c0a0fd3e82a8'), (3, 3, 3, 'a59a3a4ad8d2ab867c9b830974588645', 'json', '24ed1657', 'ce001fa3a2a4', '129c0a0fd3e82a8'), (1, 2, 2, 'c6eb00fb5a023557439a9b898c7cc3ea', 'json', 'd6b3921920', 'a63d8', 'f891b965f2561d9'), (2, 2, 2, 'c6eb00fb5a023557439a9b898c7cc3ea', 'rprt', 'd6b3921920', None, 'f891b965f2561d9'), (1, 2, 2, 'c8360bd0e28ea5bbffd66e76886bbccb', 'json', 'd6b3921920', 'a63d8', '0e06e1f9f6580fb'), (2, 2, 2, 'c8360bd0e28ea5bbffd66e76886bbccb', 'rprt', 'd6b3921920', None, '0e06e1f9f6580fb'), (1, 3, 3, 'd0a7e9d3eda115120021a895a81db8be', 'json', '24ed1657', '08b8de7c543d', '129c0a0fd3e82a8'), (2, 3, 3, 'd0a7e9d3eda115120021a895a81db8be', 'json', '24ed1657', '5311f290', '129c0a0fd3e82a8'), (3, 3, 3, 'd0a7e9d3eda115120021a895a81db8be', 'json', '24ed1657', 'ce001fa3a2a4', '129c0a0fd3e82a8'), (1, 2, 2, 'ecf1739fed72151784dab88dbe2f2aa9', 'json', '14b5b262c52400', '3c03d64c34', '1b5cfdd6a5de'), (2, 2, 2, 'ecf1739fed72151784dab88dbe2f2aa9', 'rprt', '1a5cf3833', None, '1b5cfdd6a5de')]
+--------------------+
