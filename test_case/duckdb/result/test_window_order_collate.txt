--Query--
PRAGMA enable_verification
--Result--
[]
+--------------------+
--Query--
select     *,     array_agg(col) over(partition by id order by col collate nocase) as lead_col_nocase from ( 	select  		unnest(array[1, 1, 1, 1]) as id,  		unnest(array['A', 'a', 'b', 'B']) as col )
--Result--
[(1, 'A', ['A', 'a']), (1, 'a', ['A', 'a']), (1, 'b', ['A', 'a', 'b', 'B']), (1, 'B', ['A', 'a', 'b', 'B'])]
+--------------------+
--Query--
SELECT name, city, row_number() OVER (PARTITION BY city) AS row_id  FROM db_city
--Result--
[('DuckDB', 'Amsterdam', 1), ('MonetDB', 'amsterdam', 2), ('VectorWise', 'AmstÃ\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â\x83Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â«rdam', 1)]
+--------------------+
--Query--
SELECT name, city, row_number() OVER (PARTITION BY city COLLATE NOCASE) AS row_id  FROM db_city
--Result--
[('DuckDB', 'Amsterdam', 1), ('MonetDB', 'amsterdam', 2), ('VectorWise', 'AmstÃ\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â\x83Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â«rdam', 1)]
+--------------------+
