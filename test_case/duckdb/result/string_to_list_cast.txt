--Query--
PRAGMA enable_verification
--Result--
[]
+--------------------+
--Query--
COPY (SELECT [1,2,3]) TO '__TEST_DIR__/int_list.csv'
--Result--
[(1,)]
+--------------------+
--Query--
COPY int_list FROM '__TEST_DIR__/int_list.csv'
--Result--
[(1,)]
+--------------------+
--Query--
COPY (SELECT [8,7,6], '[hello, Duck''DB]', '[2022-12-2, 1929-01-25]') TO '__TEST_DIR__/assorted_lists.csv' (Header 0)
--Result--
[(1,)]
+--------------------+
--Query--
COPY assorted_lists FROM '__TEST_DIR__/assorted_lists.csv'
--Result--
[(1,)]
+--------------------+
--Query--
SELECT '[12,13,14]'::INT[]
--Result--
[([12, 13, 14],)]
+--------------------+
--Query--
SELECT '["hello", "world", "!"]'::VARCHAR[]
--Result--
[(['"hello"', '"world"', '"!"'],)]
+--------------------+
--Query--
SELECT CAST('[Hello World!]' AS VARCHAR[])
--Result--
[(['Hello World!'],)]
+--------------------+
--Query--
SELECT CAST('[[Hello World!], hello, universe]' AS VARCHAR[])
--Result--
[(['[Hello World!]', 'hello', 'universe'],)]
+--------------------+
--Query--
SELECT '[Cast like this]':: VARCHAR[]
--Result--
[(['Cast like this'],)]
+--------------------+
--Query--
select UNNEST('[NULL, , NULL]'::varchar[])
--Result--
[(None,), ('',), (None,)]
+--------------------+
--Query--
select UNNEST('[NULL,, NULL]'::varchar[])
--Result--
[(None,), ('',), (None,)]
+--------------------+
--Query--
select UNNEST('[NULL,   , NULL]'::varchar[])
--Result--
[(None,), ('',), (None,)]
+--------------------+
--Query--
SELECT UNNEST('[NULL, NULL , ]'::varchar[])
--Result--
[(None,), (None,), ('',)]
+--------------------+
--Query--
SELECT UNNEST('[NULL, NULL ,]'::varchar[])
--Result--
[(None,), (None,), ('',)]
+--------------------+
--Query--
SELECT UNNEST('[NULL, NULL,]'::varchar[])
--Result--
[(None,), (None,), ('',)]
+--------------------+
--Query--
SELECT CAST('[ [12,13,14], [8, 9], [4], [2, 1, 0] ]' AS INT[][])
--Result--
[([[12, 13, 14], [8, 9], [4], [2, 1, 0]],)]
+--------------------+
--Query--
SELECT CAST('[ [[12,13,14], [8, 9]], [[4]], [[2, 1, 0], [99]] ]' AS INT[][][])
--Result--
[([[[12, 13, 14], [8, 9]], [[4]], [[2, 1, 0], [99]]],)]
+--------------------+
--Query--
SELECT CAST('[ [12,13,14], [8, 9], [4], [2,  1,  0] ]' AS VARCHAR[])
--Result--
[(['[12,13,14]', '[8, 9]', '[4]', '[2,  1,  0]'],)]
+--------------------+
--Query--
SELECT CAST('[[ [ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ, ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ, ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ]], [[duck, db, ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ], [ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ]], [[ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ, duck, db]]]' AS VARCHAR[][][])
--Result--
[([[['Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86', 'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86', 'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86']], [['duck', 'db', 'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86'], ['Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86']], [['Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86', 'duck', 'db']]],)]
+--------------------+
--Query--
SELECT col1::VARCHAR[] FROM stringList
--Result--
[(['"hello"', '"world"', '"!"'],), (['"Amazing"', '"text"'],), (['Hello World!'],)]
+--------------------+
--Query--
SELECT col1::VARCHAR[][] FROM nestedStrings
--Result--
[([['"hello"'], ['"world"'], ['"!"']],), ([['"Amazing"'], ['"text"']],), ([['Hello World!']],)]
+--------------------+
--Query--
SELECT col1::VARCHAR[][][][][] FROM superNestedStrings
--Result--
[([[[[['"hello"']]], [[['"world"'], ['"!"']]]]],), ([[[[['"Amazing"']], [['"text"']]]]],), ([[[[['Hello World!']]]]],)]
+--------------------+
--Query--
SELECT col1::INT[] FROM tbl
--Result--
[([1, 2, 2],), ([345, 67865, 44, 4],), ([5, 6, 7],)]
+--------------------+
--Query--
SELECT col1::INT[][] FROM doubleNested
--Result--
[([[1, 2], [2]],), ([[345], [67865, 44, 4]],), ([[5], [6, 7]],)]
+--------------------+
--Query--
SELECT col1::INT[][][] FROM tripleNested
--Result--
[([[[1, 2], [3]]],), ([[[4]]],)]
+--------------------+
--Query--
SELECT col1::INT[][][][][][] FROM crazyNested
--Result--
[([[[[[[1]], [[3, 4, 9]]], [[[0, 1]]]]]],), ([[[[[[4]]]]]],)]
+--------------------+
--Query--
SELECT CAST('[''hello'',''world'', ''!'']' AS VARCHAR[])
--Result--
[(["'hello'", "'world'", "'!'"],)]
+--------------------+
--Query--
SELECT CAST('[''''hello'''',''''world'''', ''''!'''']' AS VARCHAR[])
--Result--
[(["''hello''", "''world''", "''!''"],)]
+--------------------+
--Query--
SELECT CAST('[[ [''ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ, ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ, ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ'']], [[duck, db, ''ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ''] ]]' AS VARCHAR[][][])
--Result--
[([[["'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86, Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86, Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86'"]], [['duck', 'db', "'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86'"]]],)]
+--------------------+
--Query--
SELECT CAST('["can''t", "you''re", "i''m"]' AS VARCHAR[])
--Result--
[(['"can\'t"', '"you\'re"', '"i\'m"'],)]
+--------------------+
--Query--
SELECT CAST('[can''t, you''re, i''m]' AS VARCHAR[])
--Result--
[(["can't", "you're", "i'm"],)]
+--------------------+
--Query--
SELECT CAST('["]", "hello", "world"]' AS VARCHAR[])
--Result--
[(['"]"', '"hello"', '"world"'],)]
+--------------------+
--Query--
SELECT CAST('['']'', "hello", "world"]' AS VARCHAR[])
--Result--
[(["']'", '"hello"', '"world"'],)]
+--------------------+
--Query--
SELECT CAST('[ [12,     13,14], [8, 9         ], [ 4    ], [    2, 1,     0] ]  ' AS INT[][])
--Result--
[([[12, 13, 14], [8, 9], [4], [2, 1, 0]],)]
+--------------------+
--Query--
SELECT CAST('[          [ [12,     13,14], [8, 9         ]  ],[[ 4    ]   ],        [[    2, 1,     0 ]         ] ]  ' AS INT[][][])
--Result--
[([[[12, 13, 14], [8, 9]], [[4]], [[2, 1, 0]]],)]
+--------------------+
--Query--
SELECT CAST('["   hello","          ''  world", "!         "]' AS VARCHAR[])
--Result--
[(['"   hello"', '"          \'  world"', '"!         "'],)]
+--------------------+
--Query--
SELECT CAST('[   hello     ,   world      , !         ]' AS VARCHAR[])
--Result--
[(['hello', 'world', '!'],)]
+--------------------+
--Query--
SELECT CAST('[    [ "   hello"]  ,["            world"        ],[ "!        "           ]      ]' AS VARCHAR[][])
--Result--
[([['"   hello"'], ['"            world"'], ['"!        "']],)]
+--------------------+
--Query--
SELECT '[]'::VARCHAR[]
--Result--
[([],)]
+--------------------+
--Query--
SELECT '[]'::INT[]
--Result--
[([],)]
+--------------------+
--Query--
SELECT '[]'::INT[][][][]
--Result--
[([],)]
+--------------------+
--Query--
SELECT '[[1, 2, 3], [], [	], [  ]]'::INT[][]
--Result--
[([[1, 2, 3], [], [], []],)]
+--------------------+
--Query--
SELECT '[[1, 2, 3], [], NULL, [NULL], [4, NULL]]'::INT[][]
--Result--
[([[1, 2, 3], [], None, [None], [4, None]],)]
+--------------------+
--Query--
SELECT col1::INT[] FROM null_tbl
--Result--
[(None,), (None,), ([None],)]
+--------------------+
--Query--
SELECT CAST(NULL AS INT[])
--Result--
[(None,)]
+--------------------+
--Query--
SELECT CAST('[NULL]' AS INT[])
--Result--
[([None],)]
+--------------------+
--Query--
SELECT CAST('[NULL]' AS INT[][])
--Result--
[([None],)]
+--------------------+
--Query--
SELECT CAST('[[12,13,14], [8, 9], NULL, [2, 1]]' AS INT[][])
--Result--
[([[12, 13, 14], [8, 9], None, [2, 1]],)]
+--------------------+
--Query--
SELECT CAST('[[12,13,14], [8, 9], [2, NULL, 1]]' AS INT[][])
--Result--
[([[12, 13, 14], [8, 9], [2, None, 1]],)]
+--------------------+
--Query--
SELECT CAST('[ [[12,13,14], NULL], [[4]], NULL, [[2, NULL, 1, 0], [99]] ]' AS INT[][][])
--Result--
[([[[12, 13, 14], None], [[4]], None, [[2, None, 1, 0], [99]]],)]
+--------------------+
--Query--
SELECT TRY_CAST('Hello World' AS INT[])
--Result--
[(None,)]
+--------------------+
--Query--
SELECT TRY_CAST(col1 AS INT[]) FROM try_cast_tbl
--Result--
[([1, 2, None, 2],), ([None],), ([345, None, 44, 4],), ([None],), ([5, 6, 7],), ([None, 1],)]
+--------------------+
--Query--
SELECT * FROM tbl WHERE cast(col1 as int[]) = [1, 2, 2]
--Result--
[('[1,2,2]',)]
+--------------------+
--Query--
SELECT col1 FROM tbl WHERE LEN(cast(col1 as int[])) < 4
--Result--
[('[1,2,2]',), ('[5,6,7]',)]
+--------------------+
--Query--
SELECT cast(col1 as int[]) FROM tbl WHERE LEN(cast(col1 as int[])) < 4
--Result--
[([1, 2, 2],), ([5, 6, 7],)]
+--------------------+
--Query--
SELECT col::STRUCT(a VARCHAR)[] FROM struct_tbl1
--Result--
[([{'a': 'hii'}, {'a': 'hellooo'}],)]
+--------------------+
--Query--
SELECT CAST('[ [{a:[12,13,14], b:"ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ"}], [{a:[12,13,14], b:"ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ", c:100}] ]' AS STRUCT(a INT[], b VARCHAR, c FLOAT)[][])
--Result--
[([[{'a': [12, 13, 14], 'b': 'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86', 'c': None}], [{'a': [12, 13, 14], 'b': 'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86', 'c': 100.0}]],)]
+--------------------+
--Query--
SELECT CAST('[{a:[12,13,14], b:"ÃÂÃÂÃÂÃÂ°ÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¦ÃÂÃÂÃÂÃÂ", c:{a:[[a], [b, c]], b:[123]}}]' AS STRUCT(a INT[], b VARCHAR, c STRUCT(a VARCHAR[][], b INT[]))[])
--Result--
[([{'a': [12, 13, 14], 'b': 'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86', 'c': {'a': [['a'], ['b', 'c']], 'b': [123]}}],)]
+--------------------+
--Query--
SELECT '[{a: hii}, {a: "{" }]'::STRUCT(a VARCHAR)[] FROM struct_tbl1
--Result--
[([{'a': 'hii'}, {'a': '{'}],)]
+--------------------+
--Query--
SELECT col::STRUCT(a INT, b VARCHAR)[] FROM struct_tbl2
--Result--
[([{'a': 7, 'b': 'Duck'}, {'a': 7000, 'b': 'Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86Ã\x83Â\x83Ã\x82Â\x83Ã\x83Â\x82Ã\x82Â°Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x9fÃ\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â¦Ã\x83Â\x83Ã\x82Â\x82Ã\x83Â\x82Ã\x82Â\x86'}],)]
+--------------------+
--Query--
SELECT col FROM int_list
--Result--
[([1, 2, 3],)]
+--------------------+
--Query--
SELECT * FROM assorted_lists
--Result--
[([8, 7, 6], ['hello', "Duck'DB"], [datetime.date(2022, 12, 2), datetime.date(1929, 1, 25)])]
+--------------------+
--Query--
select '[{"bar":"\""}]'::VARCHAR[]
--Result--
[(['{"bar":"\\""}'],)]
+--------------------+
--Query--
select '[{"bar":"\\\""}]'::VARCHAR[]
--Result--
[(['{"bar":"\\\\\\""}'],)]
+--------------------+
--Query--
select '[{"bar":"\"\"\\\"\"\"\\"}]'::VARCHAR[]
--Result--
[(['{"bar":"\\"\\"\\\\\\"\\"\\"\\\\"}'],)]
+--------------------+
