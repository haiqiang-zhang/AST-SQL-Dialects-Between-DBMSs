--Query--
PRAGMA enable_verification
--Result--
[]
+--------------------+
--Query--
PIVOT Cities ON Country, Name IN ('xx') USING SUM(Population)
--Result--
[(2000, None, None), (2010, None, None), (2020, None, None)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) UNION ALL BY NAME PIVOT Cities ON Name USING SUM(Population)
--Result--
[('US', 'Seattle', 564, 608, 738, None, None, None, None), ('US', 'New York City', 8015, 8175, 8772, None, None, None, None), ('NL', 'Amsterdam', 1005, 1065, 1158, None, None, None, None), ('NL', None, None, None, None, 2000, 1005, None, None), ('NL', None, None, None, None, 2010, 1065, None, None), ('US', None, None, None, None, 2020, None, 8772, 738), ('US', None, None, None, None, 2010, None, 8175, 608), ('US', None, None, None, None, 2000, None, 8015, 564), ('NL', None, None, None, None, 2020, 1158, None, None)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population)
--Result--
[('US', 'Seattle', 564, 608, 738), ('US', 'New York City', 8015, 8175, 8772), ('NL', 'Amsterdam', 1005, 1065, 1158)]
+--------------------+
--Query--
SELECT Country, Name, "2000_total_pop", "2010_total_pop", "2020_total_pop" FROM (PIVOT Cities ON Year USING SUM(Population) as total_pop)
--Result--
[('US', 'Seattle', 564, 608, 738), ('US', 'New York City', 8015, 8175, 8772), ('NL', 'Amsterdam', 1005, 1065, 1158)]
+--------------------+
--Query--
PIVOT_WIDER Cities ON Year USING SUM(Population)
--Result--
[('US', 'Seattle', 564, 608, 738), ('US', 'New York City', 8015, 8175, 8772), ('NL', 'Amsterdam', 1005, 1065, 1158)]
+--------------------+
--Query--
FROM Cities PIVOT (SUM(Population) FOR Year IN (2000, 2010, 2020))
--Result--
[('US', 'New York City', 8015, 8175, 8772), ('US', 'Seattle', 564, 608, 738), ('NL', 'Amsterdam', 1005, 1065, 1158)]
+--------------------+
--Query--
PIVOT Cities ON Year IN (2000, 2020) USING SUM(Population)
--Result--
[('US', 'Seattle', 564, 738), ('NL', 'Amsterdam', 1005, 1158), ('US', 'New York City', 8015, 8772)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) GROUP BY Country
--Result--
[('US', 8579, 8783, 9510), ('NL', 1005, 1065, 1158)]
+--------------------+
--Query--
FROM 	(PIVOT Cities ON Year USING SUM(Population) GROUP BY Country) JOIN 	(PIVOT Cities ON Name USING SUM(Population) GROUP BY Country) USING (Country)
--Result--
[('NL', 1005, 1065, 1158, 3228, None, None), ('US', 8579, 8783, 9510, None, 24962, 1910)]
+--------------------+
--Query--
PIVOT Cities ON (Country, Name) IN ('xx') USING SUM(Population)
--Result--
[(2000, None), (2010, None), (2020, None)]
+--------------------+
--Query--
PIVOT (SELECT Country, Population, Year FROM Cities) ON Year USING SUM(Population) as sum_pop, count(population) as count_pop,
--Result--
[('NL', 1005, 1, 1065, 1, 1158, 1), ('US', 8579, 2, 8783, 2, 9510, 2)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) as sum_pop, count(population) as count_pop, GROUP BY Country
--Result--
[('US', 8579, 2, 8783, 2, 9510, 2), ('NL', 1005, 1, 1065, 1, 1158, 1)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population), count(population) GROUP BY Country
--Result--
[('US', 8579, 2, 8783, 2, 9510, 2), ('NL', 1005, 1, 1065, 1, 1158, 1)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) GROUP BY country ORDER BY country desc
--Result--
[('US', 8579, 8783, 9510), ('NL', 1005, 1065, 1158)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) GROUP BY country ORDER BY country desc LIMIT 1
--Result--
[('US', 8579, 8783, 9510)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) GROUP BY country ORDER BY country LIMIT 1
--Result--
[('NL', 1005, 1065, 1158)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) GROUP BY country ORDER BY country LIMIT 1 OFFSET 1
--Result--
[('US', 8579, 8783, 9510)]
+--------------------+
--Query--
PIVOT Cities ON Year USING SUM(Population) GROUP BY country ORDER BY ALL
--Result--
[('NL', 1005, 1065, 1158), ('US', 8579, 8783, 9510)]
+--------------------+
--Query--
UNPIVOT PivotedCities ON 2000, 2010, 2020 INTO NAME Year VALUE Population
--Result--
[('US', 'Seattle', '2000', 564), ('US', 'Seattle', '2010', 608), ('US', 'Seattle', '2020', 738), ('NL', 'Amsterdam', '2000', 1005), ('NL', 'Amsterdam', '2010', 1065), ('NL', 'Amsterdam', '2020', 1158), ('US', 'New York City', '2000', 8015), ('US', 'New York City', '2010', 8175), ('US', 'New York City', '2020', 8772)]
+--------------------+
--Query--
FROM PivotedCities UNPIVOT(Population FOR Year IN (2000, 2010, 2020))
--Result--
[('US', 'Seattle', '2000', 564), ('US', 'Seattle', '2010', 608), ('US', 'Seattle', '2020', 738), ('NL', 'Amsterdam', '2000', 1005), ('NL', 'Amsterdam', '2010', 1065), ('NL', 'Amsterdam', '2020', 1158), ('US', 'New York City', '2000', 8015), ('US', 'New York City', '2010', 8175), ('US', 'New York City', '2020', 8772)]
+--------------------+
--Query--
UNPIVOT PivotedCities ON 2000, 2010, 2020
--Result--
[('US', 'Seattle', '2000', 564), ('US', 'Seattle', '2010', 608), ('US', 'Seattle', '2020', 738), ('NL', 'Amsterdam', '2000', 1005), ('NL', 'Amsterdam', '2010', 1065), ('NL', 'Amsterdam', '2020', 1158), ('US', 'New York City', '2000', 8015), ('US', 'New York City', '2010', 8175), ('US', 'New York City', '2020', 8772)]
+--------------------+
--Query--
UNPIVOT PivotedCities ON COLUMNS('\d+')
--Result--
[('US', 'Seattle', '2000', 564), ('US', 'Seattle', '2010', 608), ('US', 'Seattle', '2020', 738), ('NL', 'Amsterdam', '2000', 1005), ('NL', 'Amsterdam', '2010', 1065), ('NL', 'Amsterdam', '2020', 1158), ('US', 'New York City', '2000', 8015), ('US', 'New York City', '2010', 8175), ('US', 'New York City', '2020', 8772)]
+--------------------+
--Query--
UNPIVOT PivotedCities ON * EXCLUDE (Country, Name)
--Result--
[('US', 'Seattle', '2000', 564), ('US', 'Seattle', '2010', 608), ('US', 'Seattle', '2020', 738), ('NL', 'Amsterdam', '2000', 1005), ('NL', 'Amsterdam', '2010', 1065), ('NL', 'Amsterdam', '2020', 1158), ('US', 'New York City', '2000', 8015), ('US', 'New York City', '2010', 8175), ('US', 'New York City', '2020', 8772)]
+--------------------+
--Query--
PIVOT_LONGER PivotedCities ON 2000, 2010, 2020
--Result--
[('US', 'Seattle', '2000', 564), ('US', 'Seattle', '2010', 608), ('US', 'Seattle', '2020', 738), ('NL', 'Amsterdam', '2000', 1005), ('NL', 'Amsterdam', '2010', 1065), ('NL', 'Amsterdam', '2020', 1158), ('US', 'New York City', '2000', 8015), ('US', 'New York City', '2010', 8175), ('US', 'New York City', '2020', 8772)]
+--------------------+
--Query--
UNPIVOT PivotedCities ON 2000, 2010, 2020 ORDER BY ALL LIMIT 1
--Result--
[('NL', 'Amsterdam', '2000', 1005)]
+--------------------+
--Query--
UNPIVOT PivotedCities ON 2000, 2010, 2020 ORDER BY 1 LIMIT 1 OFFSET 1
--Result--
[('NL', 'Amsterdam', '2010', 1065)]
+--------------------+
