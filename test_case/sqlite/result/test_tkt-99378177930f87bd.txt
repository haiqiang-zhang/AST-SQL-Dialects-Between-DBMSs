--Query--
SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY a
--Result--
[(1, 2, 1, 16, 12), (2, 2, 1, 26, 22), (3, 1, 1, 6, 6)]
+--------------------+
--Query--
EXPLAIN   SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY a
--Result--
[(0, 'Init', 0, 66, 0, None, 0, None), (1, 'SorterOpen', 1, 3, 0, 'k(1,B)', 0, None), (2, 'Integer', 0, 2, 0, None, 0, None), (3, 'Null', 0, 5, 5, None, 0, None), (4, 'Gosub', 4, 62, 0, None, 0, None), (5, 'OpenRead', 0, 2, 0, '4', 0, None), (6, 'OpenRead', 2, 3, 0, 'k(5,,,,,)', 0, None), (7, 'Integer', 0, 7, 0, None, 0, None), (8, 'SeekGE', 2, 18, 7, '1', 0, None), (9, 'Integer', 10, 7, 0, None, 0, None), (10, 'IdxGT', 2, 18, 7, '1', 0, None), (11, 'DeferredSeek', 2, 0, 0, None, 0, None), (12, 'Column', 2, 1, 15, None, 0, None), (13, 'Column', 2, 2, 16, None, 0, None), (14, 'Column', 2, 3, 17, None, 0, None), (15, 'MakeRecord', 15, 3, 18, None, 0, None), (16, 'SorterInsert', 1, 18, 0, None, 0, None), (17, 'Next', 2, 10, 0, None, 0, None), (18, 'OpenPseudo', 3, 18, 3, None, 0, None), (19, 'SorterSort', 1, 65, 0, None, 0, None), (20, 'SorterData', 1, 18, 3, None, 0, None), (21, 'Column', 3, 0, 6, None, 0, None), (22, 'Compare', 5, 6, 1, 'k(1,B)', 0, None), (23, 'Jump', 24, 28, 24, None, 0, None), (24, 'Move', 6, 5, 1, None, 0, None), (25, 'Gosub', 3, 52, 0, None, 0, None), (26, 'IfPos', 2, 65, 0, None, 0, None), (27, 'Gosub', 4, 62, 0, None, 0, None), (28, 'Integer', 1, 19, 0, None, 0, None), (29, 'AggStep', 0, 19, 11, 'sum(1)', 1, None), (30, 'Column', 3, 1, 20, None, 0, None), (31, 'Ne', 21, 34, 20, None, 80, None), (32, 'Integer', 1, 19, 0, None, 0, None), (33, 'Goto', 0, 35, 0, None, 0, None), (34, 'Null', 0, 19, 0, None, 0, None), (35, 'AggStep', 0, 19, 12, 'sum(1)', 1, None), (36, 'Column', 3, 2, 19, None, 0, None), (37, 'AggStep', 0, 19, 13, 'sum(1)', 1, None), (38, 'Column', 3, 1, 20, None, 0, None), (39, 'Ne', 21, 42, 20, None, 80, None), (40, 'Column', 3, 2, 19, None, 0, None), (41, 'Goto', 0, 43, 0, None, 0, None), (42, 'Null', 0, 19, 0, None, 0, None), (43, 'AggStep', 0, 19, 14, 'sum(1)', 1, None), (44, 'If', 1, 46, 0, None, 0, None), (45, 'Column', 3, 0, 8, None, 0, None), (46, 'Integer', 1, 1, 0, None, 0, None), (47, 'SorterNext', 1, 20, 0, None, 0, None), (48, 'Gosub', 3, 52, 0, None, 0, None), (49, 'Goto', 0, 65, 0, None, 0, None), (50, 'Integer', 1, 2, 0, None, 0, None), (51, 'Return', 3, 0, 0, None, 0, None), (52, 'IfPos', 1, 54, 0, None, 0, None), (53, 'Return', 3, 0, 0, None, 0, None), (54, 'AggFinal', 11, 1, 0, 'sum(1)', 0, None), (55, 'AggFinal', 12, 1, 0, 'sum(1)', 0, None), (56, 'AggFinal', 13, 1, 0, 'sum(1)', 0, None), (57, 'AggFinal', 14, 1, 0, 'sum(1)', 0, None), (58, 'Copy', 8, 22, 0, None, 0, None), (59, 'Copy', 11, 23, 3, None, 0, None), (60, 'ResultRow', 22, 5, 0, None, 0, None), (61, 'Return', 3, 0, 0, None, 0, None), (62, 'Null', 0, 8, 14, None, 0, None), (63, 'Integer', 0, 1, 0, None, 0, None), (64, 'Return', 4, 0, 0, None, 0, None), (65, 'Halt', 0, 0, 0, None, 0, None), (66, 'Transaction', 0, 0, 2, '0', 1, None), (67, 'Integer', 1, 21, 0, None, 0, None), (68, 'Goto', 0, 1, 0, None, 0, None)]
+--------------------+
--Query--
SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY +a
--Result--
[(1, 2, 1, 16, 12), (2, 2, 1, 26, 22), (3, 1, 1, 6, 6)]
+--------------------+
--Query--
EXPLAIN   SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY +a
--Result--
[(0, 'Init', 0, 67, 0, None, 0, None), (1, 'SorterOpen', 1, 4, 0, 'k(1,B)', 0, None), (2, 'Integer', 0, 2, 0, None, 0, None), (3, 'Null', 0, 5, 5, None, 0, None), (4, 'Gosub', 4, 63, 0, None, 0, None), (5, 'OpenRead', 0, 2, 0, '4', 0, None), (6, 'OpenRead', 2, 3, 0, 'k(5,,,,,)', 0, None), (7, 'Integer', 0, 7, 0, None, 0, None), (8, 'SeekGE', 2, 19, 7, '1', 0, None), (9, 'Integer', 10, 7, 0, None, 0, None), (10, 'IdxGT', 2, 19, 7, '1', 0, None), (11, 'DeferredSeek', 2, 0, 0, None, 0, None), (12, 'Column', 2, 1, 15, None, 0, None), (13, 'Column', 2, 1, 16, None, 0, None), (14, 'Column', 2, 2, 17, None, 0, None), (15, 'Column', 2, 3, 18, None, 0, None), (16, 'MakeRecord', 15, 4, 19, None, 0, None), (17, 'SorterInsert', 1, 19, 0, None, 0, None), (18, 'Next', 2, 10, 0, None, 0, None), (19, 'OpenPseudo', 3, 19, 4, None, 0, None), (20, 'SorterSort', 1, 66, 0, None, 0, None), (21, 'SorterData', 1, 19, 3, None, 0, None), (22, 'Column', 3, 0, 6, None, 0, None), (23, 'Compare', 5, 6, 1, 'k(1,B)', 0, None), (24, 'Jump', 25, 29, 25, None, 0, None), (25, 'Move', 6, 5, 1, None, 0, None), (26, 'Gosub', 3, 53, 0, None, 0, None), (27, 'IfPos', 2, 66, 0, None, 0, None), (28, 'Gosub', 4, 63, 0, None, 0, None), (29, 'Integer', 1, 20, 0, None, 0, None), (30, 'AggStep', 0, 20, 11, 'sum(1)', 1, None), (31, 'Column', 3, 2, 21, None, 0, None), (32, 'Ne', 22, 35, 21, None, 80, None), (33, 'Integer', 1, 20, 0, None, 0, None), (34, 'Goto', 0, 36, 0, None, 0, None), (35, 'Null', 0, 20, 0, None, 0, None), (36, 'AggStep', 0, 20, 12, 'sum(1)', 1, None), (37, 'Column', 3, 3, 20, None, 0, None), (38, 'AggStep', 0, 20, 13, 'sum(1)', 1, None), (39, 'Column', 3, 2, 21, None, 0, None), (40, 'Ne', 22, 43, 21, None, 80, None), (41, 'Column', 3, 3, 20, None, 0, None), (42, 'Goto', 0, 44, 0, None, 0, None), (43, 'Null', 0, 20, 0, None, 0, None), (44, 'AggStep', 0, 20, 14, 'sum(1)', 1, None), (45, 'If', 1, 47, 0, None, 0, None), (46, 'Column', 3, 1, 8, None, 0, None), (47, 'Integer', 1, 1, 0, None, 0, None), (48, 'SorterNext', 1, 21, 0, None, 0, None), (49, 'Gosub', 3, 53, 0, None, 0, None), (50, 'Goto', 0, 66, 0, None, 0, None), (51, 'Integer', 1, 2, 0, None, 0, None), (52, 'Return', 3, 0, 0, None, 0, None), (53, 'IfPos', 1, 55, 0, None, 0, None), (54, 'Return', 3, 0, 0, None, 0, None), (55, 'AggFinal', 11, 1, 0, 'sum(1)', 0, None), (56, 'AggFinal', 12, 1, 0, 'sum(1)', 0, None), (57, 'AggFinal', 13, 1, 0, 'sum(1)', 0, None), (58, 'AggFinal', 14, 1, 0, 'sum(1)', 0, None), (59, 'Copy', 8, 23, 0, None, 0, None), (60, 'Copy', 11, 24, 3, None, 0, None), (61, 'ResultRow', 23, 5, 0, None, 0, None), (62, 'Return', 3, 0, 0, None, 0, None), (63, 'Null', 0, 8, 14, None, 0, None), (64, 'Integer', 0, 1, 0, None, 0, None), (65, 'Return', 4, 0, 0, None, 0, None), (66, 'Halt', 0, 0, 0, None, 0, None), (67, 'Transaction', 0, 0, 2, '0', 1, None), (68, 'Integer', 1, 22, 0, None, 0, None), (69, 'Goto', 0, 1, 0, None, 0, None)]
+--------------------+
--Query--
SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY a
--Result--
[(1, 2, 1, 16, 12), (2, 2, 1, 26, 22), (3, 1, 1, 6, 6)]
+--------------------+
--Query--
EXPLAIN   SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY a
--Result--
[(0, 'Init', 0, 57, 0, None, 0, None), (1, 'Noop', 1, 3, 0, None, 0, None), (2, 'Integer', 0, 2, 0, None, 0, None), (3, 'Null', 0, 5, 5, None, 0, None), (4, 'Gosub', 4, 53, 0, None, 0, None), (5, 'OpenRead', 0, 2, 0, '4', 0, None), (6, 'OpenRead', 2, 3, 0, 'k(5,,,,,)', 0, None), (7, 'Rewind', 2, 39, 7, '0', 0, None), (8, 'DeferredSeek', 2, 0, 0, None, 0, None), (9, 'Column', 2, 1, 7, None, 0, None), (10, 'Lt', 9, 38, 7, 'BINARY-8', 84, None), (11, 'Gt', 10, 38, 7, 'BINARY-8', 84, None), (12, 'Column', 2, 0, 6, None, 0, None), (13, 'Compare', 5, 6, 1, 'k(1,B)', 0, None), (14, 'Jump', 15, 19, 15, None, 0, None), (15, 'Move', 6, 5, 1, None, 0, None), (16, 'Gosub', 3, 43, 0, None, 0, None), (17, 'IfPos', 2, 56, 0, None, 0, None), (18, 'Gosub', 4, 53, 0, None, 0, None), (19, 'Integer', 1, 7, 0, None, 0, None), (20, 'AggStep', 0, 7, 14, 'sum(1)', 1, None), (21, 'Column', 2, 2, 8, None, 0, None), (22, 'Ne', 18, 25, 8, None, 80, None), (23, 'Integer', 1, 7, 0, None, 0, None), (24, 'Goto', 0, 26, 0, None, 0, None), (25, 'Null', 0, 7, 0, None, 0, None), (26, 'AggStep', 0, 7, 15, 'sum(1)', 1, None), (27, 'Column', 2, 3, 7, None, 0, None), (28, 'AggStep', 0, 7, 16, 'sum(1)', 1, None), (29, 'Column', 2, 2, 8, None, 0, None), (30, 'Ne', 18, 33, 8, None, 80, None), (31, 'Column', 2, 3, 7, None, 0, None), (32, 'Goto', 0, 34, 0, None, 0, None), (33, 'Null', 0, 7, 0, None, 0, None), (34, 'AggStep', 0, 7, 17, 'sum(1)', 1, None), (35, 'If', 1, 37, 0, None, 0, None), (36, 'Column', 2, 0, 11, None, 0, None), (37, 'Integer', 1, 1, 0, None, 0, None), (38, 'Next', 2, 8, 0, None, 1, None), (39, 'Gosub', 3, 43, 0, None, 0, None), (40, 'Goto', 0, 56, 0, None, 0, None), (41, 'Integer', 1, 2, 0, None, 0, None), (42, 'Return', 3, 0, 0, None, 0, None), (43, 'IfPos', 1, 45, 0, None, 0, None), (44, 'Return', 3, 0, 0, None, 0, None), (45, 'AggFinal', 14, 1, 0, 'sum(1)', 0, None), (46, 'AggFinal', 15, 1, 0, 'sum(1)', 0, None), (47, 'AggFinal', 16, 1, 0, 'sum(1)', 0, None), (48, 'AggFinal', 17, 1, 0, 'sum(1)', 0, None), (49, 'Copy', 11, 19, 0, None, 0, None), (50, 'Copy', 14, 20, 3, None, 0, None), (51, 'ResultRow', 19, 5, 0, None, 0, None), (52, 'Return', 3, 0, 0, None, 0, None), (53, 'Null', 0, 11, 17, None, 0, None), (54, 'Integer', 0, 1, 0, None, 0, None), (55, 'Return', 4, 0, 0, None, 0, None), (56, 'Halt', 0, 0, 0, None, 0, None), (57, 'Transaction', 0, 0, 4, '0', 1, None), (58, 'Integer', 0, 9, 0, None, 0, None), (59, 'Integer', 10, 10, 0, None, 0, None), (60, 'Integer', 1, 18, 0, None, 0, None), (61, 'Goto', 0, 1, 0, None, 0, None)]
+--------------------+
--Query--
SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY a
--Result--
[(1, 2, 1, 16, 12), (2, 2, 1, 26, 22), (3, 1, 1, 6, 6)]
+--------------------+
--Query--
EXPLAIN   SELECT a,          SUM(1)                              AS t1,          SUM(CASE WHEN b->>'x'=1 THEN 1 END) AS t2,          SUM(c)                              AS t3,          SUM(CASE WHEN b->>'x'=1 THEN c END) AS t4     FROM t1    WHERE d BETWEEN 0 and 10    GROUP BY a
--Result--
[(0, 'Init', 0, 57, 0, None, 0, None), (1, 'Noop', 1, 3, 0, None, 0, None), (2, 'Integer', 0, 2, 0, None, 0, None), (3, 'Null', 0, 5, 5, None, 0, None), (4, 'Gosub', 4, 53, 0, None, 0, None), (5, 'OpenRead', 0, 2, 0, '4', 0, None), (6, 'OpenRead', 2, 3, 0, 'k(5,,,,,)', 0, None), (7, 'Rewind', 2, 39, 7, '0', 0, None), (8, 'DeferredSeek', 2, 0, 0, None, 0, None), (9, 'Column', 2, 1, 7, None, 0, None), (10, 'Lt', 9, 38, 7, 'BINARY-8', 84, None), (11, 'Gt', 10, 38, 7, 'BINARY-8', 84, None), (12, 'Column', 2, 0, 6, None, 0, None), (13, 'Compare', 5, 6, 1, 'k(1,B)', 0, None), (14, 'Jump', 15, 19, 15, None, 0, None), (15, 'Move', 6, 5, 1, None, 0, None), (16, 'Gosub', 3, 43, 0, None, 0, None), (17, 'IfPos', 2, 56, 0, None, 0, None), (18, 'Gosub', 4, 53, 0, None, 0, None), (19, 'Integer', 1, 7, 0, None, 0, None), (20, 'AggStep', 0, 7, 14, 'sum(1)', 1, None), (21, 'Column', 2, 2, 8, None, 0, None), (22, 'Ne', 18, 25, 8, None, 80, None), (23, 'Integer', 1, 7, 0, None, 0, None), (24, 'Goto', 0, 26, 0, None, 0, None), (25, 'Null', 0, 7, 0, None, 0, None), (26, 'AggStep', 0, 7, 15, 'sum(1)', 1, None), (27, 'Column', 2, 3, 7, None, 0, None), (28, 'AggStep', 0, 7, 16, 'sum(1)', 1, None), (29, 'Column', 2, 2, 8, None, 0, None), (30, 'Ne', 18, 33, 8, None, 80, None), (31, 'Column', 2, 3, 7, None, 0, None), (32, 'Goto', 0, 34, 0, None, 0, None), (33, 'Null', 0, 7, 0, None, 0, None), (34, 'AggStep', 0, 7, 17, 'sum(1)', 1, None), (35, 'If', 1, 37, 0, None, 0, None), (36, 'Column', 2, 0, 11, None, 0, None), (37, 'Integer', 1, 1, 0, None, 0, None), (38, 'Next', 2, 8, 0, None, 1, None), (39, 'Gosub', 3, 43, 0, None, 0, None), (40, 'Goto', 0, 56, 0, None, 0, None), (41, 'Integer', 1, 2, 0, None, 0, None), (42, 'Return', 3, 0, 0, None, 0, None), (43, 'IfPos', 1, 45, 0, None, 0, None), (44, 'Return', 3, 0, 0, None, 0, None), (45, 'AggFinal', 14, 1, 0, 'sum(1)', 0, None), (46, 'AggFinal', 15, 1, 0, 'sum(1)', 0, None), (47, 'AggFinal', 16, 1, 0, 'sum(1)', 0, None), (48, 'AggFinal', 17, 1, 0, 'sum(1)', 0, None), (49, 'Copy', 11, 19, 0, None, 0, None), (50, 'Copy', 14, 20, 3, None, 0, None), (51, 'ResultRow', 19, 5, 0, None, 0, None), (52, 'Return', 3, 0, 0, None, 0, None), (53, 'Null', 0, 11, 17, None, 0, None), (54, 'Integer', 0, 1, 0, None, 0, None), (55, 'Return', 4, 0, 0, None, 0, None), (56, 'Halt', 0, 0, 0, None, 0, None), (57, 'Transaction', 0, 0, 4, '0', 1, None), (58, 'Integer', 0, 9, 0, None, 0, None), (59, 'Integer', 10, 10, 0, None, 0, None), (60, 'Integer', 1, 18, 0, None, 0, None), (61, 'Goto', 0, 1, 0, None, 0, None)]
+--------------------+
--Query--
SELECT * FROM t1 NATURAL JOIN t1     WHERE a==1       OR (            (SELECT avg(                 (SELECT sum((SELECT 1 FROM t1 NATURAL RIGHT JOIN t1 WHERE a=a)))) AS xyz            )            AND a==2          )
--Result--
[(1,), (2,)]
+--------------------+
--Query--
SELECT * FROM t1 NATURAL JOIN t1     WHERE a==1       OR (            (SELECT avg(                 (SELECT sum((SELECT 1 FROM t1 NATURAL RIGHT JOIN t1 WHERE a=a)))) AS xyz            )            AND a==2          )
--Result--
[(1,), (2,)]
+--------------------+
--Query--
SELECT count(*) FROM t1 NOT INDEXED WHERE (SELECT z FROM t3)
--Result--
[(0,)]
+--------------------+
