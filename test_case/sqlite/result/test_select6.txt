--Query--
SELECT DISTINCT y FROM t1 ORDER BY y
--Result--
[(1,), (2,), (3,), (4,), (5,)]
+--------------------+
--Query--
SELECT * FROM (SELECT x, y FROM t1 WHERE x<2)
--Result--
[(1, 1)]
+--------------------+
--Query--
SELECT count(*) FROM (SELECT y FROM t1)
--Result--
[(20,)]
+--------------------+
--Query--
SELECT *      FROM (SELECT count(*),y FROM t1 GROUP BY y) AS a,          (SELECT max(x),y FROM t1 GROUP BY y) as b     WHERE a.y=b.y ORDER BY a.y
--Result--
[(1, 1, 1, 1), (2, 2, 3, 2), (4, 3, 7, 3), (8, 4, 15, 4), (5, 5, 20, 5)]
+--------------------+
--Query--
SELECT a.y, a.[count(*)], [max(x)], [count(*)]     FROM (SELECT count(*),y FROM t1 GROUP BY y) AS a,          (SELECT max(x),y FROM t1 GROUP BY y) as b     WHERE a.y=b.y ORDER BY a.y
--Result--
[(1, 1, 1, 1), (2, 2, 3, 2), (3, 4, 7, 4), (4, 8, 15, 8), (5, 5, 20, 5)]
+--------------------+
--Query--
SELECT q, p, r     FROM (SELECT count(*) as p , y as q FROM t1 GROUP BY y) AS a,          (SELECT max(x) as r, y as s FROM t1 GROUP BY y) as b     WHERE q=s ORDER BY s
--Result--
[(1, 1, 1), (2, 2, 3), (3, 4, 7), (4, 8, 15), (5, 5, 20)]
+--------------------+
--Query--
SELECT q, p, r, b.[min(x)+y]     FROM (SELECT count(*) as p , y as q FROM t1 GROUP BY y) AS a,          (SELECT max(x) as r, y as s, min(x)+y FROM t1 GROUP BY y) as b     WHERE q=s ORDER BY s
--Result--
[(1, 1, 1, 2), (2, 2, 3, 4), (3, 4, 7, 7), (4, 8, 15, 12), (5, 5, 20, 21)]
+--------------------+
--Query--
SELECT DISTINCT b FROM t2 ORDER BY b
--Result--
[(1,), (2,), (3,), (4,), (5,)]
+--------------------+
--Query--
SELECT * FROM (SELECT a, b FROM t2 WHERE a<2)
--Result--
[(1, 1)]
+--------------------+
--Query--
SELECT *      FROM (SELECT count(*),b FROM t2 GROUP BY b) AS a,          (SELECT max(a),b FROM t2 GROUP BY b) as b     WHERE a.b=b.b ORDER BY a.b
--Result--
[(1, 1, 1, 1), (2, 2, 3, 2), (4, 3, 7, 3), (8, 4, 15, 4), (5, 5, 20, 5)]
+--------------------+
--Query--
SELECT a.b, a.[count(*)], [max(a)], [count(*)]     FROM (SELECT count(*),b FROM t2 GROUP BY b) AS a,          (SELECT max(a),b FROM t2 GROUP BY b) as b     WHERE a.b=b.b ORDER BY a.b
--Result--
[(1, 1, 1, 1), (2, 2, 3, 2), (3, 4, 7, 4), (4, 8, 15, 8), (5, 5, 20, 5)]
+--------------------+
--Query--
SELECT q, p, r     FROM (SELECT count(*) as p , b as q FROM t2 GROUP BY b) AS a,          (SELECT max(a) as r, b as s FROM t2 GROUP BY b) as b     WHERE q=s ORDER BY s
--Result--
[(1, 1, 1), (2, 2, 3), (3, 4, 7), (4, 8, 15), (5, 5, 20)]
+--------------------+
--Query--
SELECT a.q, a.p, b.r     FROM (SELECT count(*) as p , b as q FROM t2 GROUP BY q) AS a,          (SELECT max(a) as r, b as s FROM t2 GROUP BY s) as b     WHERE a.q=b.s ORDER BY a.q
--Result--
[(1, 1, 1), (2, 2, 3), (3, 4, 7), (4, 8, 15), (5, 5, 20)]
+--------------------+
--Query--
SELECT * FROM (SELECT * FROM (SELECT * FROM t1 WHERE x=3))
--Result--
[(3, 2)]
+--------------------+
--Query--
SELECT * FROM       (SELECT a.q, a.p, b.r        FROM (SELECT count(*) as p , b as q FROM t2 GROUP BY q) AS a,             (SELECT max(a) as r, b as s FROM t2 GROUP BY s) as b        WHERE a.q=b.s ORDER BY a.q)
--Result--
[(1, 1, 1), (2, 2, 3), (3, 4, 7), (4, 8, 15), (5, 5, 20)]
+--------------------+
--Query--
SELECT a,b,a+b FROM (SELECT avg(x) as 'a', avg(y) as 'b' FROM t1)
--Result--
[(10.5, 3.7, 14.2)]
+--------------------+
--Query--
SELECT a,b,a+b FROM (SELECT avg(x) as 'a', avg(y) as 'b' FROM t1 WHERE y=4)
--Result--
[(11.5, 4.0, 15.5)]
+--------------------+
--Query--
SELECT x,y,x+y FROM (SELECT avg(a) as 'x', avg(b) as 'y' FROM t2 WHERE a=4)
--Result--
[(4.0, 3.0, 7.0)]
+--------------------+
--Query--
SELECT a,b,a+b FROM (SELECT avg(x) as 'a', avg(y) as 'b' FROM t1)     WHERE a>10
--Result--
[(10.5, 3.7, 14.2)]
+--------------------+
--Query--
SELECT a,b,a+b FROM (SELECT avg(x) as 'a', avg(y) as 'b' FROM t1)     WHERE a<10
--Result--
[]
+--------------------+
--Query--
SELECT a,b,a+b FROM (SELECT avg(x) as 'a', avg(y) as 'b' FROM t1 WHERE y=4)     WHERE a>10
--Result--
[(11.5, 4.0, 15.5)]
+--------------------+
--Query--
SELECT a,b,a+b FROM (SELECT avg(x) as 'a', avg(y) as 'b' FROM t1 WHERE y=4)     WHERE a<10
--Result--
[]
+--------------------+
--Query--
SELECT a,b,a+b FROM (SELECT avg(x) as 'a', y as 'b' FROM t1 GROUP BY b)     ORDER BY a
--Result--
[(1.0, 1, 2.0), (2.5, 2, 4.5), (5.5, 3, 8.5), (11.5, 4, 15.5), (18.0, 5, 23.0)]
+--------------------+
--Query--
SELECT a,b,a+b FROM         (SELECT avg(x) as 'a', y as 'b' FROM t1 GROUP BY b)     WHERE b<4 ORDER BY a
--Result--
[(1.0, 1, 2.0), (2.5, 2, 4.5), (5.5, 3, 8.5)]
+--------------------+
--Query--
SELECT a,b,a+b FROM         (SELECT avg(x) as 'a', y as 'b' FROM t1 GROUP BY b HAVING a>1)     WHERE b<4 ORDER BY a
--Result--
[(2.5, 2, 4.5), (5.5, 3, 8.5)]
+--------------------+
--Query--
SELECT a,b,a+b FROM         (SELECT avg(x) as 'a', y as 'b' FROM t1 GROUP BY b HAVING a>1)     ORDER BY a
--Result--
[(2.5, 2, 4.5), (5.5, 3, 8.5), (11.5, 4, 15.5), (18.0, 5, 23.0)]
+--------------------+
--Query--
SELECT [count(*)],y FROM (SELECT count(*), y FROM t1 GROUP BY y)     ORDER BY [count(*)]
--Result--
[(1, 1), (2, 2), (4, 3), (5, 5), (8, 4)]
+--------------------+
--Query--
SELECT [count(*)],y FROM (SELECT count(*), y FROM t1 GROUP BY y)     ORDER BY y
--Result--
[(1, 1), (2, 2), (4, 3), (8, 4), (5, 5)]
+--------------------+
--Query--
SELECT a,b,c FROM        (SELECT x AS 'a', y AS 'b', x+y AS 'c' FROM t1 WHERE y=4)     WHERE a<10 ORDER BY a
--Result--
[(8, 4, 12), (9, 4, 13)]
+--------------------+
--Query--
SELECT y FROM (SELECT DISTINCT y FROM t1) WHERE y<5 ORDER BY y
--Result--
[(1,), (2,), (3,), (4,)]
+--------------------+
--Query--
SELECT DISTINCT y FROM (SELECT y FROM t1) WHERE y<5 ORDER BY y
--Result--
[(1,), (2,), (3,), (4,)]
+--------------------+
--Query--
SELECT avg(y) FROM (SELECT DISTINCT y FROM t1) WHERE y<5 ORDER BY y
--Result--
[(2.5,)]
+--------------------+
--Query--
SELECT a,x,b FROM       (SELECT x+3 AS 'a', x FROM t1 WHERE y=3) AS 'p',       (SELECT x AS 'b' FROM t1 WHERE y=4) AS 'q'     WHERE a=b     ORDER BY a
--Result--
[(8, 5, 8), (9, 6, 9), (10, 7, 10)]
+--------------------+
--Query--
SELECT a,x,b FROM       (SELECT x+3 AS 'a', x FROM t1 WHERE y=3),       (SELECT x AS 'b' FROM t1 WHERE y=4)     WHERE a=b     ORDER BY a
--Result--
[(8, 5, 8), (9, 6, 9), (10, 7, 10)]
+--------------------+
--Query--
SELECT * FROM t1
--Result--
[(1, 1), (2, 2), (3, 2), (4, 3)]
+--------------------+
--Query--
SELECT * FROM (         SELECT x AS 'a' FROM t1 UNION ALL SELECT x+10 AS 'a' FROM t1       ) ORDER BY a
--Result--
[(1,), (2,), (3,), (4,), (11,), (12,), (13,), (14,)]
+--------------------+
--Query--
SELECT * FROM (         SELECT x AS 'a' FROM t1 UNION ALL SELECT x+1 AS 'a' FROM t1       ) ORDER BY a
--Result--
[(1,), (2,), (2,), (3,), (3,), (4,), (4,), (5,)]
+--------------------+
--Query--
SELECT * FROM (         SELECT x AS 'a' FROM t1 UNION SELECT x+1 AS 'a' FROM t1       ) ORDER BY a
--Result--
[(1,), (2,), (3,), (4,), (5,)]
+--------------------+
--Query--
SELECT * FROM (         SELECT x AS 'a' FROM t1 INTERSECT SELECT x+1 AS 'a' FROM t1       ) ORDER BY a
--Result--
[(2,), (3,), (4,)]
+--------------------+
--Query--
SELECT * FROM (         SELECT x AS 'a' FROM t1 EXCEPT SELECT x*2 AS 'a' FROM t1       ) ORDER BY a
--Result--
[(1,), (3,)]
+--------------------+
--Query--
SELECT * FROM (SELECT 1)
--Result--
[(1,)]
+--------------------+
--Query--
SELECT c,b,a,* FROM (SELECT 1 AS 'a', 2 AS 'b', 'abc' AS 'c')
--Result--
[('abc', 2, 1, 1, 2, 'abc')]
+--------------------+
--Query--
SELECT c,b,a,* FROM (SELECT 1 AS 'a', 2 AS 'b', 'abc' AS 'c' WHERE 0)
--Result--
[]
+--------------------+
--Query--
SELECT c,b,a,* FROM (SELECT 1 AS 'a', 2 AS 'b', 'abc' AS 'c' WHERE 1)
--Result--
[('abc', 2, 1, 1, 2, 'abc')]
+--------------------+
--Query--
SELECT * FROM t3 NATURAL JOIN t4
--Result--
[(1, 11, 111), (2, 22, 222)]
+--------------------+
--Query--
SELECT y, p, q, r FROM        (SELECT t1.y AS y, t2.b AS b FROM t1, t2 WHERE t1.x=t2.a) AS m,        (SELECT t3.p AS p, t3.q AS q, t4.r AS r FROM t3 NATURAL JOIN t4) as n     WHERE  y=p
--Result--
[(1, 1, 11, 111), (2, 2, 22, 222), (2, 2, 22, 222)]
+--------------------+
--Query--
EXPLAIN      SELECT y, p, q, r FROM        (SELECT t1.y AS y, t2.b AS b FROM t1, t2 WHERE t1.x=t2.a) AS m,        (SELECT t3.p AS p, t3.q AS q, t4.r AS r FROM t3 NATURAL JOIN t4) as n     WHERE  y=p
--Result--
[(0, 'Init', 0, 51, 0, None, 0, None), (1, 'OpenRead', 1, 2, 0, '2', 0, None), (2, 'OpenRead', 2, 3, 0, '0', 0, None), (3, 'OpenRead', 4, 4, 0, '2', 0, None), (4, 'OpenRead', 5, 5, 0, '2', 0, None), (5, 'Rewind', 1, 50, 0, None, 0, None), (6, 'Column', 1, 0, 1, None, 0, None), (7, 'SeekRowid', 2, 49, 1, None, 0, None), (8, 'Once', 0, 20, 0, None, 0, None), (9, 'OpenAutoindex', 6, 3, 0, 'k(3,B,,)', 0, None), (10, 'Explain', 10, 0, 0, 'BLOOM FILTER ON t3 (p=?)', 0, None), (11, 'Blob', 10000, 2, 0, None, 0, None), (12, 'Rewind', 4, 20, 0, None, 0, None), (13, 'Column', 4, 0, 4, None, 0, None), (14, 'Column', 4, 1, 5, None, 0, None), (15, 'Rowid', 4, 6, 0, None, 0, None), (16, 'MakeRecord', 4, 3, 3, None, 0, None), (17, 'FilterAdd', 2, 0, 4, '1', 0, None), (18, 'IdxInsert', 6, 3, 0, None, 16, None), (19, 'Next', 4, 13, 0, None, 3, None), (20, 'Column', 1, 1, 7, None, 0, None), (21, 'IsNull', 7, 49, 0, None, 0, None), (22, 'Filter', 2, 49, 7, '1', 0, None), (23, 'SeekGE', 6, 49, 7, '1', 0, None), (24, 'IdxGT', 6, 49, 7, '1', 0, None), (25, 'Once', 0, 37, 0, None, 0, None), (26, 'OpenAutoindex', 7, 3, 0, 'k(3,B,,)', 0, None), (27, 'Explain', 27, 0, 0, 'BLOOM FILTER ON t4 (q=?)', 0, None), (28, 'Blob', 10000, 8, 0, None, 0, None), (29, 'Rewind', 5, 37, 0, None, 0, None), (30, 'Column', 5, 0, 4, None, 0, None), (31, 'Column', 5, 1, 5, None, 0, None), (32, 'Rowid', 5, 6, 0, None, 0, None), (33, 'MakeRecord', 4, 3, 3, None, 0, None), (34, 'FilterAdd', 8, 0, 4, '1', 0, None), (35, 'IdxInsert', 7, 3, 0, None, 16, None), (36, 'Next', 5, 30, 0, None, 3, None), (37, 'Column', 6, 1, 9, None, 0, None), (38, 'IsNull', 9, 48, 0, None, 0, None), (39, 'Filter', 8, 48, 9, '1', 0, None), (40, 'SeekGE', 7, 48, 9, '1', 0, None), (41, 'IdxGT', 7, 48, 9, '1', 0, None), (42, 'Column', 1, 1, 10, None, 0, None), (43, 'Column', 6, 0, 11, None, 0, None), (44, 'Column', 6, 1, 12, None, 0, None), (45, 'Column', 7, 1, 13, None, 0, None), (46, 'ResultRow', 10, 4, 0, None, 0, None), (47, 'Next', 7, 41, 0, None, 0, None), (48, 'Next', 6, 24, 0, None, 0, None), (49, 'Next', 1, 6, 0, None, 1, None), (50, 'Halt', 0, 0, 0, None, 0, None), (51, 'Transaction', 0, 0, 4, '0', 1, None), (52, 'Goto', 0, 1, 0, None, 0, None)]
+--------------------+
--Query--
SELECT DISTINCT y, p, q, r FROM        (SELECT t1.y AS y, t2.b AS b FROM t1, t2 WHERE t1.x=t2.a) AS m,        (SELECT t3.p AS p, t3.q AS q, t4.r AS r FROM t3 NATURAL JOIN t4) as n     WHERE  y=p
--Result--
[(1, 1, 11, 111), (2, 2, 22, 222)]
+--------------------+
--Query--
SELECT * FROM        (SELECT y, p, q, r FROM          (SELECT t1.y AS y, t2.b AS b FROM t1, t2 WHERE t1.x=t2.a) AS m,          (SELECT t3.p AS p, t3.q AS q, t4.r AS r FROM t3 NATURAL JOIN t4) as n       WHERE  y=p) AS e,       (SELECT r AS z FROM t4 WHERE q=11) AS f     WHERE e.r=f.z
--Result--
[(1, 1, 11, 111, 111)]
+--------------------+
--Query--
EXPLAIN      SELECT * FROM        (SELECT y, p, q, r FROM          (SELECT t1.y AS y, t2.b AS b FROM t1, t2 WHERE t1.x=t2.a) AS m,          (SELECT t3.p AS p, t3.q AS q, t4.r AS r FROM t3 NATURAL JOIN t4) as n       WHERE  y=p) AS e,       (SELECT r AS z FROM t4 WHERE q=11) AS f     WHERE e.r=f.z
--Result--
[(0, 'Init', 0, 74, 0, None, 0, None), (1, 'OpenRead', 2, 2, 0, '2', 0, None), (2, 'OpenRead', 3, 3, 0, '0', 0, None), (3, 'OpenRead', 5, 4, 0, '2', 0, None), (4, 'OpenRead', 6, 5, 0, '2', 0, None), (5, 'OpenRead', 8, 5, 0, '2', 0, None), (6, 'Rewind', 2, 73, 0, None, 0, None), (7, 'Column', 2, 0, 1, None, 0, None), (8, 'SeekRowid', 3, 72, 1, None, 0, None), (9, 'Once', 0, 21, 0, None, 0, None), (10, 'OpenAutoindex', 9, 3, 0, 'k(3,B,,)', 0, None), (11, 'Explain', 11, 0, 0, 'BLOOM FILTER ON t3 (p=?)', 0, None), (12, 'Blob', 10000, 2, 0, None, 0, None), (13, 'Rewind', 5, 21, 0, None, 0, None), (14, 'Column', 5, 0, 4, None, 0, None), (15, 'Column', 5, 1, 5, None, 0, None), (16, 'Rowid', 5, 6, 0, None, 0, None), (17, 'MakeRecord', 4, 3, 3, None, 0, None), (18, 'FilterAdd', 2, 0, 4, '1', 0, None), (19, 'IdxInsert', 9, 3, 0, None, 16, None), (20, 'Next', 5, 14, 0, None, 3, None), (21, 'Column', 2, 1, 7, None, 0, None), (22, 'IsNull', 7, 72, 0, None, 0, None), (23, 'Filter', 2, 72, 7, '1', 0, None), (24, 'SeekGE', 9, 72, 7, '1', 0, None), (25, 'IdxGT', 9, 72, 7, '1', 0, None), (26, 'Once', 0, 38, 0, None, 0, None), (27, 'OpenAutoindex', 10, 3, 0, 'k(3,B,,)', 0, None), (28, 'Explain', 28, 0, 0, 'BLOOM FILTER ON t4 (q=?)', 0, None), (29, 'Blob', 10000, 8, 0, None, 0, None), (30, 'Rewind', 6, 38, 0, None, 0, None), (31, 'Column', 6, 0, 4, None, 0, None), (32, 'Column', 6, 1, 5, None, 0, None), (33, 'Rowid', 6, 6, 0, None, 0, None), (34, 'MakeRecord', 4, 3, 3, None, 0, None), (35, 'FilterAdd', 8, 0, 4, '1', 0, None), (36, 'IdxInsert', 10, 3, 0, None, 16, None), (37, 'Next', 6, 31, 0, None, 3, None), (38, 'Column', 9, 1, 9, None, 0, None), (39, 'IsNull', 9, 71, 0, None, 0, None), (40, 'Filter', 8, 71, 9, '1', 0, None), (41, 'SeekGE', 10, 71, 9, '1', 0, None), (42, 'IdxGT', 10, 71, 9, '1', 0, None), (43, 'Once', 0, 57, 0, None, 0, None), (44, 'OpenAutoindex', 11, 3, 0, 'k(3,B,B,)', 0, None), (45, 'Explain', 45, 0, 0, 'BLOOM FILTER ON t4 (q=? AND r=?)', 0, None), (46, 'Blob', 10000, 10, 0, None, 0, None), (47, 'Rewind', 8, 57, 0, None, 0, None), (48, 'Column', 8, 0, 3, None, 0, None), (49, 'Ne', 11, 56, 3, 'BINARY-8', 81, None), (50, 'Column', 8, 0, 4, None, 0, None), (51, 'Column', 8, 1, 5, None, 0, None), (52, 'Rowid', 8, 6, 0, None, 0, None), (53, 'MakeRecord', 4, 3, 3, None, 0, None), (54, 'FilterAdd', 10, 0, 4, '2', 0, None), (55, 'IdxInsert', 11, 3, 0, None, 16, None), (56, 'Next', 8, 48, 0, None, 3, None), (57, 'Integer', 11, 12, 0, None, 0, None), (58, 'Column', 10, 1, 13, None, 0, None), (59, 'IsNull', 13, 70, 0, None, 0, None), (60, 'Filter', 10, 70, 12, '2', 0, None), (61, 'SeekGE', 11, 70, 12, '2', 0, None), (62, 'IdxGT', 11, 70, 12, '2', 0, None), (63, 'Column', 2, 1, 14, None, 0, None), (64, 'Column', 9, 0, 15, None, 0, None), (65, 'Column', 9, 1, 16, None, 0, None), (66, 'Column', 10, 1, 17, None, 0, None), (67, 'Column', 11, 1, 18, None, 0, None), (68, 'ResultRow', 14, 5, 0, None, 0, None), (69, 'Next', 11, 62, 0, None, 0, None), (70, 'Next', 10, 42, 0, None, 0, None), (71, 'Next', 9, 25, 0, None, 0, None), (72, 'Next', 2, 7, 0, None, 1, None), (73, 'Halt', 0, 0, 0, None, 0, None), (74, 'Transaction', 0, 0, 4, '0', 1, None), (75, 'Integer', 11, 11, 0, None, 0, None), (76, 'Goto', 0, 1, 0, None, 0, None)]
+--------------------+
--Query--
SELECT a.x, b.x FROM t1 AS a, (SELECT x FROM t1 LIMIT 2) AS b      ORDER BY 1, 2
--Result--
[(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2), (4, 1), (4, 2)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1 LIMIT 2)
--Result--
[(1,), (2,)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1 LIMIT 2 OFFSET 1)
--Result--
[(2,), (3,)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1) LIMIT 2
--Result--
[(1,), (2,)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1) LIMIT 2 OFFSET 1
--Result--
[(2,), (3,)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1 LIMIT 2) LIMIT 3
--Result--
[(1,), (2,)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1 LIMIT -1) LIMIT 3
--Result--
[(1,), (2,), (3,)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1 LIMIT -1)
--Result--
[(1,), (2,), (3,), (4,)]
+--------------------+
--Query--
SELECT x FROM (SELECT x FROM t1 LIMIT -1 OFFSET 1)
--Result--
[(2,), (3,), (4,)]
+--------------------+
--Query--
SELECT x, y FROM (SELECT x, (SELECT 10+x) y FROM t1 LIMIT -1 OFFSET 1)
--Result--
[(2, 12), (3, 13), (4, 14)]
+--------------------+
--Query--
SELECT x, y FROM (SELECT x, (SELECT 10)+x y FROM t1 LIMIT -1 OFFSET 1)
--Result--
[(2, 12), (3, 13), (4, 14)]
+--------------------+
--Query--
SELECT * FROM (SELECT * FROM t), j
--Result--
[]
+--------------------+
--Query--
SELECT cnt, xyz, (SELECT y FROM t2 WHERE w=cnt), '|'     FROM (SELECT count(*) AS cnt, w AS xyz FROM t1 GROUP BY 2)    ORDER BY cnt, xyz
--Result--
[(1, 1, 'one', '|'), (2, 2, 'two', '|'), (3, 3, 'three', '|')]
+--------------------+
--Query--
SELECT cnt, xyz, lower((SELECT y FROM t2 WHERE w=cnt)), '|'     FROM (SELECT count(*) AS cnt, w AS xyz FROM t1 GROUP BY 2)    ORDER BY cnt, xyz
--Result--
[(1, 1, 'one', '|'), (2, 2, 'two', '|'), (3, 3, 'three', '|')]
+--------------------+
--Query--
SELECT cnt, xyz, '|'     FROM (SELECT count(*) AS cnt, w AS xyz FROM t1 GROUP BY 2)    WHERE (SELECT y FROM t2 WHERE w=cnt)!='two'    ORDER BY cnt, xyz
--Result--
[(1, 1, '|'), (3, 3, '|')]
+--------------------+
--Query--
SELECT cnt, xyz,           CASE WHEN (SELECT y FROM t2 WHERE w=cnt)=='two'               THEN 'aaa' ELSE 'bbb'           END, '|'     FROM (SELECT count(*) AS cnt, w AS xyz FROM t1 GROUP BY 2)    ORDER BY +cnt
--Result--
[(1, 1, 'bbb', '|'), (2, 2, 'aaa', '|'), (3, 3, 'bbb', '|')]
+--------------------+
--Query--
SELECT ( SELECT y FROM t2 WHERE z = cnt )     FROM ( SELECT count(*) AS cnt FROM t1 )
--Result--
[(None,)]
+--------------------+
--Query--
SELECT * FROM (     SELECT * FROM (SELECT * FROM t1 LIMIT 1)     UNION ALL     SELECT * from t2)
--Result--
[(1,), (3,)]
+--------------------+
